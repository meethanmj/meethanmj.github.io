<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>han个人博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-08-21T14:39:49.468Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>han</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Welcome</title>
    <link href="http://yoursite.com/2019/08/21/welcome/"/>
    <id>http://yoursite.com/2019/08/21/welcome/</id>
    <published>2019-08-21T14:39:00.000Z</published>
    <updated>2019-08-21T14:39:49.468Z</updated>
    
    <content type="html"><![CDATA[<!-- excerpt -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;&lt;font size=&quot;5&quot;&gt;记录  学习  分享&lt;/font&gt;&lt;/center&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>note27</title>
    <link href="http://yoursite.com/2019/08/21/note27/"/>
    <id>http://yoursite.com/2019/08/21/note27/</id>
    <published>2019-08-21T10:46:10.000Z</published>
    <updated>2019-08-21T14:46:30.957Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: <code>HTTP</code> 内容总结，及 <code>burpsuite</code> 软件的使用</p><a id="more"></a><!--export--><!--toc--><h3 id="HTTP简介"><a href="#HTTP简介" class="headerlink" title="HTTP简介"></a>HTTP简介</h3><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul><li>无连接：限制每次连接只处理一个请求。服务器处理完客户的请求，并受到客户的应答后，即断开连接。以节省时间。</li><li>无状态：协议对于事物处理没有记忆能力，若后续处理前面的信息，则它必须重传。</li></ul><h4 id="HTTP之URL"><a href="#HTTP之URL" class="headerlink" title="HTTP之URL"></a>HTTP之URL</h4><p><code>URI</code> 是统一资源标识符，用来传输数据和建立连接。 <code>URL</code> 是一种特殊类型的 <code>URI</code> ，包含用于查找某个资源足够的信息。</p><p><code>URL</code> 是统一资源定位符，是互联网上用来标识某处资源的地址。</p><p><code>URL</code> 协议部分 域名部分 端口部分 虚拟目录部分 文件名部分 锚部分 参数部分</p><h4 id="HTTP请求和响应"><a href="#HTTP请求和响应" class="headerlink" title="HTTP请求和响应"></a>HTTP请求和响应</h4><p>请求消息：请求行、请求头部、空行和请求数据四部分组成。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/562f25980001b1b106000338.jpg</span> HTTP/1.1</span><br><span class="line">Host    img.mukewang.com</span><br><span class="line">User-Agent  Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36</span><br><span class="line">Accept  image/webp,image/*,*/*;q=0.8</span><br><span class="line">Referer http://www.imooc.com/</span><br><span class="line">Accept-Encoding gzip, deflate, sdch</span><br><span class="line">Accept-Language zh-CN,zh;q=0.8</span><br></pre></td></tr></table></figure><p><code>POST</code> 请求例子</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP1.1</span><br><span class="line"><span class="attribute">Host:www.wrox.com</span></span><br><span class="line">User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)</span><br><span class="line"><span class="attribute">Content-Type:application/x-www-form-urlencoded</span></span><br><span class="line"><span class="attribute">Content-Length:40</span></span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br><span class="line"></span><br><span class="line">name=Professional%20Ajax&amp;publisher=Wiley</span><br></pre></td></tr></table></figure><p>响应消息：状态行、消息包头、空行和响应正文。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Date</span>: Fri, 22 May 2009 06:07:21 GMT</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">      &lt;head&gt;&lt;/head&gt;</span><br><span class="line">      &lt;body&gt;</span><br><span class="line">            &lt;!--body goes here--&gt;</span><br><span class="line">      &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="HTTP之状态码"><a href="#HTTP之状态码" class="headerlink" title="HTTP之状态码"></a>HTTP之状态码</h4><table><thead><tr><th>状态码</th><th>作用</th></tr></thead><tbody><tr><td>1xx</td><td>请求已接受，继续处理</td></tr><tr><td>2xx</td><td>请求已被成功接收、理解、接收</td></tr><tr><td>3xx</td><td>重定向</td></tr><tr><td>4xx</td><td>请求有语法错误或请求无法实现</td></tr><tr><td>5xx</td><td>服务器为能实现合法请求</td></tr></tbody></table><h4 id="HTTP请求方法"><a href="#HTTP请求方法" class="headerlink" title="HTTP请求方法"></a>HTTP请求方法</h4><table><thead><tr><th>方法</th><th>作用</th></tr></thead><tbody><tr><td>GET</td><td>请求指定的页面信息，并返回实体主体</td></tr><tr><td>HEAD</td><td>返回响应中没有具体内容，用于获取报头</td></tr><tr><td>POST</td><td>向指定资源提交数据进行处理请求</td></tr><tr><td>PUT</td><td>从客户端向服务器传送的数据取代指定的文档内容</td></tr><tr><td>DELETE</td><td>请求服务器删除指定的页面</td></tr><tr><td>OPTION</td><td>允许客户端查看服务器的性能</td></tr><tr><td>TRACE</td><td>回显服务器收到的请求，主要用于测试或诊断</td></tr></tbody></table><p>浏览器地址输入 <code>URL</code> 后，经历流程：</p><ol><li>浏览器向 <code>DNS</code> 服务器请求解析该 <code>URL</code> 中的域名所对应的 <code>IP</code> 地址；</li><li>解析出 <code>IP</code> 地址后，根据 <code>IP</code> 地址和默认端口 <code>80</code> ，和服务器建立 <code>TCP</code> 连接；</li><li>浏览器发出读取文件的 <code>HTTP</code> 请求，该请求报文作为 <code>TCP</code> 三次握手的第三个报文数据发送给服务器。</li><li>服务器对浏览器请求作出响应，并把对应 <code>HTML</code> 文本发送给浏览器；</li><li>释放 <code>TCP</code> 连接；</li><li>浏览器将该 <code>HTML</code> 文本并显示内容。</li></ol><h4 id="GET和POST区别"><a href="#GET和POST区别" class="headerlink" title="GET和POST区别"></a>GET和POST区别</h4><p><code>GET</code> 请求</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/books/?sex=man&amp;name=Professional</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.wrox.com</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)</span><br><span class="line">Gecko/20050225 Firefox/1.0.1</span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br></pre></td></tr></table></figure><p><code>POST</code> 请求</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.wrox.com</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)</span><br><span class="line">Gecko/20050225 Firefox/1.0.1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 40</span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br><span class="line"></span><br><span class="line">name=Professional%20Ajax&amp;publisher=Wiley</span><br></pre></td></tr></table></figure><p>第一点：<code>GET</code> 提交，请求数据会附在 <code>URL</code> 之后，以 <code>?</code> 分割 <code>URL</code> 和传输数据，多个参数用 <code>&amp;</code> 连接。</p><p><code>POST</code> 提交，把提交数据放置在 <code>HTTP</code> 包的包体中；</p><p>第二点：<code>GET</code> 传输数据收到 <code>URL</code> 长度限制，<code>POST</code> 理论上不受限制；</p><p><em>参考文献</em></p><blockquote><p><a href="https://www.jianshu.com/p/80e25cb1d81a" target="_blank" rel="noopener">HTTP协议</a></p></blockquote><h3 id="burpsuite"><a href="#burpsuite" class="headerlink" title="burpsuite"></a>burpsuite</h3><h4 id="burpsuite使用"><a href="#burpsuite使用" class="headerlink" title="burpsuite使用"></a>burpsuite使用</h4><p>关于软件的使用可以参考 <em><a href="https://t0data.gitbooks.io/burpsuite/content/" target="_blank" rel="noopener">burpsuite实战指南</a></em> 一书。</p><h4 id="用burpsuite的宏绕过CSRF-TOKEN验证"><a href="#用burpsuite的宏绕过CSRF-TOKEN验证" class="headerlink" title="用burpsuite的宏绕过CSRF TOKEN验证"></a>用burpsuite的宏绕过CSRF TOKEN验证</h4><p>先打开 <code>firefox</code> 浏览器，登录账号，修改 <code>DVWA Security</code> 级别为 <code>High</code>。</p><p><img src="/images/54Highlevel.png" alt></p><p>然后进入到 <a href="http://192.168.253.133/dvwa/vulnerabilities/csrf/" target="_blank" rel="noopener">CSRF页面</a> </p><p><img src="/images/55csrfpage.png" alt></p><p>修改密码</p><p><img src="/images/56changepwd.png" alt></p><p>在 <code>HTTP history</code>中找到修改密码的请求包，发送到 <code>Repeater</code> 中，由于 <code>user_token</code> 已失效，密码修改失败， <code>HTTP</code> 状态码为 <code>302</code>，重定向到 <code>index.php</code> 页面。</p><p><img src="/images/58httphistory.png" alt></p><p><img src="/images/57repeaterFail.png" alt></p><p>接下来，开始使用宏绕过 <code>CSRF</code> 验证：</p><p><strong>第一步：录制宏</strong></p><p>在 <code>Project Option</code> 下 找到 <code>Sessions</code> ，然后找到底部的 <code>Macros</code> ，点击 <code>Add</code> 即创建一个新的宏。</p><p><img src="/images/59createNewMacros.png" alt></p><p>点击 <code>Add</code> 后会弹出一个新窗口</p><p><img src="/images/60macroRec.png" alt></p><p>在 <code>HTTP</code> 历史记录中选择 <code>/dvwa/vulnerabilities/csrf/</code> 在向应报文中找到 <code>user_token</code> 的值</p><p><img src="/images/61findtoken.png" alt></p><p>点击右下角 <code>OK</code> 后，进入 <code>Macro Editor</code> 界面</p><p><img src="/images/62macroEditor.png" alt> </p><p>修改 <code>Macro description</code> 为 <code>GET_CSRF_TOKEN</code> 点击右边 <code>Configure item</code></p><p><img src="/images/63item.png" alt></p><p><code>Parameter name</code> 改为 <code>user_token</code> 参数名与修改密码请求中的一致。用鼠标拖动选择 <code>user_token</code> 值，其余值会自动填充。点击 <code>OK</code> </p><p><img src="/images/64user_token.png" alt></p><p>完成后可以在宏列表中看到刚才录制的宏</p><p><img src="/images/65macroOK.png" alt></p><p><strong>第二步：添加会话处理规则</strong></p><p>完成后，在同一界面的 <code>Session Handling Rules</code> 点击 <code>Add</code> 弹出新界面</p><p><img src="/images/66session.png" alt></p><p>在新界面修改 <code>Rule Description</code> 为 <code>Update_CSRF_Token</code></p><p><img src="/images/67details.png" alt></p><p>点击 <code>Rule Actions</code> 选择 <code>GET_CSRF_TOKEN</code> ，然后选择 <code>Update only the following parameters</code> 选择 <code>user_token</code></p><p><img src="/images/68action.png" alt></p><p>选择好后，进入 <code>Session Handling</code> 选择 <code>Scope</code>界面，把修改密码的 <code>URL</code> 粘贴到 <code>URL Scope</code> 中</p><p><img src="/images/69scope.png" alt></p><p><strong>第三步：验证规则是否生效</strong></p><p>配置好后，返回到 <code>Repeater</code> 点击 <code>Go</code> 发现状态码 <code>200 OK</code></p><p><img src="/images/70200OK.png" alt></p><p>每点击一次，<code>user_tocken</code> 均不一样，密码可以修改成功。</p><p><img src="/images/71pwdChange.png" alt></p><p>后续进行宏维持会话有效</p><p><em>参考文献</em></p><blockquote><p><a href="https://www.freebuf.com/articles/web/156735.html" target="_blank" rel="noopener">经验分享|Burpsuite中宏的使用</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: &lt;code&gt;HTTP&lt;/code&gt; 内容总结，及 &lt;code&gt;burpsuite&lt;/code&gt; 软件的使用&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="HTTP - BurpSuite" scheme="http://yoursite.com/tags/HTTP-BurpSuite/"/>
    
  </entry>
  
  <entry>
    <title>练习8</title>
    <link href="http://yoursite.com/2019/08/20/practice8/"/>
    <id>http://yoursite.com/2019/08/20/practice8/</id>
    <published>2019-08-20T12:03:11.000Z</published>
    <updated>2019-08-21T15:16:03.501Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: <code>HTTP</code> 协议和 <code>HTTPS</code>协议的异同点， <code>HTTP</code> 协议中常见头部字段信息的含义及 <code>IIS</code> <code>PUT</code>写权限漏洞学习报告。</p><a id="more"></a><!--export--><ol><li><p>描述 <code>HTTP</code> 协议和 <code>HTTPS</code> 协议的异同点</p><p>相同点：HTTP 和 HTTPS 都采用同一个基础的协议。HTTPS并非是一种新协议，只是HTTP通信接口部分用SSL和TLS协议代替而已。HTTPS就是身披SSL协议外壳的HTTP。</p><p>不同点</p><table><thead><tr><th>名称</th><th>不同点</th></tr></thead><tbody><tr><td>安全性</td><td>HTTP不安全，HTTPS安全；HTTP无需证书，无需加密，HTTPS需要证书需要加密</td></tr><tr><td>端口号</td><td>HTTP标准端口是80，HTTPS是443</td></tr><tr><td>所处层</td><td>HTTP工作与应用层，HTTPS工作与传输层</td></tr><tr><td>URL</td><td>HTTP以http://开头，HTTPS以https://开头</td></tr><tr><td>通信</td><td>HTTP直接和TCP通信，HTTPS写和SSL通信，再由SSL和TCP通信。</td></tr></tbody></table><p><em>参考文献</em></p><blockquote><p><a href="https://www.oschina.net/translate/http-vs-https-similarities-and-differences" target="_blank" rel="noopener">HTTP和HTTPS异同点</a></p><p>《图解HTTP》</p></blockquote></li></ol><ol start="2"><li><p>描述 <code>HTTP</code> 协议中，常见头部字段信息含义。</p><p><strong>请求首部字段</strong></p><table><thead><tr><th>请求首部字段</th><th>含义</th></tr></thead><tbody><tr><td>Accept</td><td>通知服务器，用户能够处理的媒体类型及媒体类型的相对优先级。</td></tr><tr><td>Accept-Charset</td><td>通知服务器用户代理支持的字符集及字符集的相对优先顺序。</td></tr><tr><td>Authorization</td><td>告知服务器，用户代理的认证信息。</td></tr><tr><td>Expect</td><td>告知服务器，期望出现的某种特定行为。</td></tr><tr><td>From</td><td>告知服务器使用用户代理的电子邮件地址。</td></tr><tr><td>Host</td><td>告知服务器，请求资源所处的互联网的主机名和端口号。</td></tr><tr><td>Proxy-Authorization</td><td>告知服务器认证所需要的信息。</td></tr><tr><td>Range</td><td>告知服务器资源的指定范围。</td></tr><tr><td>Referer</td><td>告知服务器请求的原始资源的URI</td></tr><tr><td>User-Agent</td><td>将创建请求的浏览器和用户代理名称等信息传达给服务器。</td></tr></tbody></table><p><strong>响应首部字段</strong></p><table><thead><tr><th>响应首部字段</th><th>含义</th></tr></thead><tbody><tr><td>Accept-Ranges</td><td>告知客户端服务器是否能处理范围请求，以指定获取服务器端某个部分的资源。</td></tr><tr><td>Age</td><td>告知客户端，源服务器在多久前创建了响应。</td></tr><tr><td>ETag</td><td>告知客户端实体标识。</td></tr><tr><td>Location</td><td>响应接收方引导至某个与请求URI位置不同的资源。</td></tr><tr><td>Proxy-Authenticate</td><td>由代理服务器所要求的认证信息发送给客户端。</td></tr><tr><td>Retry-After</td><td>告知客户端应该在多久之后再次发送请求。</td></tr><tr><td>Server</td><td>告知客户端当前服务器上安装的HTTP服务器应用程序的信息。</td></tr><tr><td>Vary</td><td>可对缓存进行控制。</td></tr><tr><td>WWW-Authenticate</td><td>用于HTTP访问认证。</td></tr></tbody></table></li><li><p><code>IIS</code> <code>put</code> 写权限漏洞</p><p>打开<code>VMware</code>虚拟机，先查看 <code>IP</code> 地址</p></li></ol><p><img src="/images/38Ipaddr.png" alt></p><p>​    主机访问网站</p><p><img src="/images/39show.png" alt></p><p>​        <code>WebDAV</code> 开启之前</p><p><img src="/images/40WebDaVClose.png" alt></p><p>​    使用 <code>burpsuite</code> 抓取数据包，将 <code>GET</code> 方法改为 <code>OPTIONS</code> 后，</p><p><img src="/images/41close.png" alt></p><p>​    开启 <code>WebDAV</code> 服务，</p><p><img src="/images/42open.png" alt></p><p>​    使用 <code>burpsuite</code> 抓取数据包，将 <code>GET</code> 方法改为 <code>OPTIONS</code> 后，</p><p><img src="/images/43openbp.png" alt></p><p>​    文件所在文件夹的写权限未开启前</p><p><img src="/images/44nowrite.png" alt></p><p>​    使用 <code>PUT</code> 写入文件</p><p><img src="/images/45fail.png" alt></p><p>​    文件所在文件夹的写权限开启</p><p><img src="/images/46write.png" alt></p><p>​    使用 <code>PUT</code> 写入文件</p><p><img src="/images/47success.png" alt></p><p>​    进入目录查看，可以找到 <code>test.txt</code> 文件</p><p><img src="/images/48testOK.png" alt></p><p>​    先将一句话木马写入 <code>test.txt</code> 中</p><p><img src="/images/49rom.png" alt></p><p>​        查看 <code>test.txt</code></p><p><img src="/images/50rom.png" alt></p><p>​    将 脚本资源访问 打上勾</p><p><img src="/images/51script.png" alt></p><p>​    在用 <code>MOVE</code> 将 <code>test.txt</code> 修改为 <code>test.asp</code></p><p> <img src="/images/52createAsp.png" alt></p><p>​    查看 <code>test.asp</code></p><p><img src="/images/53show.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: &lt;code&gt;HTTP&lt;/code&gt; 协议和 &lt;code&gt;HTTPS&lt;/code&gt;协议的异同点， &lt;code&gt;HTTP&lt;/code&gt; 协议中常见头部字段信息的含义及 &lt;code&gt;IIS&lt;/code&gt; &lt;code&gt;PUT&lt;/code&gt;写权限漏洞学习报告。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
    
      <category term="HTTP" scheme="http://yoursite.com/tags/HTTP/"/>
    
  </entry>
  
  <entry>
    <title>note26</title>
    <link href="http://yoursite.com/2019/08/20/note26/"/>
    <id>http://yoursite.com/2019/08/20/note26/</id>
    <published>2019-08-20T11:12:56.000Z</published>
    <updated>2019-08-21T15:05:23.233Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 针对 <code>HTTP</code>的协议基础进行了简单的学习，掌握 <code>HTTP</code> 相关内容， 安装 <code>burpsuite</code> 软件，熟练使用该软件。对 <code>PDO</code>模式下防止 <code>SQL</code> 注入的理解。</p><a id="more"></a><!--export--><!--toc--><h3 id="HTTP协议基础"><a href="#HTTP协议基础" class="headerlink" title="HTTP协议基础"></a>HTTP协议基础</h3><h4 id="计算机网络模型基础"><a href="#计算机网络模型基础" class="headerlink" title="计算机网络模型基础"></a>计算机网络模型基础</h4><p><code>OSI</code> 模型总共分为七层，从下到上分别是：物理层、数据链路层、网络层、运输层、会话层、表示层和应用层。</p><p><code>TCP/IP</code> 模型分为五层，从下到上是：物理层、链路层、网络层、运输层和应用层。</p><ul><li><code>OSI</code>模型和 <code>TCP/IP</code> 模型</li></ul><table><thead><tr><th><code>OSI</code> 模型</th><th><code>TCP/IP</code> 模型</th><th>各层的解释</th></tr></thead><tbody><tr><td>应用层</td><td>应用层</td><td>为应用程序提供服务</td></tr><tr><td>表示层</td><td>应用层</td><td>数据格式转化、数据加密</td></tr><tr><td>会话层</td><td>应用层</td><td>建立、管理和维护会话</td></tr><tr><td>传输层</td><td>传输层</td><td>建立、管理和维护端到端的连接</td></tr><tr><td>网络层</td><td>网络层</td><td><code>IP</code> 选址及路由选择</td></tr><tr><td>数据链路层</td><td>数据链路层</td><td>提供介质访问和链路管理</td></tr><tr><td>物理层</td><td>物理层</td><td>物理层</td></tr></tbody></table><ul><li>过程如下：</li></ul><ol><li>应用层数据，先按照运输层协议标准，封装到运输层数据里（数据段）；</li><li>接着运输层的数据，会按照网络层协议的标准，封装到网络层数据里（数据包/报文）；</li><li>接着这些数据包会按照链路层的协议标准，封装链路层数据里（帧）；</li><li>这些数据帧，按照物理层的电气特性，转换为网络中 <code>0101</code>比特流发送出去</li><li>网络会把这些流数据，不断地拆封再拆封，直到送到目标主机，然后由目标主机一层一层拆封数据，进行反解析，最终完成一次数据传递。</li></ol><table><thead><tr><th>层数</th><th>作用</th></tr></thead><tbody><tr><td>物理层</td><td>规定电气特性。如调制解调器、光导纤维等</td></tr><tr><td>数据链路层</td><td>有 <code>ARQ</code> 、<code>PPP</code>等协议，数据单元为帧，典型设备有：网卡/网桥/交换机</td></tr><tr><td>网络层</td><td>有<code>IP</code>/<code>ICMP</code>等协议，数据单元为数据包，典型设备为：路由器/防火墙/多层交换机</td></tr><tr><td>传输层</td><td>有<code>TCP</code>/<code>UDP</code>等协议，数据单元为数据段，典型设备有：进程和端口</td></tr><tr><td>应用层</td><td>有<code>DHCP</code>/<code>FTP</code>/<code>HTTP</code>等协议，典型设备有：应用程序(<code>FTP</code>/<code>SMTP</code>/<code>HTTP</code>)</td></tr></tbody></table><p>越往高走，越偏向软件化。</p><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><p><code>HTTP</code> 协议是超文本传输（转移）协议，基于 <code>TCP/IP</code> 通信协议来传递数据，是一个属于应用层的面向对象的协议。</p><p> 常用状态码</p><table><thead><tr><th>状态码</th><th>意义</th></tr></thead><tbody><tr><td>200 OK</td><td>从客户端发来的请求在服务器端被正常处理</td></tr><tr><td>204 No Content</td><td>服务器接收的请求已成功处理，但在返回响应报文中不含实体的主体部分</td></tr><tr><td>301 Moved Permanently</td><td>永久性重定向</td></tr><tr><td>302 Found</td><td>临时性重定向</td></tr><tr><td>304 Not Modified</td><td>客户端发送附带条件请求时，服务器端允许请求访问资源，但未满足条件的情况</td></tr><tr><td>400 Bad Request</td><td>请求报文中存在语法错误</td></tr><tr><td>403 Forbidden</td><td>对请求资源的访问被服务器拒绝</td></tr><tr><td>404 Not Found</td><td>服务器上无法找到请求的资源</td></tr><tr><td>500 Internal Server Error</td><td>服务器端在执行请求时发生了错误</td></tr></tbody></table><h3 id="BurpSuite"><a href="#BurpSuite" class="headerlink" title="BurpSuite"></a>BurpSuite</h3><p>使用burpsuite抓取新闻管理系统的数据包</p><p>新闻初始界面</p><p><img src="/images/25bpindex.png" alt></p><p>点击 <code>forward</code></p><p><img src="/images/26bpindex.png" alt></p><p>点击用户界面</p><p><img src="/images/29bplogup.png" alt></p><p>注册成功后，登录</p><p><img src="/images/32bpjumpindex.png" alt></p><p>评论</p><p><img src="/images/33bpshowNews.png" alt></p><p>读取新闻</p><p><img src="/images/35bpreadNews.png" alt></p><p>进入个人信息页面</p><p><img src="/images/37bpPerInfo.png" alt></p><h3 id="PDO模式下防止SQL注入"><a href="#PDO模式下防止SQL注入" class="headerlink" title="PDO模式下防止SQL注入"></a>PDO模式下防止SQL注入</h3><p>使用 <code>PDO</code> 的 <code>prepare</code> 方式，主要是提高 <code>SQL</code> 模板查询性能、阻止 <code>SQL</code> 注入。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 针对 &lt;code&gt;HTTP&lt;/code&gt;的协议基础进行了简单的学习，掌握 &lt;code&gt;HTTP&lt;/code&gt; 相关内容， 安装 &lt;code&gt;burpsuite&lt;/code&gt; 软件，熟练使用该软件。对 &lt;code&gt;PDO&lt;/code&gt;模式下防止 &lt;code&gt;SQL&lt;/code&gt; 注入的理解。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="HTTP" scheme="http://yoursite.com/tags/HTTP/"/>
    
  </entry>
  
  <entry>
    <title>PHP内置过滤函数</title>
    <link href="http://yoursite.com/2019/08/17/php-file-func/"/>
    <id>http://yoursite.com/2019/08/17/php-file-func/</id>
    <published>2019-08-17T08:42:07.000Z</published>
    <updated>2019-08-17T09:41:29.946Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 本周写的新闻管理系统未对用户输入做出相应的判断，存在大量的漏洞，这篇文章特地总结了<code>php</code>内置过滤函数。</p><a id="more"></a><!--export--><h3 id="一、SQL注入过滤函数"><a href="#一、SQL注入过滤函数" class="headerlink" title="一、SQL注入过滤函数"></a>一、SQL注入过滤函数</h3><h4 id="1-addslashes"><a href="#1-addslashes" class="headerlink" title="1. addslashes()"></a>1. addslashes()</h4><p><strong>定义和用法</strong></p><p><code>addslashes(string)</code>函数返回在预定义的字符前添加反斜杠的字符串。</p><p>预定义字符是：</p><ul><li><p>单引号(‘)</p></li><li><p>双引号(“)</p></li><li><p>反斜杠()</p></li><li><p>NULL</p></li></ul><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要转移的字符串。</td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">    $id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">    $str = addslashes($id);</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/18addslashes.png" alt></p><h4 id="2-mysql-escape-string"><a href="#2-mysql-escape-string" class="headerlink" title="2. mysql_escape_string()"></a>2. mysql_escape_string()</h4><blockquote><p>在PHP5.3中已经弃用mysql_escape_string()</p></blockquote><p><code>mysql_escape_string()</code>并不转义<code>%</code>和<code>_</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">@$str = mysql_escape_string($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/19mysqlEscapeStr.png" alt></p><h4 id="3-mysql-real-escape-string"><a href="#3-mysql-real-escape-string" class="headerlink" title="3. mysql_real_escape_string()"></a>3. mysql_real_escape_string()</h4><p><strong>定义和用法</strong></p><p><code>mysql_real_escape_string(str, con)</code>函数转义SQL语句中使用的字符串中的特殊字符。</p><p>受影响的字符：</p><ul><li>\x00</li><li>\n</li><li>\r</li><li>\</li><li>‘</li><li>“</li><li>\x1a</li></ul><p>若成功，返回被转义的字符串，否则，返回<code>false</code>。</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要转义的字符串。</td></tr><tr><td>connection</td><td>可选。规定MySQL连接。未规定，则使用上一个连接。</td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line"><span class="keyword">if</span>(@$str = mysql_real_escape_string($id))</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'false'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/20mysqlRealEscapeStr.png" alt></p><h3 id="二、XSS过滤函数"><a href="#二、XSS过滤函数" class="headerlink" title="二、XSS过滤函数"></a>二、XSS过滤函数</h3><h4 id="1-htmlspecialchars"><a href="#1-htmlspecialchars" class="headerlink" title="1. htmlspecialchars()"></a>1. htmlspecialchars()</h4><p><strong>定义和用法</strong></p><p><code>htmlspecialchars()</code>函数把预定义的字符转换成<code>HTML</code>实体。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = htmlspecialchars($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要转义的字符串。</td></tr></tbody></table><p><img src="/images/21htmlspecialchars.png" alt></p><h4 id="2-strip-tag-函数"><a href="#2-strip-tag-函数" class="headerlink" title="2. strip_tag()函数"></a>2. strip_tag()函数</h4><p><strong>定义和用法</strong></p><p><code>strip_tags(string, allow)</code> 函数剥去字符串中的<code>HTML</code>、<code>XML</code> 以及<code>PHP</code>的标签。</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。规定要检查的字符串。</td></tr><tr><td>allow</td><td>可选。规定允许的标签。这些标签不会被删除。</td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = strip_tags($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/22stripTags.png" alt></p><h3 id="三、命令执行过滤函数"><a href="#三、命令执行过滤函数" class="headerlink" title="三、命令执行过滤函数"></a>三、命令执行过滤函数</h3><h4 id="1-escapeshellcmd"><a href="#1-escapeshellcmd" class="headerlink" title="1. escapeshellcmd()"></a>1. escapeshellcmd()</h4><p><strong>定义和用法</strong></p><p>在Windows下过滤方式是在字符前面加上一个^符号；在Linux是在字符前加上反斜杠（\）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = escapeshellcmd($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/23escapeshellcmd.png" alt></p><h4 id="2-escapeshellarg"><a href="#2-escapeshellarg" class="headerlink" title="2. escapeshellarg()"></a>2. escapeshellarg()</h4><p><strong>定义和用法</strong></p><p>给所有参数加上一对双引号，强制为字符串。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id=$_GET[<span class="string">"id"</span>];</span><br><span class="line">$str = escapeshellarg($id);</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/24escapeshellarg.png" alt></p><blockquote><p><a href="https://uknowsec.cn/posts/notes/php内置过滤函数总结.html" target="_blank" rel="noopener">参考博文</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 本周写的新闻管理系统未对用户输入做出相应的判断，存在大量的漏洞，这篇文章特地总结了&lt;code&gt;php&lt;/code&gt;内置过滤函数。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
    
      <category term="summary" scheme="http://yoursite.com/tags/summary/"/>
    
  </entry>
  
  <entry>
    <title>note25</title>
    <link href="http://yoursite.com/2019/08/17/note25/"/>
    <id>http://yoursite.com/2019/08/17/note25/</id>
    <published>2019-08-17T02:07:46.000Z</published>
    <updated>2019-08-17T08:41:16.515Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 修改新闻管理系统注册用户功能，添加没有勾选<code>免责协议</code>时要提示，必须勾选后才能注册成功，点击<code>免责协议</code>可以展示协议内容，继续修改点赞功能，展示新闻管理系统，介绍思路。</p><a id="more"></a><!--export--><h3 id="一、注册功能"><a href="#一、注册功能" class="headerlink" title="一、注册功能"></a>一、注册功能</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/header.php&apos;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head &gt; &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div style=&quot;width:100%;text-align:center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;h1&gt;注册&lt;/h1&gt;</span><br><span class="line">        &lt;form action=&quot;logup.php&quot; method=&quot;post&quot; onsubmit=&quot;checkEmpty()&quot; onchange=&quot;checkSelect()&quot;&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;idName&quot; placeholder=&quot;用户名&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwd&quot; id=&quot;idPwd&quot; placeholder=&quot;密码&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwdagain&quot; id=&quot;idPwdAg&quot; placeholder=&quot;再次输入密码&quot;&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">            &lt;p&gt;&lt;a href=&quot;./agree.php&quot; target=&quot;_blank&quot;&gt;&lt;input type=&quot;checkbox&quot; name=&quot;agree&quot; id=&quot;idAgree&quot;&gt;已阅读并同意《免责声明》&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;提交&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td align=&quot;right&quot;&gt;</span><br><span class="line">            &lt;a href=&quot;/login.php&quot;&gt;&lt;button  align=&quot;right&quot;&gt;用户登录&lt;/button&gt;&lt;/a&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function checkEmpty()&#123;</span><br><span class="line">        var name = document.getElementById(&apos;idName&apos;).value;</span><br><span class="line">        var pwd = document.getElementById(&apos;idPwd&apos;).value;</span><br><span class="line">        var pwdAg = document.getElementById(&apos;idPwdAg&apos;).value;</span><br><span class="line">        var agree = document.getElementById(&apos;idAgree&apos;).checked;</span><br><span class="line">        if(!(name &amp;&amp; pwd &amp;&amp; pwdAg))&#123;</span><br><span class="line">            alert(&apos;所有输入框内容不能为空！&apos;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            if (pwd != pwdAg) &#123;</span><br><span class="line">                alert(&apos;两次输入密码不一致！请重新输入密码！&apos;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                if(!agree)&#123;</span><br><span class="line">                    alert(&quot;请阅读完免责协议并勾选同意！&quot;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return agree;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">Require_once &apos;../basedir/footer.php&apos;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line">Require_once &quot;sql.php&quot;;</span><br><span class="line"></span><br><span class="line">$agree = $_POST[&apos;agree&apos;];</span><br><span class="line"></span><br><span class="line">$uname = base64_encode($_POST[&apos;name&apos;]);</span><br><span class="line"></span><br><span class="line">$upass = md5($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line">$passAgain = md5($_POST[&apos;passwdagain&apos;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if ($uname &amp;&amp; $upass &amp;&amp; $passAgain) &#123;</span><br><span class="line">    $checkName = mysql_query(&quot;SELECT * FROM `tb_users` where `username` = &apos;$uname&apos;;&quot;);</span><br><span class="line"></span><br><span class="line">    while (@$row = mysql_fetch_array($checkName))//转成数组，且返回第一条数据,当不是一个对象时候退出</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        if ($uname == $row[&apos;username&apos;]) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;用户名已存在，请重新输入！&apos;);&lt;/script&gt;&quot;;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if ($upass==$passAgain &amp;&amp; $agree==&apos;on&apos;) &#123;</span><br><span class="line">        echo</span><br><span class="line">        $result = mysql_query(&quot;INSERT INTO `tb_users` (`username`, `password`) VALUES(&apos;$uname&apos;, &apos;$upass&apos;);&quot;);</span><br><span class="line">        if (mysql_affected_rows()) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;恭喜你注册成功！即将跳转到登录页面！&apos;); location.href=&apos;login.php&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、问题与总结"><a href="#二、问题与总结" class="headerlink" title="二、问题与总结"></a>二、问题与总结</h3><p><strong>程序设计问题</strong>：点赞功能实现思路：点击按钮触发事件，进入后台处理页面，对数据库里面的<code>type</code>进行修改，统计出<code>type</code>的总和即热度；访问量的统计，每次从数据库读信息把view加1然后保存到数据库里面。</p><p><strong>程序架构问题</strong>：层次不清，目录比较混乱。</p><p><strong>团队合作问题</strong>：合作之前关于变量取名，程序处理结构均未沟通好，导致一些程序写好后合并程序时还要做修改。</p><p><strong>漏洞问题</strong>：未对用户输入做相应的处理，存在<code>SQL</code>注入、<code>XSS</code>等漏洞。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 修改新闻管理系统注册用户功能，添加没有勾选&lt;code&gt;免责协议&lt;/code&gt;时要提示，必须勾选后才能注册成功，点击&lt;code&gt;免责协议&lt;/code&gt;可以展示协议内容，继续修改点赞功能，展示新闻管理系统，介绍思路。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
      <category term="新闻管理系统" scheme="http://yoursite.com/tags/%E6%96%B0%E9%97%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>note24</title>
    <link href="http://yoursite.com/2019/08/17/note24/"/>
    <id>http://yoursite.com/2019/08/17/note24/</id>
    <published>2019-08-17T02:07:39.000Z</published>
    <updated>2019-08-17T03:38:30.191Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 新闻管理系统新闻展示页面、个人信息、找回密码以及点赞功能编写。</p><a id="more"></a><!--export--><h3 id="一、新闻展示页面-show-news-php"><a href="#一、新闻展示页面-show-news-php" class="headerlink" title="一、新闻展示页面 show_news.php"></a>一、新闻展示页面 show_news.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        新闻展示界面</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        $hot = 0;</span><br><span class="line">        $title = 0;</span><br><span class="line">        $author = 0;</span><br><span class="line">        $view = 0;</span><br><span class="line">        $time = 0;</span><br><span class="line">        $content = 0;</span><br><span class="line">        @$id= $_GET[&apos;id&apos;];</span><br><span class="line">        $hostname = &apos;127.0.0.1&apos;;</span><br><span class="line">        $username = &apos;root&apos;;</span><br><span class="line">        $passwd = &apos;root&apos;;</span><br><span class="line">        if($id)&#123;</span><br><span class="line">            @$con = mysql_connect(&apos;127.0.0.1&apos;, &apos;root&apos;,&apos;root&apos;) or die(mysql_error());</span><br><span class="line">            @mysql_select_db(&quot;lianxi&quot;) or die(mysql_error());</span><br><span class="line">            mysql_query(&quot;set names &apos;utf8&apos;&quot;) or die(mysql_error());</span><br><span class="line">            $sql = &quot;SELECT * FROM `tb_news` WHERE `id`=&apos;$id&apos;&quot;;</span><br><span class="line">            $result = mysql_query($sql) or die(mysql_error());</span><br><span class="line">            for($i=0; $i&lt;mysql_affected_rows(); $i++)&#123;</span><br><span class="line">                $arr = mysql_fetch_assoc($result);</span><br><span class="line">                if($arr[&apos;id&apos;] == $id)&#123;</span><br><span class="line">                    $hot=$arr[&apos;hot&apos;];</span><br><span class="line">                    $title = base64_decode($arr[&apos;title&apos;]);</span><br><span class="line">                    $author = base64_decode($arr[&apos;author&apos;]);</span><br><span class="line">                    $view = $arr[&apos;view&apos;];</span><br><span class="line">                    $time = $arr[&apos;add_time&apos;];</span><br><span class="line">                    $content = base64_decode($arr[&apos;contents&apos;]);</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        echo &quot;&lt;h1 align=&apos;center&apos;&gt;$title&lt;/h1&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;div style=&apos;float: left&apos;&gt;&lt;label&gt;作者： $author&lt;/label&gt;&lt;label&gt; &amp;nbsp  时间：$time&lt;/label&gt;&lt;/div&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;div style=&apos;float: right&apos;&gt;&lt;label&gt;热度： $hot&lt;/label&gt;   &lt;label&gt; / 浏览量：$view&lt;/label&gt;&lt;/div&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;hr&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;p align=&apos;center&apos;&gt;$content&lt;/p&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;hr&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">                &lt;form action=&quot;newAddnews.php&quot;, mathod=&quot;post&quot;&gt;</span><br><span class="line">                    &lt;textarea rows=&apos;10&apos; cols=&apos;100&apos; style=&quot;resize: none&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">                    &lt;br&gt;</span><br><span class="line">                    &lt;input type=&quot;submit&quot; name=&quot;suubmit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">                &lt;/form&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">EOF;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;h4 align=&apos;center&apos;&gt;评论&lt;/h4&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        if($id) &#123;</span><br><span class="line">            @$con = mysql_connect(&apos;127.0.0.1&apos;, &apos;root&apos;, &apos;root&apos;) or die(mysql_error());</span><br><span class="line">            @mysql_select_db(&quot;lianxi&quot;) or die(mysql_error());</span><br><span class="line">            mysql_query(&quot;set names &apos;utf8&apos;&quot;) or die(mysql_error());</span><br><span class="line">            $sql = &quot;SELECT * FROM `tb_discuss` WHERE `new_id`=&apos;$id&apos;&quot;;</span><br><span class="line">            $result = mysql_query($sql) or die(mysql_error());</span><br><span class="line">            for ($i = 0; $i &lt; mysql_affected_rows(); $i++) &#123;</span><br><span class="line">                $arr1 = mysql_fetch_assoc($result);</span><br><span class="line">                $discussUser = base64_decode($arr1[&apos;discuss_user&apos;]);</span><br><span class="line">                $time = $arr1[&apos;discuss_time&apos;];</span><br><span class="line">                $discussContent = $arr1[&quot;discuss_content&quot;];</span><br><span class="line">                echo &quot;&lt;hr style=\&quot;border:1px dashed #000; height:1px\&quot;&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;p align=&apos;center&apos;&gt;用户：$discussUser&quot; .     &quot;     时间：$time&lt;/p&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;p align=&apos;center&apos;&gt;$discussContent&lt;/p&gt;&quot;;</span><br><span class="line">                echo &quot;&lt;hr style=\&quot;border:1px dashed #000; height:1px\&quot;&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            mysql_close($con);</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="二、个人信息"><a href="#二、个人信息" class="headerlink" title="二、个人信息"></a>二、个人信息</h3><h4 id="1-personal-information-php"><a href="#1-personal-information-php" class="headerlink" title="1. personal_information.php"></a>1. personal_information.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php Require_once &apos;../basedir/header.php&apos;; ?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line">if(!isset($_SESSION[&apos;username&apos;]))&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;请登录后查看！&apos;);location.href=&apos;login.php&apos;;&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        个人资料</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;div style=&quot;margin: 0px 600px 0px 600px&quot;&gt;</span><br><span class="line">           &lt;form action=&quot;personal_informationhoutai.php&quot; method=&quot;post&quot; enctype= &quot;multipart/form-data&quot;&gt;</span><br><span class="line"></span><br><span class="line">                    头像：&lt;input type=&quot;file&quot; name=&quot;addr&quot;/&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">                    邮箱：&lt;input type=&quot;email&quot; name=&quot;email&quot;/&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">                    性别：&lt;input type=&quot;radio&quot; name=&quot;sexnan&quot;/&gt;男</span><br><span class="line">                          &lt;input type=&quot;radio&quot; name=&quot;sexnv&quot;/&gt;女&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">                &lt;input type=&quot;submit&quot; value=&quot;提交&quot;/&gt;</span><br><span class="line">               &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/footer.php&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-personal-information-backstage-php"><a href="#2-personal-information-backstage-php" class="headerlink" title="2. personal_information_backstage.php"></a>2. personal_information_backstage.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Require_once &quot;sql.php&quot;;</span><br><span class="line">session_start();</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line"></span><br><span class="line">$username = $_SESSION[&apos;username&apos;];</span><br><span class="line">$sql = &quot;SELECT * FROM `tb_users` WHERE `username`=&apos;$username&apos;;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$row = mysql_query($sql);</span><br><span class="line"></span><br><span class="line">$row = mysql_fetch_assoc($row);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$path = $row[&apos;addr&apos;];</span><br><span class="line">//var_dump($path);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//将文件从临时文件中转移到文件保存路径</span><br><span class="line">var_dump(move_uploaded_file($_FILES[&apos;addr&apos;][&apos;tmp_name&apos;], $path));</span><br><span class="line"></span><br><span class="line">$email=  $_POST[&apos;email&apos;];</span><br><span class="line"></span><br><span class="line">    if($_POST[&apos;sexmale&apos;])&#123;</span><br><span class="line">        $sex = 1;</span><br><span class="line">    &#125;</span><br><span class="line">    if($_POST[&apos;sexfemale&apos;])&#123;</span><br><span class="line">        $sex = -1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">var_dump($_SESSION[&apos;username&apos;]);</span><br><span class="line">//var_dump($sex);</span><br><span class="line">$yuju = &quot;UPDATE `tb_users` SET email=&apos;&#123;$email&#125;&apos;,sex=&apos;$sex&apos; WHERE `username` = &apos;$_SESSION[&apos;username&apos;]&apos;;&quot;;</span><br><span class="line">//echo $path;</span><br><span class="line">$row=  mysql_query(&quot;&#123;$path&#125;&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="三、找回密码"><a href="#三、找回密码" class="headerlink" title="三、找回密码"></a>三、找回密码</h3><h4 id="1-find-passwd-php"><a href="#1-find-passwd-php" class="headerlink" title="1.find_passwd.php"></a>1.find_passwd.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/header.php&apos;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head &gt; &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2 align=&quot;center&quot;&gt;找回密码&lt;/h2&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;!--text-align:center;--&gt;</span><br><span class="line">&lt;div style=&quot;text-align:center;&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;form action=&quot;findPasswdhoutai.php&quot; method=&quot;post&quot; onsubmit=&quot;checkpass()&quot; onchange=&quot;checkanswer()&quot;&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; placeholder=&quot;输入要找回密码的用户名&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;问题：你的爱好是？&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;answer&quot; id=&quot;inanswer&quot; placeholder=&quot;答案&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwd&quot; id=&quot;passFirst&quot; placeholder=&quot;新密码&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;password&quot; name=&quot;passwdagain&quot; id=&quot;passSecond&quot; placeholder=&quot;再次输入密码&quot; style=&quot;height: 20px;width: 200px&quot;&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">            &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;提交&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td align=&quot;right&quot;&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">Require_once &apos;../basedir/footer.php&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-find-passwd-backstage-php"><a href="#2-find-passwd-backstage-php" class="headerlink" title="2.find_passwd_backstage.php"></a>2.find_passwd_backstage.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">Require_once &quot;sql.php&quot;;</span><br><span class="line">//需要修改！</span><br><span class="line">error_reporting(E_ALL^E_NOTICE);</span><br><span class="line">$username = $_POST[&apos;name&apos;];</span><br><span class="line">var_dump($username);</span><br><span class="line">//    $username = &apos;root&apos;;</span><br><span class="line">//删除用户</span><br><span class="line">$sql = &quot;SELECT * FROM `tb_anquan` WHERE `username`=&apos;$username&apos;;&quot;;</span><br><span class="line">echo $sql;</span><br><span class="line">$result = mysql_query($sql) or die(mysql_error());</span><br><span class="line"></span><br><span class="line">$arr = mysql_fetch_assoc($result);</span><br><span class="line">$answer = $arr[&apos;mima&apos;];</span><br><span class="line">//echo $answer;</span><br><span class="line">//$inAnswer = $_POST[&apos;answer&apos;];</span><br><span class="line">if($answer != $_POST[&apos;answer&apos;])&#123;</span><br><span class="line">       die(&quot;&lt;script&gt;alert(&apos;密保答案不正确！&apos;);&lt;/script&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$passFirst = $_POST[&apos;passwd&apos;];</span><br><span class="line">$passSecond = $_POST[&apos;passwdagain&apos;];</span><br><span class="line">if($passFirst==NULL &amp;&amp; $passSecond==NULL) &#123;</span><br><span class="line">    die(&quot;&lt;script&gt;alert(&apos;请输入密码！&apos;);&lt;/script&gt;&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    if($passFirst != $passSecond)&#123;</span><br><span class="line">        die(&quot;&lt;script&gt;alert(&apos;输入密码不一致，请重新输入！&apos;);&lt;/script&gt;&quot;);</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        $passFirst = md5($passFirst);</span><br><span class="line">        $sql = &quot;UPDATE `tb_users` SET `password`= &apos;$passFirst&apos; WHERE `username`=&apos;$username&apos;;&quot;;</span><br><span class="line">        echo $sql;</span><br><span class="line">        $result = mysql_query($sql) or die(mysql_error());</span><br><span class="line">        if (mysql_affected_rows()) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;更新成功！&apos;);location.href=&apos;login.php&apos;;&lt;/script&gt;&quot;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            die(&quot;&lt;script&gt;alert(&apos;更新失败！&apos;);location.href=&apos;findPasswd.php&apos;;&lt;/script&gt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="四、点赞功能"><a href="#四、点赞功能" class="headerlink" title="四、点赞功能"></a>四、点赞功能</h3><h4 id="up-down-php"><a href="#up-down-php" class="headerlink" title="up_down.php"></a>up_down.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style &gt;</span><br><span class="line">    .th&#123;</span><br><span class="line">        vertical-align: middle;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;../js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    Require_once &quot;sql.php&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot;width:100%;text-align:center&quot;&gt;</span><br><span class="line">    &lt;h1&gt;新闻界面&lt;/h1&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;table align=&quot;center&quot; border=&quot;1&quot; width=&quot;1200&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;热度&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;标题&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;作者&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th&gt; &lt;h2&gt;时间&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">        &lt;th width=&quot;150px&quot;&gt; &lt;h2&gt;操作&lt;/h2&gt; &lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//$uers_id = $_SESSION[&quot;user_id&quot;];</span><br><span class="line">$user_id=13;</span><br><span class="line">$storeUidType = array();</span><br><span class="line">$result = mysql_query(&quot;select * from tb_news order by hot desc;&quot;);</span><br><span class="line">//======================================================================================</span><br><span class="line">$readNews = mysql_query(&quot;select * from `tb_hot` where `user_id`=$user_id&quot;);</span><br><span class="line">//把用户对新闻的评价保存在一个数组里</span><br><span class="line">//$storeUidType[news_id] = type</span><br><span class="line">while($arr1 = mysql_fetch_assoc($readNews)) &#123;</span><br><span class="line">    $hotUser_id = $arr1[&apos;user_id&apos;];</span><br><span class="line">    $hotNews_id = $arr1[&apos;news_id&apos;];</span><br><span class="line">    $hotType = $arr1[&apos;type&apos;];</span><br><span class="line">    $storeUidType[$hotNews_id] = $hotType;</span><br><span class="line">&#125;</span><br><span class="line">//echo $storeUidType;</span><br><span class="line">//======================================================================================</span><br><span class="line">while($arr = mysql_fetch_assoc($result))&#123;</span><br><span class="line">    $title = base64_decode($arr[&apos;title&apos;]);</span><br><span class="line">    //var_dump($title);</span><br><span class="line">    $contents = base64_decode($arr[&apos;contents&apos;]);</span><br><span class="line">    $author = base64_decode($arr[&apos;author&apos;]);</span><br><span class="line">    $new_img = $arr[&apos;new_img&apos;];</span><br><span class="line">    $add_time = $arr[&apos;add_time&apos;];</span><br><span class="line">    $Hot = $arr[&apos;hot&apos;];</span><br><span class="line">    //读取新闻ID</span><br><span class="line">    $id = $arr[&apos;id&apos;];</span><br><span class="line">    //=============================================</span><br><span class="line">    //用户还没有对新闻进行评价，颜色设置成黑色</span><br><span class="line">    if($storeUidType[$id]==1)&#123;</span><br><span class="line">        $upColor = &quot;red&quot;;</span><br><span class="line">        $downColor = &quot;black&quot;;</span><br><span class="line">    &#125;elseif($storeUidType[$id]==-1)&#123;</span><br><span class="line">        $upColor = &quot;black&quot;;</span><br><span class="line">        $downColor = &quot;red&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        $upColor = &quot;black&quot;;</span><br><span class="line">        $downColor = &quot;black&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    //=============================================</span><br><span class="line">    $idUp = &apos;btnUp&apos; . $id;</span><br><span class="line">    $idDown = &apos;btnDown&apos; . $id;</span><br><span class="line">    $tu = base64_decode($new_img);</span><br><span class="line">    echo</span><br><span class="line">            &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$Hot&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$title&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$author&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot;&gt;&#123;$add_time&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot; rowspan=&quot;2&quot;&gt;</span><br><span class="line">                &lt;p&gt;                  </span><br><span class="line">                    &lt;button id=$idUp style=&apos;color: $upColor&apos; onclick=&apos;btnUpAct(this.id)&apos;&gt;赞&lt;/button&gt;/</span><br><span class="line">                    &lt;button id=$idDown style=&apos;color: $downColor&apos; onclick=&apos;btnDownAct(this.id)&apos;&gt;踩&lt;/button&gt;                    </span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">                </span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">            &lt;td align=&quot;center&quot; height: 30px; width: 300px; text-align: center;&gt;</span><br><span class="line">            &lt;img height=&quot;150px&quot; src=&#123;$tu&#125;&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td colspan=&quot;3&quot; align=&quot;center&quot; &gt;&lt;a href=&quot;xinwenzhanshimore.php?action=&#123;$title&#125;&quot;&gt;&#123;$contents&#125;&lt;/a&gt; </span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">             &lt;script&gt;</span><br><span class="line">                function btnUpAct(id)&#123;                   </span><br><span class="line">                    if(id==&apos;$idUp&apos;)&#123;</span><br><span class="line">                        if(document.getElementById(id).style.color == &quot;red&quot;)&#123;</span><br><span class="line">                            alert(&apos;您已点过赞了！&apos;);</span><br><span class="line">                        &#125;else&#123;</span><br><span class="line">                            document.getElementById(id).style.color=&quot;red&quot;;</span><br><span class="line">                            document.getElementById(&apos;$idDown&apos;).style.color=&quot;black&quot;; </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                function btnDownAct(id)&#123;</span><br><span class="line">                    if(id==&apos;$idDown&apos;)&#123;</span><br><span class="line">                        if(document.getElementById(id).style.color == &quot;red&quot;)&#123;</span><br><span class="line">                            alert(&apos;您已点过踩了！&apos;);</span><br><span class="line">                        &#125;else&#123;</span><br><span class="line">                            document.getElementById(id).style.color=&quot;red&quot;;</span><br><span class="line">                            document.getElementById(&apos;$idUp&apos;).style.color=&quot;black&quot;;        </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;               </span><br><span class="line">            &lt;/script&gt;</span><br><span class="line">EOF;</span><br><span class="line">    </span><br><span class="line">?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="五、问题与总结"><a href="#五、问题与总结" class="headerlink" title="五、问题与总结"></a>五、问题与总结</h3><p>新闻展示、个人信息、找回密码三个功能均可完美实现。点赞功能还是有些问题，从数据库中读取数据，新闻展示界面把该用户对每条新闻的赞踩显示出红色，在按钮添加事件，当颜色为红色时，再次点击该按钮会提示已操作过。用这种思路写出来，只是最后一条新闻功能实现是正确，后来查资料得知，<code>js</code>事件用于循环时只对最后一条有作用，需用闭包解决。需换思路！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 新闻管理系统新闻展示页面、个人信息、找回密码以及点赞功能编写。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
      <category term="新闻管理系统" scheme="http://yoursite.com/tags/%E6%96%B0%E9%97%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>note23</title>
    <link href="http://yoursite.com/2019/08/16/note23/"/>
    <id>http://yoursite.com/2019/08/16/note23/</id>
    <published>2019-08-16T13:50:13.000Z</published>
    <updated>2019-08-17T15:00:47.973Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 用PHP操作MySQL数据库</p><a id="more"></a><!--export--><h3 id="一、常用函数"><a href="#一、常用函数" class="headerlink" title="一、常用函数"></a>一、常用函数</h3><table><thead><tr><th>函数名称</th><th>作用</th></tr></thead><tbody><tr><td>mysql_connect(host, uname, passwd)</td><td>进行数据库连接</td></tr><tr><td>mysql_select_db(‘database’)</td><td>选择数据库</td></tr><tr><td>mysql_query(sql)</td><td>向数据库发送指令</td></tr><tr><td>mysql_fetch_array()</td><td>获取数据集中一行数据</td></tr><tr><td>mysql_fetch_row()</td><td>获取数字索引数组</td></tr><tr><td>mysql_fetch_assoc()</td><td>获取关联索引数组</td></tr></tbody></table><h3 id="二、循环遍历查询结果"><a href="#二、循环遍历查询结果" class="headerlink" title="二、循环遍历查询结果"></a>二、循环遍历查询结果</h3><h4 id="1-while"><a href="#1-while" class="headerlink" title="1. while"></a>1. while</h4><p><code>sql.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> $host = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">$username = <span class="string">'root'</span>;</span><br><span class="line">$password = <span class="string">'root'</span>;</span><br><span class="line">@$con = mysql_connect($host, $username, $password) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line">mysql_select_db(<span class="string">'test'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error()); </span><br><span class="line">mysql_query(<span class="string">'set names "utf8"'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">'sql.php'</span>;</span><br><span class="line">$sql = <span class="string">"SELECT * FROM `content`;"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">while</span>($arr = mysql_fetch_assoc($result))&#123;</span><br><span class="line">        $title = $arr[<span class="string">'title'</span>];</span><br><span class="line">        $author = $arr[<span class="string">'author'</span>];</span><br><span class="line">        <span class="keyword">echo</span> $author. <span class="string">'-&gt;'</span> . $title;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-for"><a href="#2-for" class="headerlink" title="2. for"></a>2. for</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'sql.php'</span>;</span><br><span class="line">$sql = <span class="string">"SELECT * FROM `content`;"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;mysql_affected_rows(); $i++)&#123;</span><br><span class="line">        $arr = mysql_fetch_assoc($result);</span><br><span class="line">        $title = $arr[<span class="string">'title'</span>];</span><br><span class="line">        $author = $arr[<span class="string">'author'</span>];</span><br><span class="line">        <span class="keyword">echo</span> $author. <span class="string">'-&gt;'</span> . $title;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="三、对密码的处理"><a href="#三、对密码的处理" class="headerlink" title="三、对密码的处理"></a>三、对密码的处理</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="comment">//若$_SESSION['uname']为空则跳转到登录页面</span></span><br><span class="line"><span class="keyword">if</span>(!$_SESSION(<span class="string">'uname'</span>))&#123;</span><br><span class="line">        header(<span class="string">"Location: login.php"</span>);</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">@$old_pass = $_POST[<span class="string">'old_pass'</span>];</span><br><span class="line">@$new_pass = $_POST[<span class="string">'new_pass'</span>];</span><br><span class="line">@$new_pass_again = $_POST[<span class="string">'new_pass_again'</span>];</span><br><span class="line"><span class="keyword">if</span>($old_pass &amp;&amp; $new_pass &amp;&amp; $new_pass_again)&#123;</span><br><span class="line">        <span class="keyword">if</span>($new_pass != $new_pass_again)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"&lt;script&gt;alert('两次输入密码不一致，请重新输入!')&lt;/script&gt;"</span>)；</span><br><span class="line">        &#125;</span><br><span class="line">     $pass = md5($new_pass);</span><br><span class="line">        $uid = $_SESSION[<span class="string">'uid'</span>];</span><br><span class="line">        <span class="keyword">include</span> <span class="string">'sql.php'</span>;</span><br><span class="line">        $sql = <span class="string">"UPDATE `users` SET `passwd` = '&#123;$pass&#125;' WHERE `id`=&#123;$uid&#125;;"</span>;</span><br><span class="line">        $result = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(mysql_affected_rows())&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;script&gt;alert("密码修改成功！");&lt;/script&gt;'</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;script&gt;alert("密码修改成功！");&lt;/script&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 用PHP操作MySQL数据库&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>note22</title>
    <link href="http://yoursite.com/2019/08/13/note22/"/>
    <id>http://yoursite.com/2019/08/13/note22/</id>
    <published>2019-08-13T09:30:39.000Z</published>
    <updated>2019-08-17T03:31:59.812Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: MYSQL常用函数的讲解</p><a id="more"></a><!--export--><h3 id="一、常用函数"><a href="#一、常用函数" class="headerlink" title="一、常用函数"></a>一、常用函数</h3><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>version()</td><td>返回数据库的版本号</td></tr><tr><td>database()</td><td>返回当前数据库名</td></tr><tr><td>user()</td><td>返回当前用户</td></tr><tr><td>system_user()</td><td>返回当前用户</td></tr></tbody></table><ul><li>concat(s1, s2, …, sn)字符串s1，s2等多个字符串合并为一个字符串。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- MY SQL FUNCTION</span><br><span class="line">SELECT CONCAT(&quot;MY &quot;, &quot;SQL &quot;, &quot;FUNCTION &quot;);</span><br></pre></td></tr></table></figure><ul><li>concat_ws(x, s1, s1, …, sn)把字符串合并成一个字符串，两两间以x连接。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- I-LOVE-SQL</span><br><span class="line">SELECT CONCAT_WS(&quot;-&quot;, &quot;I&quot;, &quot;LOVE&quot;, &quot;SQL&quot;);</span><br></pre></td></tr></table></figure><ul><li>group_concat(s1, ‘ ‘, s2  )返回一个字符串结果，该结果由分组中的值连接组合而成。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT GROUP_CONCAT(username, &apos;-&apos;, passwd) FROM `USERS`;</span><br></pre></td></tr></table></figure><ul><li>left(s, n)返回字符串s前n个字符。 </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- hello</span><br><span class="line">SELECT LEFT(&apos;hello world&apos;, 5);</span><br><span class="line">-- helllo w</span><br><span class="line">SELECT LEFT(&apos;hello world&apos;, 7);</span><br></pre></td></tr></table></figure><ul><li>right(s, n)返回字符串s的后n个字符。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- o world</span><br><span class="line">SELECT RIGHT(&apos;hello world&apos;, 7);</span><br></pre></td></tr></table></figure><ul><li>substr/substring(s, start, length)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- o </span><br><span class="line">SELECT SUBSTR(&apos;hello world&apos;, 5, 2);</span><br><span class="line">SELECT SUBSTRING(&apos;hello world&apos;, 5, 2);</span><br><span class="line">-- o wo</span><br><span class="line">SELECT SUBSTR(&apos;hello world&apos;, 5, 4);</span><br><span class="line">SELECT SUBSTRING(&apos;hello world&apos;, 5, 4);</span><br></pre></td></tr></table></figure><ul><li>mid(s, n, len)从字符串s的start位置截取长度为length的子字符串</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- o w</span><br><span class="line">SELECT MID(&apos;hello world&apos;, 5, 3);</span><br></pre></td></tr></table></figure><ul><li>DISTINCT 过虑重复的记录</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT name FROM user;</span><br></pre></td></tr></table></figure><ul><li>UNION操作符用于合并两个或多个SELECT语句的结果集</li></ul><p><strong>NOTE</strong>: UNION内部的每个SELECT语句必须拥有相同数量的列，列也必须拥有相似的数据类型。UNION在进行表连接后会筛选掉重复的记录，UNION ALL只是简单的将两个结果合并后返回。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 字段名 FROM 表1 UNION SELECT 字段名 FROM 表2</span><br></pre></td></tr></table></figure><ul><li><p>ORDER BY在SQL注入中用于判断字段数，然后用UNION用于输出信息。</p></li><li><p>LIKE</p></li></ul><table><thead><tr><th>操作符</th><th>左右</th></tr></thead><tbody><tr><td>_</td><td>代表任意单个字符</td></tr><tr><td>%</td><td>代表任意多字符</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT id FROM users WHERE &apos;username&apos; LIKE &apos;b%&apos;;</span><br><span class="line">SELECT id FROM users WHERE &apos;username&apos; LIKE &apos;%o%&apos;;</span><br><span class="line">SELECT id FROM users WHERE &apos;username&apos; LIKE &apos;admi_&apos;;</span><br><span class="line">-- 把标题中含有1作者名含有1值含有1的数据列出</span><br><span class="line">SELECT * FROM test.content WHERE title LIKE &apos;%1%&apos; or author like &apos;%1%&apos; or value like %1%&apos;&apos;</span><br></pre></td></tr></table></figure><p><code>like</code>  <code>%q%</code>包含q的      <code>%q</code> q在结尾      <code>q%</code>   q在开头</p><h3 id="二、读写文件"><a href="#二、读写文件" class="headerlink" title="二、读写文件"></a>二、读写文件</h3><h4 id="1-写文件"><a href="#1-写文件" class="headerlink" title="1. 写文件"></a>1. 写文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 绝对路径</span><br><span class="line">into dumpfile &quot;filepath&quot;</span><br><span class="line">-- 绝对路径</span><br><span class="line">into outfile &quot;filepath&quot;</span><br><span class="line">select 123 into outfile/dumpfile &apos;/var/www/html/eval.php&apos;;</span><br></pre></td></tr></table></figure><h4 id="2-读文件"><a href="#2-读文件" class="headerlink" title="2. 读文件"></a>2. 读文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 绝对路径</span><br><span class="line">load_file(&apos;filepath&apos;)</span><br><span class="line">select load_file(&apos;/etc/passwd&apos;);</span><br><span class="line">create table data(</span><br><span class="line">data text</span><br><span class="line">)</span><br><span class="line">insert into data values(load_file(&apos;&apos;));</span><br></pre></td></tr></table></figure><p>load file: 读取文件并以字符串形式返回文件内容。</p><p>into outfile: 将所选行写入文件，该文件会在服务器主机上进行创建，所以你必须要有执行这条命令的权限，还要注意要写入文件不能是现有的文件。如：/etc/passwd</p><p><em>以下内容不太懂，先记住</em></p><p>文件转十六进制，然后unhexo into dumpfile</p><p>本地使用hex(load file(‘path’))处理二进制文件</p><p>服务器上，执行select unhex(0x十六进制内容) into dumpfile “/tmp/a.exe”</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: MYSQL常用函数的讲解&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>练习7</title>
    <link href="http://yoursite.com/2019/08/13/practice7/"/>
    <id>http://yoursite.com/2019/08/13/practice7/</id>
    <published>2019-08-13T09:01:59.000Z</published>
    <updated>2019-08-13T11:59:59.131Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 先在数据库中使用<code>UNION</code>写<code>SQL</code>查出数据库版本，库，表，列等信息，再在<code>index.php</code>中操作一遍。</p><a id="more"></a><!--export--><h3 id="一、首先确定列数"><a href="#一、首先确定列数" class="headerlink" title="一、首先确定列数"></a>一、首先确定列数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 先用order by根据是否报错确定列数</span><br><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; ORDER BY 4;</span><br><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; ORDER BY 5;</span><br><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; ORDER BY 6;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/orderBy.png" alt></p><p>由输出结果可知，共有五列。</p><h3 id="二、读取数据"><a href="#二、读取数据" class="headerlink" title="二、读取数据"></a>二、读取数据</h3><h4 id="1-确定库名"><a href="#1-确定库名" class="headerlink" title="1. 确定库名"></a>1. 确定库名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT version(), (SELECT group_concat(schema_name) FROM information_schema.schemata), 3, 4, 5;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/1schema.png" alt></p><h4 id="2-确定表名"><a href="#2-确定表名" class="headerlink" title="2. 确定表名"></a>2. 确定表名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (select group_concat(table_name) FROM information_schema.tables WHERE table_schema=&apos;mynews&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/2mynew.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (select group_concat(table_name) FROM information_schema.tables WHERE table_schema=&apos;test&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/3test.png" alt></p><p>对库进行一一查询，找到目标库</p><h4 id="3-列名"><a href="#3-列名" class="headerlink" title="3. 列名"></a>3. 列名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;content&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/4contentCo.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;users&apos;), 3, 4, 5 limit 1,1;</span><br></pre></td></tr></table></figure><p>可以看到有重复的字段，原因是昨天练习数据库导入时，对同一<code>.sql</code>文件导入不同的库，即不同库里存着名为<code>users</code>和<code>content</code>的表。加上限定条件即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username = &apos;admin&apos; UNION SELECT 1,2,3,4,group_concat(COLUMN_NAME) FROM information_schema.COLUMNS WHERE TABLE_NAME=&apos;users&apos; AND TABLE_SCHEMA=&apos;test&apos;;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/5limit.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;admin&apos; UNION SELECT 1, (SELECT group_concat(username, passwd) FROM `test`.`content`), 3, 4,5;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/6content.png" alt></p><p>可以利用查到的库名表名字段名，查看对应的信息。</p><h3 id="三、网页上练习"><a href="#三、网页上练习" class="headerlink" title="三、网页上练习"></a>三、网页上练习</h3><h4 id="1-环境"><a href="#1-环境" class="headerlink" title="1. 环境"></a>1. 环境</h4><p>首先把<code>index.php</code>拷贝到工程文件中，用<code>phpstorm</code>打开文件，在<code>Terminal</code>输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -S 127.0.0.1:9000</span><br></pre></td></tr></table></figure><p>在浏览器中打开网页<code>http://127.0.0.1:9000/index.php</code></p><p>首页如下：</p><p><img src="/images/16page.png" alt></p><h4 id="2-前期工作"><a href="#2-前期工作" class="headerlink" title="2. 前期工作"></a>2. 前期工作</h4><p><code>index.php</code>显示程序如下：</p><p><img src="D:%5Cmyproject%5CBlog%5Csource%5Cimages%5C17programm.png" alt></p><p>可知，显示的读取数据的前三个。</p><p>在提交按钮输入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; order by 49;</span><br></pre></td></tr></table></figure><p><img src="/images/7orderby.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; order by 50;</span><br></pre></td></tr></table></figure><p><img src="/images/8error.png" alt></p><p>可知字段数为49。</p><h4 id="3-开始查询"><a href="#3-开始查询" class="headerlink" title="3. 开始查询"></a>3. 开始查询</h4><ul><li>查询库名</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT version(), user(), (SELECT group_concat(schema_name) FROM information_schema.schemata),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/9schemaName.png" alt></p><ul><li>查询表名</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(table_name) FROM information_schema.tables WHERE table_schema=&apos;test&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/10testTableName.png" alt></p><ul><li>查询字段名</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;content&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/11ContentColName.png" alt></p><p>可以看出来有重复的字段名，这是因为两个不同库里均有<code>content</code>和<code>users</code>表。加上库名的限制就正常了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;content&apos; AND table_schema=&apos;test&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/11ContentColName1.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(column_name) FROM information_schema.columns WHERE table_name=&apos;user&apos;),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><ul><li>查询数据</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT concat_ws(&apos;~&apos;, author, title)  FROM `test`.`content` LIMIT 0,1),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/13readContent.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(author, &apos;~&apos;,title)  FROM`test`.`content`),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/14readContent.png" alt></p><p>同理也可查出<code>users</code>数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `mysql`.`user` WHERE `user` = &apos;root&apos; UNION SELECT 1, 2, (SELECT group_concat(username, &apos;~&apos;, passwd)  FROM `test`.`users`),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49  LIMIT 1,1</span><br></pre></td></tr></table></figure><p><img src="/images/15readUse.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 先在数据库中使用&lt;code&gt;UNION&lt;/code&gt;写&lt;code&gt;SQL&lt;/code&gt;查出数据库版本，库，表，列等信息，再在&lt;code&gt;index.php&lt;/code&gt;中操作一遍。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>highlight</title>
    <link href="http://yoursite.com/2019/08/13/highlight/"/>
    <id>http://yoursite.com/2019/08/13/highlight/</id>
    <published>2019-08-13T00:48:23.000Z</published>
    <updated>2019-08-13T02:44:12.472Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 解决<code>markdown</code>代码上传到<code>github</code>上不高亮的问题。</p><a id="more"></a><!--export--><h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% codeblock [lang:language] [title] [url] [link text] %&#125;</span><br><span class="line">code snippet</span><br><span class="line">&#123;% endcodeblock %&#125;</span><br></pre></td></tr></table></figure><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight js"><figcaption><span>Javascript Array Syntax</span><a href="http://j.mp/pPUUmW" target="_blank" rel="noopener">MDN Documentation</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = <span class="keyword">new</span> <span class="built_in">Array</span>(arrayLength);</span><br><span class="line"><span class="keyword">var</span> arr2 = <span class="keyword">new</span> <span class="built_in">Array</span>(element0, element1, ..., elementN);</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">'foo'</span>;</span><br><span class="line"></span><br><span class="line">print(a);</span><br><span class="line"></span><br><span class="line"><span class="comment">#python dictionary</span></span><br><span class="line">dict = &#123;<span class="string">'Name'</span>: <span class="string">'Zara'</span>, <span class="string">'Age'</span>: <span class="number">7</span>, <span class="string">'Class'</span>: <span class="string">'First'</span>&#125;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Name']: "</span>, dict[<span class="string">'Name'</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Age']: "</span>, dict[<span class="string">'Age'</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">FROM</span> information_schema.columns <span class="keyword">WHERE</span> table_name=<span class="string">'content'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$cars = <span class="keyword">array</span>(<span class="string">"Volvo"</span>, <span class="string">"BMW"</span>, <span class="string">"Toyota"</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $cars[<span class="number">0</span>];<span class="comment">//输出"Volvo"</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $cars[<span class="number">1</span>];<span class="comment">//输出"BMW"</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $cars[<span class="number">2</span>];<span class="comment">//输出"Toyota"</span></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dict = &#123;<span class="string">'Name'</span>: <span class="string">'Zara'</span>, <span class="string">'Age'</span>: <span class="number">7</span>, <span class="string">'Class'</span>: <span class="string">'First'</span>&#125;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Name']: "</span>, dict[<span class="string">'Name'</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"dict['Age']: "</span>, dict[<span class="string">'Age'</span>]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 解决&lt;code&gt;markdown&lt;/code&gt;代码上传到&lt;code&gt;github&lt;/code&gt;上不高亮的问题。&lt;/p&gt;
    
    </summary>
    
      <category term="hexo" scheme="http://yoursite.com/categories/hexo/"/>
    
    
      <category term="issue" scheme="http://yoursite.com/tags/issue/"/>
    
  </entry>
  
  <entry>
    <title>练习6</title>
    <link href="http://yoursite.com/2019/08/12/practice6/"/>
    <id>http://yoursite.com/2019/08/12/practice6/</id>
    <published>2019-08-12T14:20:05.000Z</published>
    <updated>2019-08-13T00:59:37.232Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: <code>MySQL</code>中<code>information_schema</code>库的使用</p><a id="more"></a><!--export--><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT schema_name FROM information_schema.schemata;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/databases.png" alt></p><p>显示出所有库名。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT table_name FROM information_schema.tables WHERE table_schema=&apos;mynews&apos;;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/tables.png" alt></p><p>显示出<code>mynews</code>库中所有表名。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT table_name FROM information_schema.tables WHERE table_schema=&apos;test&apos;;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/testTables.png" alt></p><p>找到目标，发现<code>test</code>库中有两张表<code>content</code>和<code>users</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name FROM information_schema.columns WHERE table_name=&apos;users&apos;;</span><br></pre></td></tr></table></figure><p><img src="/images/columnsCon.png" alt></p><p>显示出<code>users</code>表中的字段。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT username, passwd FROM test.users;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/upUsers.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name FROM information_schema.columns WHERE table_name=&apos;content&apos;;</span><br></pre></td></tr></table></figure><p><img src="/images/columns.png" alt></p><p>显示出<code>content</code>表中的字段。</p><p>OUT</p><p><img src="/images/tACon.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: &lt;code&gt;MySQL&lt;/code&gt;中&lt;code&gt;information_schema&lt;/code&gt;库的使用&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>note21</title>
    <link href="http://yoursite.com/2019/08/12/note21/"/>
    <id>http://yoursite.com/2019/08/12/note21/</id>
    <published>2019-08-12T14:19:08.000Z</published>
    <updated>2019-08-13T15:38:12.071Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 对<code>MySQL</code>数据库的简单介绍和基本操作包括创建数据库，读取数据库信息，创建表，对表中的数据进行增删改查。以及对<code>information_schema</code>表的理解。</p><a id="more"></a><!--export--><h3 id="一、MySQL数据库"><a href="#一、MySQL数据库" class="headerlink" title="一、MySQL数据库"></a>一、MySQL数据库</h3><p>MySQL是流行的关系型数据库管理系统。</p><ul><li>数据库：一些关联表的集合。</li><li>数据表：是数据的矩阵。</li><li>列：一列包含相同类型的数据，例如用户名数据。</li><li>行：一行是一组相关数据，例如一条用户订阅的数据。</li><li>主键：主键是唯一的，一个数据表中只能包含一个主键。可以用主键查询数据。</li><li>外键：外键用于关联两个表。</li></ul><h3 id="二、MySQL基础应用"><a href="#二、MySQL基础应用" class="headerlink" title="二、MySQL基础应用"></a>二、MySQL基础应用</h3><h4 id="1-关于数据库"><a href="#1-关于数据库" class="headerlink" title="1. 关于数据库"></a>1. 关于数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#创建数据库</span><br><span class="line">CREATE DATABASE mytest;</span><br><span class="line">#查看数据库</span><br><span class="line">SHOW DATABASES;</span><br><span class="line">#使用数据库</span><br><span class="line">USE mytest;</span><br></pre></td></tr></table></figure><h4 id="2-关于数据表"><a href="#2-关于数据表" class="headerlink" title="2. 关于数据表"></a>2. 关于数据表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#创建一个名为user的数据表</span><br><span class="line">CREATE TABLE `user`(</span><br><span class="line">`id` SMALLINT,</span><br><span class="line">    `username` VARCHAR(20),</span><br><span class="line">);</span><br><span class="line">#查看当前数据库中所有的数据表</span><br><span class="line">SHOW TABLES;</span><br><span class="line">#查看创建数据库时的描述</span><br><span class="line">SHOW CREATE TABLE user;</span><br><span class="line">#向user表中插入一条数据</span><br><span class="line">INSERT user VALUES(&apos;1&apos;, &apos;admin&apos;);</span><br><span class="line">#向user表中插入一条记录只包含名字的信息</span><br><span class="line">INSERT user(`username`) VALUES(&quot;cat&quot;);</span><br><span class="line">#向user表中同时插入多条记录</span><br><span class="line">INSERT user VALUES(&apos;2&apos;, &apos;zs&apos;), (&apos;3&apos;, &apos;ww&apos;);</span><br><span class="line">#查看数据表中的所有记录</span><br><span class="line">SELECT * FROM user;</span><br><span class="line">#修改数据表姓名</span><br><span class="line">ALERT TABLE admin RENAME TO nimda;</span><br><span class="line">#更改数据</span><br><span class="line">UPDATE nimda SET `id`=4;</span><br><span class="line">#删除数据表</span><br><span class="line">DROP TABLE user;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">库名</th><th align="center">表名</th><th align="center">字段</th></tr></thead><tbody><tr><td align="center"></td><td align="center">用户名tb_users</td><td align="center">名字、密码、邮箱、昵称、创建时间等</td></tr><tr><td align="center">mynews</td><td align="center">新闻表tb_news</td><td align="center">标题、内容、作者</td></tr><tr><td align="center"></td><td align="center">评论表tb_comment</td><td align="center">新闻id、评论内容、评论用户</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#创建新的数据库</span><br><span class="line">CREATE DATABASES mynews;</span><br><span class="line">#查看数据库</span><br><span class="line">SHOW DATABASE;</span><br><span class="line">#使用mynews库</span><br><span class="line">USE mynews;</span><br><span class="line">#创建一个名为tb_users表</span><br><span class="line">CREATE TABLE `tb_users`(</span><br><span class="line">    #id非空自增</span><br><span class="line">        `id` int(10) NOT NULL AUTO_INCREMENT,</span><br><span class="line">    #用户名非空唯一</span><br><span class="line">        `username` VARCHAR(50) NOT NULL UNIQUE,</span><br><span class="line">        `password` VARCHAR(50) NOT NULL,</span><br><span class="line">        `email` VARCHAR(50) NULL UNIQUE,</span><br><span class="line">        `nickname` VARCHAR(50) NOT NULL,</span><br><span class="line">        `safepoint` VARCHAR(50) NULL,</span><br><span class="line">    #头像默认</span><br><span class="line">        `avatarimg` VARCHAR(100) DEFAULT &apos;/images/default_avatar.jpg&apos;,</span><br><span class="line">    #时间</span><br><span class="line">        `reg_time` TIMESTAMP DEFAULT CURRENT_TIMESTAMP(),</span><br><span class="line">        `lastlogin_time` TIMESTAMP DEFAULT CURRENT_TIMESTAMP(),</span><br><span class="line">        `lastlogin_ip` VARCHAR(255) NULL,</span><br><span class="line">        PRIMARY KEY(`id`)</span><br><span class="line">);</span><br><span class="line">#向tb_users表插入一条数据</span><br><span class="line">INSERT INTO `mynews`.`tb_users`(`username`, `password`, `email`, `nickname`) VALUES (&apos;zs&apos;, &apos;zs123&apos;, &apos;zs123@icq.com&apos;, &apos;zs123&apos;)</span><br><span class="line"></span><br><span class="line">#创建一个名为tb_news表</span><br><span class="line">create table `tb_news`(</span><br><span class="line">    `id` int(0) not null auto_increment,</span><br><span class="line">    `title` varchar(255) not null,</span><br><span class="line">    `contents` text not null,</span><br><span class="line">    `author` varchar(50) not null,</span><br><span class="line">    `new_img` varchar(100) null,</span><br><span class="line">    `add_time` timestamp default current_timestamp(),</span><br><span class="line">    `hot` int(0) default 0,</span><br><span class="line">    primary key(`id`)</span><br><span class="line">);</span><br><span class="line">#向tb_news表插入数据</span><br><span class="line">INSERT INTO `mynews`.`tb_news`(`title`, `contents`, `author`) VALUES (&apos;打完宽面&apos;, &apos;吃面！吃面！&apos;, &apos;zs&apos;);</span><br><span class="line">INSERT INTO `mynews`.`tb_news`(`title`, `contents`, `author`) VALUES (&apos;鸡你太美&apos;, &apos;太美！太美！&apos;, &apos;ww&apos;);</span><br><span class="line"></span><br><span class="line">#创建一个名为tb_comment表</span><br><span class="line">create table `tb_comment`(</span><br><span class="line">    `id` int(0) not null auto_increment,</span><br><span class="line">    `new_id` int(0) not null,</span><br><span class="line">    `comment_content` text not null,</span><br><span class="line">    `comment_user` varchar(50) not null,</span><br><span class="line">    `comment_time` timestamp default current_timestamp(),</span><br><span class="line">    primary key(`id`)</span><br><span class="line">);</span><br><span class="line">#向tb_comment表插入数据</span><br><span class="line">INSERT INTO `mynews`.`tb_comment`(`new_id`, `comment_content`, `comment_user`) VALUES (&apos;1&apos;, &apos;吴亦凡&apos;, &apos;ww&apos;);</span><br><span class="line">INSERT INTO `mynews`.`tb_comment`(`new_id`, `comment_content`, `comment_user`) VALUES (&apos;2&apos;, &apos;坤坤&apos;, &apos;zs&apos;);</span><br><span class="line">#修改数据</span><br><span class="line">UPDATE `mynews`.`tb_news` SET `author` = &apos;ls&apos; WHERE `id` = 1;</span><br><span class="line">UPDATE `tb_comment` SET `comment_content` = &apos;蔡徐坤&apos; WHERE `id` = 2;</span><br><span class="line"></span><br><span class="line">ALTER TABLE `mynews`.`tb_users` ADD UNIQUE (`username`);</span><br></pre></td></tr></table></figure><h3 id="三、information-schema"><a href="#三、information-schema" class="headerlink" title="三、information_schema"></a>三、information_schema</h3><p><code>information_schema</code>这个数据库中保存了<code>MySQL</code>服务器所有数据库的信息。如数据库名，数据库的表，表中的数据类型与访问权限等。</p><table><thead><tr><th align="center">表名</th><th align="center">字段作用</th></tr></thead><tbody><tr><td align="center">schemata</td><td align="center">schema_name记录了所有数据库的名字</td></tr><tr><td align="center">tables</td><td align="center">table_schema记录了所有数据库的名字</td></tr><tr><td align="center">tables</td><td align="center">table_name记录了所有数据库的表的名字</td></tr><tr><td align="center">columns</td><td align="center">table_schema记录了所有数据库的名字</td></tr><tr><td align="center">columns</td><td align="center">table_name记录了所有数据库的表名字</td></tr><tr><td align="center">columns</td><td align="center">column_name记录了所有数据库的表的列的名字</td></tr></tbody></table><p>查询数据核心语法：</p><table><thead><tr><th align="center">功能名称</th><th align="left">查询语句</th></tr></thead><tbody><tr><td align="center">查库</td><td align="left">SELECT schema_name FROM information_schema.schemata</td></tr><tr><td align="center">查表</td><td align="left">SELECT table_name FROM information_schema.tables WHERE table_schema=库名</td></tr><tr><td align="center">查列</td><td align="left">SELECT column_name FROM information_schema.columns WHERE table_name=表明</td></tr><tr><td align="center">查数据</td><td align="left">SELECT 列名 FROM 库名.表名</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p mynews &lt; path</span><br><span class="line">mysqldump -uroot -p mysql &gt; path</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 对&lt;code&gt;MySQL&lt;/code&gt;数据库的简单介绍和基本操作包括创建数据库，读取数据库信息，创建表，对表中的数据进行增删改查。以及对&lt;code&gt;information_schema&lt;/code&gt;表的理解。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>练习5</title>
    <link href="http://yoursite.com/2019/08/11/practice5/"/>
    <id>http://yoursite.com/2019/08/11/practice5/</id>
    <published>2019-08-11T08:56:56.000Z</published>
    <updated>2019-08-13T02:02:55.349Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 把新闻信息，用户信息存放在文件中，用对文件的读写，实现用户的登录注册以及对新闻的增删改查。</p><a id="more"></a><!--export--><h3 id="一、目录结构"><a href="#一、目录结构" class="headerlink" title="一、目录结构"></a>一、目录结构</h3><blockquote><p>###目录结构：</p><p>|            index.php                //初始化页面</p><p>|——–  data                         //文件存放目录</p><p>|            news.db                  //存放新闻信息文件</p><p>|            users.db                 //存放用户信息文件</p><p>|——— lib                            //脚本存放目录           </p><p>|            login.html              // 用户登录界面    </p><p>|            checklogin.php    //处理用户登录信息</p><p>|            logup.html            //用户注册界面</p><p>|           checkSignUp.php //处理用户注册信息</p><p>|           addNews.php       //添加新闻界面</p><p>|           del.php                  //删除新闻界面</p><p>|           upload.php          //上传头像界面 </p><p>|           getpasswd.php   //修改密码界面</p><p>|           checkpass.php    //对hgetpasswd.php发送的数据进行处理</p><p>|——– css                         //用户登录和注册界面的css目录</p><p>|           login.css               //用户登录的css</p><p>|          logup.css              //用户注册的css        </p><p>|——– upload                 //用户上传头像目录</p><p>|——– basedir                //存放页面头部尾部和一些公共函数</p><p>|           header.php        //页面头部</p><p>|           footer.php         //页面尾部</p><p>|           function.php     //定义了一些公共函数</p></blockquote><h3 id="二、新闻界面-index-php"><a href="#二、新闻界面-index-php" class="headerlink" title="二、新闻界面 index.php"></a>二、新闻界面 index.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;news&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;!--区分普通用户和管理员用户--&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if(isset($_SESSION[&apos;uname&apos;]))&#123;</span><br><span class="line">    echo &lt;&lt;&lt;EOF</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;img src=&quot;../images/logo.png&quot; height=&quot;100px&quot; width=&quot;100px&quot; style=&quot;float: left&quot;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div style=&quot;float: right&quot;&gt;</span><br><span class="line">        &lt;img src=&apos;../upload/headimg.jpg&apos; height=&quot;60px&quot; width=&quot;60px&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;a href=&quot;../logout.php&quot;&gt;注销用户&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">EOF;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;ICQ新闻中心&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;table align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;热度&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;时间&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        //用只读方式打开news.db文件</span><br><span class="line">        $fhandle = fopen(&quot;./data/news1.db&quot;, &quot;r&quot;);</span><br><span class="line">        //设置一个计数器，小于3时，每个文章标题下面增加图片和简介</span><br><span class="line">        $top3Cnt=1;</span><br><span class="line">        while(!feof($fhandle)) &#123;</span><br><span class="line">            $fline = fgets($fhandle);</span><br><span class="line">            $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">            @$title = base64_decode($data[1]);</span><br><span class="line">            @$content = base64_decode($data[2]);</span><br><span class="line">            @$date = $data[3];</span><br><span class="line">            @$author = base64_decode($data[4]);</span><br><span class="line">            @$hot = $data[5];</span><br><span class="line">            @$imgUrl = $data[6];</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">            &lt;td&gt;$hot&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=&quot;myl.php&quot;&gt;$title&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$author&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$date&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        //新闻前三个显示图片和简介  </span><br><span class="line">        if($top3Cnt&lt;=3)&#123;</span><br><span class="line">            $tmpContent = mb_substr(base64_decode($data[2]), 0,50);</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;&lt;img src=&quot;$imgUrl&quot; height=&quot;80&quot; width=&quot;80&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&apos;4&apos;&gt;&lt;b&gt;内容简介：&lt;/b&gt;$tmpContent&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        &#125;</span><br><span class="line">        $top3Cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>普通用户显示界面：</p><p><img src="/images/iniPic.png" alt></p><p>管理员用户显示界面：</p><p><img src="/images/adminIniPic.png" alt></p><h3 id="三、用户登录和用户注册"><a href="#三、用户登录和用户注册" class="headerlink" title="三、用户登录和用户注册"></a>三、用户登录和用户注册</h3><h4 id="1-login-html"><a href="#1-login-html" class="headerlink" title="1.login.html"></a>1.login.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;登录页面&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/login.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;box&quot;&gt; </span><br><span class="line">    &lt;div class=&quot;top&quot;&gt;</span><br><span class="line">        &lt;h1&gt;登录&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;form action=&quot;checklogin.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;手机号/邮箱/用户名&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;密码&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input class=&quot;input_code&quot; type=&quot;text&quot; name=&quot;verifycode&quot; placeholder=&quot;验证码&quot;&gt;</span><br><span class="line">        &lt;img class=&quot;verifycode&quot; src=&quot;https://passport.360.cn/captcha.php?m=create&amp;app=i360&amp;scene=login&amp;userip=&amp;level=default&amp;sign=8820a4&amp;r=1564540365&amp;border=none&amp;_=1564540365972&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;a class=&quot;signup&quot; href=&quot;logup.html&quot;&gt;注册账号&lt;/a&gt;</span><br><span class="line">        &lt;a class=&quot;getpass&quot; href=&quot;./tmp/getpasswd.php&quot;&gt;忘记密码&lt;/a&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input class=&quot;login&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;登录&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="2-checklogin-php"><a href="#2-checklogin-php" class="headerlink" title="2.checklogin.php"></a>2.checklogin.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    session_start();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        登录</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;r&apos;);</span><br><span class="line">while(!feof($fhandle)) &#123;</span><br><span class="line">    $InMes = fgets($fhandle);</span><br><span class="line">    $mesArray = explode(&apos;||&apos;, $InMes);</span><br><span class="line">    if(count($mesArray)!=2)&#123;</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">    if(trim($mesArray[0])==$_POST[&apos;username&apos;] &amp;&amp; trim($mesArray[1])==$_POST[&apos;password&apos;])&#123;</span><br><span class="line">        $_SESSION[&apos;uname&apos;] = $_POST[&apos;username&apos;];</span><br><span class="line">        echo &quot;正在进入后台&quot;;</span><br><span class="line">        echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;script&gt;location.href=&quot;./data/addNews.php&quot;&lt;/script&gt;</span><br><span class="line">EOF;</span><br><span class="line">        $flag=0;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    $flag = 1;</span><br><span class="line">&#125;</span><br><span class="line">if($flag==1)&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;账号或密码错误！重新输入。&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>登录成功界面：</p><p><img src="/images/loginSec.png" alt></p><p>登录失败界面：</p><p><img src="/images/loginFail.png" alt></p><h4 id="3-checklogup-php"><a href="#3-checklogup-php" class="headerlink" title="3. checklogup.php"></a>3. checklogup.php</h4><p><code>logup.html</code>与<code>login.html</code>程序接近</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;a+&apos;);</span><br><span class="line">$userMes = array();</span><br><span class="line">$storeMes = array();</span><br><span class="line">@$userMes[0] = $_POST[&apos;username&apos;];</span><br><span class="line">@$userMes[1]=$_POST[&apos;password&apos;];</span><br><span class="line">@$userMes[2]=$_POST[&apos;checkpasswd&apos;];</span><br><span class="line">if(strcmp($userMes[1], $userMes[2])!=0)&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;两次输出密码不同！请重新输入！&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">    $storeMes[0] = $userMes[0];</span><br><span class="line">    $storeMes[1] = $userMes[1];</span><br><span class="line">    $inMes = implode(&apos;||&apos;, $storeMes);</span><br><span class="line">    if (count($userMes) == 3) &#123;</span><br><span class="line">        fputs($fhandle, $inMes . &quot;\n&quot;);</span><br><span class="line">        fclose($fhandle);</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;用户注册成功&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;script&gt;location.href=&apos;login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        $_SESSION[&apos;uname&apos;] = $_POST[&apos;username&apos;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>用户注册失败：</p><p><img src="/images/logupFail.png" alt></p><p>用户注册成功：</p><p><img src="/images/logupSec.png" alt></p><h3 id="四、新闻的增删改查"><a href="#四、新闻的增删改查" class="headerlink" title="四、新闻的增删改查"></a>四、新闻的增删改查</h3><h4 id="1-添加新闻-addNews-php"><a href="#1-添加新闻-addNews-php" class="headerlink" title="1. 添加新闻 addNews.php"></a>1. 添加新闻 addNews.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--添加头部信息--&gt;</span><br><span class="line">&lt;?php include &apos;../basedir/header.php&apos;; include &apos;../basedir/function.php&apos;;?&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        if($_SESSION[&apos;uname&apos;]==NULL) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">            die(&quot;请登录&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;a href=&quot;upload.php&quot;&gt;上传头像&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;del.php&quot;&gt;删除新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;getpasswd.php&quot;&gt;修改密码&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;form action=&quot;addNews.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">            if($_SESSION[&apos;uname&apos;]==NULL)</span><br><span class="line">                echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">                die(&quot;请登录&quot;);</span><br><span class="line">        ?&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;title&quot; placeholder=&quot;文章标题&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;number&quot; name=&quot;hot&quot; placeholder=&quot;热度&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;imgUrl&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;textarea name=&quot;content&quot; cols=&quot;100&quot; rows=&quot;50&quot; placeholder=&quot;文章内容&quot;&gt;&lt;/textarea&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    $fhandle = fopen(&apos;../data/news2.db&apos;, &apos;a&apos;);</span><br><span class="line">    $t = time();</span><br><span class="line">    $arrMes = array();</span><br><span class="line">    @$arrMes[0] = computerId(&apos;../data/news2.db&apos;)+1;</span><br><span class="line">    @$arrMes[1] = base64_encode($_POST[&apos;title&apos;]);</span><br><span class="line">    @$arrMes[2] = base64_encode($_POST[&apos;content&apos;]);</span><br><span class="line">    @$arrMes[3] = date(&quot;Y-m-d&quot;, $t);</span><br><span class="line">    @$arrMes[4] = base64_encode($_SESSION[&quot;username&quot;]);</span><br><span class="line">    @$arrMes[5] = $_POST[&apos;hot&apos;];</span><br><span class="line">    @$arrMes[6] = $_POST[&apos;imgUrl&apos;];</span><br><span class="line">    if (count($arrMes) == 7) &#123;</span><br><span class="line">        $writeMes = implode(&apos;||&apos;, $arrMes);</span><br><span class="line">        $fline = fputs($fhandle, $writeMes.&quot;\n&quot;);</span><br><span class="line">        if ($fline != flase) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;新闻添加成功！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">            echo &quot;&lt;a href=&apos;../index.php&apos;&gt;点击查看&lt;/a&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!--添加尾部信息--&gt;</span><br><span class="line">&lt;?php include &quot;../basedir/footer.php&quot;;?&gt;</span><br></pre></td></tr></table></figure><p>添加新闻页面：</p><p><img src="/images/testAddNews.png" alt></p><p><img src="/images/addNewsOk.png" alt></p><h4 id="2-删除新闻-del-php"><a href="#2-删除新闻-del-php" class="headerlink" title="2. 删除新闻 del.php"></a>2. 删除新闻 del.php</h4><p>思路：每条新闻对应一个<code>id</code>号，通过输入<code>id</code>判断要删除的新闻，程序循环读取文件每一行数据，再通过字符串函数把<code>id</code>号取出，若<code>id</code>不匹配把每行数据<code>push</code>到一个数组里面，若相等则跳过。然后再通过<code>for</code>循环把存入数据的数组以<code>w</code>格式重新写入文件即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include &apos;../basedir/header.php&apos;; include &apos;../basedir/function.php&apos;;?&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    if($_SESSION[&apos;uname&apos;]==NULL)</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">        &lt;a href=&quot;upload.php&quot;&gt;上传头像&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">        &lt;a href=&quot;../data/addNews.php&quot;&gt;添加新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">        &lt;a href=&quot;getpasswd.php&quot;&gt;修改密码&lt;/a&gt;</span><br><span class="line">        &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;form action=&quot;del.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; name=&quot;id&quot; placeholder=&quot;请输入要删除文章的编号&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;a href=&quot;../index.php&quot; target=&quot;_blank&quot;&gt;点击查看&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;table align=&quot;center&quot;&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;标号&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">            $f = fopen(&apos;../data/news1.db&apos;, &apos;r&apos;);</span><br><span class="line">            while(!feof($f))&#123;</span><br><span class="line">                $fline = fgets($f);</span><br><span class="line">                $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">                @$artId = $data[0];</span><br><span class="line">                @$title = base64_decode($data[1]);</span><br><span class="line">                @$author = base64_decode($data[4]);</span><br><span class="line">                echo &lt;&lt;&lt;EOF</span><br><span class="line">                &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">                    &lt;td&gt;$artId&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;$title&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;$author&lt;/td&gt; </span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">            &#125;</span><br><span class="line">        ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    @$id = $_POST[&apos;id&apos;];</span><br><span class="line">    $fhandle = fopen(&apos;../data/news1.db&apos;, &apos;r&apos;);</span><br><span class="line">    $transArr = array();</span><br><span class="line">    while(!feof($fhandle))&#123;</span><br><span class="line">        $fline = fgets($fhandle);</span><br><span class="line">        $tmpLine = explode(&apos;||&apos;, $fline);</span><br><span class="line">        if($tmpLine[0] == $id)&#123;</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        array_push($transArr, $tmpLine);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">    for($i=0; $i&lt;count($transArr); $i++) &#123;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $fhandle = fopen(&apos;../data/news1.db&apos;, &apos;w&apos;);</span><br><span class="line">    for($i=0; $i&lt;count($transArr); $i++) &#123;</span><br><span class="line">        if(count($transArr[$i])==7) &#123;</span><br><span class="line">            $transArr[$i][0] = $i + 1;</span><br><span class="line">            $str = implode(&apos;||&apos;, $transArr[$i]);</span><br><span class="line">            if($str==&quot;\n&quot;)&#123;</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            fputs($fhandle, $str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if(isset($_POST[&apos;id&apos;])) &#123;</span><br><span class="line">        if (count($transArr) == computerId(&apos;../data/news1.db&apos;)) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;删除成功&apos;); location.href=&apos;../tmp/del.php&apos;;&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php include &quot;../basedir/footer.php&quot;;?&gt;</span><br></pre></td></tr></table></figure><p>添加好新闻后，点击删除新闻可以进入删除新闻界面</p><p><img src="/images/delShow.png" alt></p><p><img src="/images/delIn.png" alt></p><p><img src="/images/del7.png" alt></p><p><img src="/images/delSecShow.png" alt></p><h4 id="3-修改密码"><a href="#3-修改密码" class="headerlink" title="3. 修改密码"></a>3. 修改密码</h4><p><code>getpasswd.php</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include &apos;../basedir/header.php&apos;; include &apos;../basedir/function.php&apos;;?&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    if($_SESSION[&apos;uname&apos;]==NULL) &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        die(&quot;请登录&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;a href=&quot;upload.php&quot;&gt;上传头像&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;../data/addNews.php&quot;&gt;添加新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;del.php&quot;&gt;删除新闻&lt;/a&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;form action=&quot;checkpass.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;label&gt;输入旧密码：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;oldpasswd&quot;&gt;</span><br><span class="line">        &lt;label&gt;输入新密码：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;newpasswd&quot;&gt;</span><br><span class="line">        &lt;label&gt;确认密码：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;checknewpasswd&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;?php include &quot;../basedir/footer.php&quot;;?&gt;</span><br></pre></td></tr></table></figure><p><code>checkpass.php</code></p><p>思路：先把每行数据读出存到一个数组里，用户名匹配成功后，先判断<code>oldpass</code>是否正确，不正确则返回，重新输入，若匹配成功，再判断<code>newpasswd</code>和<code>checknewpasswd</code>是否一致，不一致返回，重新输入，一致的话，把该用户的密码改成新密码后入栈。最后处理完的数据写入文件中。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    session_start();</span><br><span class="line">    if($_SESSION[&apos;uname&apos;]==NULL) &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">        die(&quot;请登录&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if($_POST[&apos;oldpasswd&apos;]==NULL &amp;&amp; $_POST[&apos;newpasswd&apos;]==NULL &amp;&amp; $_POST[&apos;checknewpasswd&apos;]==NULL)&#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(\&quot;密码不能为空\&quot;); history.back();&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $tmparr = array();</span><br><span class="line">    $userPasswd = array();</span><br><span class="line">    $oldpass = $_POST[&apos;oldpasswd&apos;];</span><br><span class="line">    $newpass = $_POST[&apos;newpasswd&apos;];</span><br><span class="line">    $checknew = $_POST[&apos;checknewpasswd&apos;];</span><br><span class="line">    $fhandle = fopen(&apos;../data/user1.db&apos;, &apos;r&apos;);</span><br><span class="line">    while(!feof($fhandle)) &#123;</span><br><span class="line">        $line = fgets($fhandle);</span><br><span class="line">        $lineArr = explode(&apos;||&apos;, $line);</span><br><span class="line">        if ($lineArr[0] == $_SESSION[&apos;uname&apos;]) &#123;</span><br><span class="line">            $userPasswd[0] = $lineArr[0];</span><br><span class="line">            $userPasswd[1] = $newpass.&quot;\n&quot;;</span><br><span class="line">            $checkold = $lineArr[1];</span><br><span class="line">            array_push($tmparr, $userPasswd);</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        array_push($tmparr, $lineArr);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">    if(trim($checkold)!=$oldpass)&#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(\&quot;密码不正确！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        if ($newpass == $checknew) &#123;</span><br><span class="line">            $fhandle = fopen(&apos;../data/user1.db&apos;, w);</span><br><span class="line">            for ($i = 0; $i &lt; count($tmparr); $i++) &#123;</span><br><span class="line">                $str = implode(&apos;||&apos;, $tmparr[$i]);</span><br><span class="line">                echo $str;</span><br><span class="line">                echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">                fputs($fhandle, $str);</span><br><span class="line">            &#125;</span><br><span class="line">            fclose($fhandle);</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;密码修改成功，请重新登录！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">            //echo &quot;&lt;script&gt;location.href=&apos;../logout.php&apos;&lt;/script&gt;&quot;;</span><br><span class="line"></span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;新密码不匹配，请重新输入！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>修改密码界面：</p><p><img src="/images/chagePwd.png" alt></p><p><img src="/images/chagePwdIn.png" alt></p><p><img src="/images/chagePwdSec.png" alt></p><p><img src="/images/PwdInFile.png" alt></p><p>密码修改后登出账号，重新登录。</p><h3 id="五、上传头像-upload-php"><a href="#五、上传头像-upload-php" class="headerlink" title="五、上传头像 upload.php"></a>五、上传头像 upload.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include &apos;../basedir/function.php&apos;; include &apos;../basedir/header.php&apos;; ?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;上传图片&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if($_SESSION[&apos;uname&apos;]==NULL)</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;请登录&apos;); location.href=&apos;../login.html&apos;&lt;/script&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;a href=&quot;del.php&quot;&gt;删除新闻&lt;/a&gt;       &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;../data/addNews.php&quot;&gt;添加新闻&lt;/a&gt;      &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp  &amp;nbsp</span><br><span class="line">    &lt;a href=&quot;getpasswd.php&quot;&gt;修改密码&lt;/a&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;form action=&quot;upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">        &lt;label&gt;文件名：&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;file&quot; name=&quot;file&quot; &gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if(isset($_POST[&apos;submit&apos;]))&#123;</span><br><span class="line">    $name       = $_FILES[&apos;file&apos;][&apos;name&apos;];</span><br><span class="line">    $temp_name  = $_FILES[&apos;file&apos;][&apos;tmp_name&apos;];</span><br><span class="line">    if(isset($name))&#123;</span><br><span class="line">        if(!empty($name))&#123;</span><br><span class="line">            $location = &quot;../upload/&quot;;</span><br><span class="line">            $path = $location . $name;</span><br><span class="line">            if(move_uploaded_file($temp_name, $location.$name))&#123;</span><br><span class="line">                $_SESSION[&apos;headImg&apos;] = $path;</span><br><span class="line">                echo &apos;File uploaded successfully&apos;;</span><br><span class="line">                echo &lt;&lt;&lt;EOF</span><br><span class="line">                &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">                    &lt;img src=$path&gt;   </span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">EOF;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  else &#123;</span><br><span class="line">        echo &apos;You should select a file to upload !!&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php include &apos;../basedir/footer.php&apos;?&gt;</span><br></pre></td></tr></table></figure><p>上传头像界面：</p><p><img src="/images/uploadImg.png" alt></p><p><img src="/images/uploadImgSec.png" alt></p><h3 id="六、退出账号-logout-php"><a href="#六、退出账号-logout-php" class="headerlink" title="六、退出账号 logout.php"></a>六、退出账号 logout.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">session_destroy();</span><br><span class="line">echo &quot;&lt;script&gt;alert(&apos;账号已退出&apos;); location.href=&apos;login.html&apos;&lt;/script&gt;&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>在任何一个界面点击注销账号均能成功退出，重新返回用户登录界面</p><p><img src="/images/logout.png" alt></p><p>点击确定，返回用户登录界面。</p><h3 id="七、问题与总结"><a href="#七、问题与总结" class="headerlink" title="七、问题与总结"></a>七、问题与总结</h3><ol><li>目前的代码有些冗余，比如删除新闻和修改密码，都是把需要的信息读取出来，然后稍作处理再写回文件，可以在<code>function.php</code>文件里写一个函数，需要时直接调用函数就行；删除新闻界面和初始化界面都有展示新闻的功能，也可可以通过一个函数来实现展示。</li><li>对写入文件的内容判断不严谨，会把<code>\n</code>写入，文件内容间有空行时，统计总的<code>id</code>数会把空行也给统计进去，进而导致删除新闻时，不成功。把空行删完以后，才会执行成功。目前对文件操作<code>\n</code>理解不深，正在寻找方法解决。</li><li>代码移植性差，需要修改地方较多。</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 把新闻信息，用户信息存放在文件中，用对文件的读写，实现用户的登录注册以及对新闻的增删改查。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="实战" scheme="http://yoursite.com/tags/%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>note20</title>
    <link href="http://yoursite.com/2019/08/09/note20/"/>
    <id>http://yoursite.com/2019/08/09/note20/</id>
    <published>2019-08-09T14:06:12.000Z</published>
    <updated>2019-08-09T15:48:05.284Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 新闻界面添加新功能讲解，PHP中的Cookie和Session以及程序执行函数</p><a id="more"></a><!--export--><h3 id="一、PHP-Cookie"><a href="#一、PHP-Cookie" class="headerlink" title="一、PHP Cookie"></a>一、PHP Cookie</h3><p><code>cookie</code>常用于识别用户，是一种服务器留在用户计算机上的小文件。每当同一台计算机通过浏览器请求页面时，这台计算机将会发送<code>cookie</code>。</p><h4 id="1-如何创建Cookie"><a href="#1-如何创建Cookie" class="headerlink" title="1. 如何创建Cookie"></a>1. 如何创建Cookie</h4><p><code>setcookie()</code>函数用于设置<code>cookie</code> </p><p><strong>setcookie()函数必须位于<code>&lt;html&gt;</code>标签之前</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/*</span><br><span class="line">setcookie(name, value, expire, path, domain)</span><br><span class="line">发送cookie时，cookie值会自动进行URL编码</span><br><span class="line">取回时进行自动解码</span><br><span class="line">*/</span><br><span class="line">setcookie(&quot;user&quot;, &quot;test&quot;, time()+3600);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-取回Cookie值"><a href="#2-取回Cookie值" class="headerlink" title="2. 取回Cookie值"></a>2. 取回Cookie值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//输出cookie值</span><br><span class="line">echo $_COOKIE[&quot;user&quot;];</span><br><span class="line">//查看所有cookie</span><br><span class="line">print_r($_COOKIE);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;isset函数&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">        if(isset($_COOKIE[&quot;user&quot;]))</span><br><span class="line">                echo &quot;欢迎&quot; . $_COOKIE[&quot;user&quot;] . &quot;!&lt;br&gt;&quot;;</span><br><span class="line">        else</span><br><span class="line">                echo &quot;普通访客！&lt;br&gt;&quot;;</span><br><span class="line">        ?&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="3-删除Cookie"><a href="#3-删除Cookie" class="headerlink" title="3. 删除Cookie"></a>3. 删除Cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//设置cookie过期时间为过去1小时</span><br><span class="line">setcookie(&quot;user&quot;, &quot;&quot;, time()-3600);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、PHP-Session"><a href="#二、PHP-Session" class="headerlink" title="二、PHP Session"></a>二、PHP Session</h3><p><code>PHP session</code>变量用于存储关于用户会话（session）信息，或者更改用户会话的设置，<code>Session</code>变量存储单一用户的信息，并且对于应用程序中的所有页面都是可用的。</p><h4 id="1-开始PHP-Session"><a href="#1-开始PHP-Session" class="headerlink" title="1. 开始PHP Session"></a>1. 开始PHP Session</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--session_start()函数必须位于&lt;html&gt;标签之前--&gt;</span><br><span class="line">&lt;?php session_start(); ?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body&gt;&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="2-存储Session变量"><a href="#2-存储Session变量" class="headerlink" title="2.存储Session变量"></a>2.存储Session变量</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">session_start();</span><br><span class="line">//存储session数据</span><br><span class="line">$_SESSION[&apos;views&apos;]=1;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;Session&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">        //检索session数据</span><br><span class="line">        echo &quot;浏览量：&quot; . $_SESSION[&apos;views&apos;];</span><br><span class="line">        ?&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>一个简单的<code>page-view</code>计数器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if(isset($_SESSION[&apos;views&apos;]))&#123;</span><br><span class="line">    $_SESSION[&apos;views&apos;] = $_SESSION[&apos;views&apos;] + 1;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $_SESSION[&apos;views&apos;] = 1;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;浏览器：&quot; . $_SESSION[&apos;views&apos;];</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-销毁Session"><a href="#3-销毁Session" class="headerlink" title="3. 销毁Session"></a>3. 销毁Session</h4><p><code>unset()</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if(isset($_SESSION[&apos;views&apos;]))&#123;</span><br><span class="line">    unset($_SESSION[&apos;views&apos;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><code>session_destroy()</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_destroy();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>验证登录用户是否由<code>admin</code>权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if(isset($_SESSION[&quot;admin&quot;]) &amp;&amp; $_SESSION[&quot;admin&quot;]== true)&#123;</span><br><span class="line">    echo &quot;您已成功登录&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    //验证失败</span><br><span class="line">    $_SESSION[&quot;admin&quot;] = false;</span><br><span class="line">    die(&quot;您无权访问&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="三、PHP包含文件"><a href="#三、PHP包含文件" class="headerlink" title="三、PHP包含文件"></a>三、PHP包含文件</h3><table><thead><tr><th align="left">语句</th><th>区别（处理错误方式不同）</th></tr></thead><tbody><tr><td align="left">require</td><td>生成一个致命错误(E_COMPILE_ERROR)，在错误发生后脚本停止执行</td></tr><tr><td align="left">include</td><td>生成一个警告(E_WARNING)，在错误发生后脚本会继续执行</td></tr></tbody></table><p>语法 <code>include &#39;filename&#39;;</code>  <code>require &#39;filename&#39;</code></p><ul><li>写一些功能性的函数，比如数据库查询，验证文件后缀是否是允许的。数据库删除，数据清洗waf</li><li>写配置信息，数据库连接地址，网站标题，网站作者</li><li>统一页面格式</li><li>做路由控制</li></ul><h3 id="四、PHP中程序执行函数"><a href="#四、PHP中程序执行函数" class="headerlink" title="四、PHP中程序执行函数"></a>四、PHP中程序执行函数</h3><h3 id="1-system"><a href="#1-system" class="headerlink" title="1. system"></a>1. system</h3><p><code>system</code> —执行外部程序，并且显示输出</p><p><code>system(command, return var)</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">system(&quot;pwd&quot;, $result);</span><br><span class="line">//输出命令的结果状态码</span><br><span class="line">echo $result;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-exec"><a href="#2-exec" class="headerlink" title="2. exec"></a>2. exec</h4><p><code>exec</code>—执行一个外部程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo exec(&quot;whoami&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-shellexec"><a href="#3-shellexec" class="headerlink" title="3. shellexec"></a>3. shellexec</h4><p><code>shellexec</code>—通过shell环境执行命令并且将完整的输出以字符串的方式返回。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$output = shell_exec(&apos;ls -lart&apos;);</span><br><span class="line">echo $output;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="4-eval"><a href="#4-eval" class="headerlink" title="4. eval"></a>4. eval</h4><p><code>eval</code>把字符串按照php代码来计算</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$string = &apos;cup&apos;;</span><br><span class="line">$name = &apos;coffee&apos;;</span><br><span class="line">$str = &apos;This is a $string with my $name in it.&apos;;</span><br><span class="line">echo $str . &quot;\n&quot;;</span><br><span class="line">eval(&quot;\$str = \&quot;$str\&quot;;&quot;);</span><br><span class="line">echo $str . &quot;\n&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="5-assert"><a href="#5-assert" class="headerlink" title="5. assert"></a>5. assert</h4><p><code>assert</code>检查一个断言是否为<code>FALSE</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 新闻界面添加新功能讲解，PHP中的Cookie和Session以及程序执行函数&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>练习4</title>
    <link href="http://yoursite.com/2019/08/09/practice4/"/>
    <id>http://yoursite.com/2019/08/09/practice4/</id>
    <published>2019-08-09T00:43:27.000Z</published>
    <updated>2019-08-09T01:14:39.196Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 新闻界面新增用户登录和注册功能，以及在编写过程中遇到的问题与解决</p><a id="more"></a><!--export--><h3 id="一、用户登录"><a href="#一、用户登录" class="headerlink" title="一、用户登录"></a>一、用户登录</h3><h4 id="1-用户登录界面-signin-php"><a href="#1-用户登录界面-signin-php" class="headerlink" title="1.用户登录界面 signin.php"></a>1.用户登录界面 signin.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        登录</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;登录&lt;/h1&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;form action=&quot;login.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;tel&quot; name=&quot;phonenumber&quot; placeholder=&quot;手机号&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;a href=&quot;signup.php&quot;&gt;注册账号&lt;/a&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/signin.png" alt="用户登录界面"></p><h4 id="2-账号和密码处理-login-php"><a href="#2-账号和密码处理-login-php" class="headerlink" title="2.账号和密码处理 login.php"></a>2.账号和密码处理 login.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        处理账号和密码</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//打开存储用户信息的文件</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;r&apos;);</span><br><span class="line">//逐行读取数据</span><br><span class="line">while(!feof($fhandle)) &#123;</span><br><span class="line">    $InMes = fgets($fhandle);</span><br><span class="line">    $mesArray = explode(&apos;||&apos;, $InMes);</span><br><span class="line">    if(count($mesArray)!=2)&#123;</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">    if(trim($mesArray[0])==$_POST[&apos;phonenumber&apos;] &amp;&amp; trim($mesArray[1])==$_POST[&apos;password&apos;])&#123;</span><br><span class="line">        echo &quot;正在进入后台&quot;;</span><br><span class="line">        echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;script&gt;location.href=&quot;./data/add_news.php&quot;&lt;/script&gt;</span><br><span class="line">EOF;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    $flag = 1;</span><br><span class="line">//    else&#123;</span><br><span class="line">//        echo &quot;&lt;script&gt;alert(&apos;账号或密码错误！重新输入。&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">//        echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">//    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//修改逻辑问题</span><br><span class="line">if($flag==1)&#123;</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;账号或密码错误！重新输入。&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;history.back()&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><strong>逻辑问题</strong>：注释掉的是第一次写完的，但判断逻辑是有问题的，逐行读取用户信息后，相同则跳回增加新闻界面，否则提示错误信息，重新输入账号或密码，这样会导致用户信息没有匹配成功前会一直报错。</p><p><strong>解决方法</strong>：在用户读完文件前不做出错判断，读完再判断，在判断匹配成功语句后添加一个标志位<code>flag</code>若值为<code>1</code>说明用户没有匹配成功，直接报错。，返回用户登录界面重新输入密码。</p><p><strong>格式问题</strong>：用户账号和密码匹配时一直匹配不对。</p><p><strong>解决方法</strong>：用<code>var_dump</code>把数据输出发现是相同的，但还是匹配不成功，想想有可能需要用<code>trim</code>函数处理下数据。</p><p><img src="/images/passwdError.png" alt></p><h3 id="二、用户注册"><a href="#二、用户注册" class="headerlink" title="二、用户注册"></a>二、用户注册</h3><h4 id="1-用户注册界面-signup-php"><a href="#1-用户注册界面-signup-php" class="headerlink" title="1.用户注册界面 signup.php"></a>1.用户注册界面 signup.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        注册账号</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div align=&quot;center&quot;&gt;</span><br><span class="line">        &lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;h2 align=&quot;center&quot;&gt;注册用户&lt;/h2&gt;</span><br><span class="line">        &lt;form action=&quot;./checkSignUp.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            手机：&lt;input type=&quot;tel&quot; name=&quot;phonenumber&quot;placeholder=&quot;手机号&quot;&gt;</span><br><span class="line">            &lt;br&gt;</span><br><span class="line">            密码：&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">            &lt;br&gt;</span><br><span class="line">            确认：&lt;input type=&quot;password&quot; name=&quot;checkpasswd&quot;&gt;</span><br><span class="line">            &lt;br&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/signUp.png" alt="用户注册"></p><h4 id="2-用户注册数据处理"><a href="#2-用户注册数据处理" class="headerlink" title="2.用户注册数据处理"></a>2.用户注册数据处理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$fhandle = fopen(&apos;./data/users.db&apos;, &apos;a+&apos;);</span><br><span class="line">$userMes = array();</span><br><span class="line">@$userMes[0] = $_POST[&apos;phonenumber&apos;];</span><br><span class="line">@$userMes[1]=$_POST[&apos;password&apos;];</span><br><span class="line">$inMes = implode(&apos;||&apos;, $userMes);</span><br><span class="line">//    var_dump($inMes);</span><br><span class="line">if(count($userMes)==2) &#123;</span><br><span class="line">    fputs($fhandle, $inMes . &quot;\n&quot;);</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">    echo &quot;&lt;script&gt;alert(&apos;用户注册成功&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;location.href=&apos;signin.php&apos;&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/signUpSes.png" alt></p><p>注册成功自动跳转到用户登录界面</p><h3 id="三、添加新闻界面-add-news-php"><a href="#三、添加新闻界面-add-news-php" class="headerlink" title="三、添加新闻界面 add_news.php"></a>三、添加新闻界面 add_news.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;增加新闻&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;add_news.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    标号：&lt;input type=&quot;number&quot; name=&quot;id&quot;&gt;&lt;br&gt;</span><br><span class="line">    标题：&lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;!--    标题：&lt;input type=&quot;text&quot; namne=&quot;title&quot;&gt;&lt;br&gt;--&gt;</span><br><span class="line">    内容：&lt;input type=&quot;text&quot; name=&quot;content&quot;&gt;&lt;br&gt;</span><br><span class="line">    日期：&lt;input type=&quot;date&quot; name=&quot;date&quot;&gt;&lt;br&gt;</span><br><span class="line">    作者：&lt;input type=&quot;author&quot; name=&quot;author&quot;&gt;&lt;br&gt;</span><br><span class="line">    热度：&lt;input type=&quot;number&quot; name=&quot;hot&quot;&gt;&lt;br&gt;</span><br><span class="line">    图片：&lt;input type=&quot;url&quot; name=&quot;imgUrl&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    $fhandle = fopen(&apos;news.db &apos;, &apos;a&apos;);</span><br><span class="line">    $arrMes = array();</span><br><span class="line">    @$arrMes[0] = $_POST[&apos;id&apos;];</span><br><span class="line">    @$arrMes[1] = base64_encode($_POST[&apos;title&apos;]);</span><br><span class="line">    @$arrMes[2] = base64_encode($_POST[&apos;content&apos;]);</span><br><span class="line">    @$arrMes[3] = $_POST[&apos;date&apos;];</span><br><span class="line">    @$arrMes[4] = base64_encode($_POST[&apos;author&apos;]);</span><br><span class="line">    @$arrMes[5] = $_POST[&apos;hot&apos;];</span><br><span class="line">    @$arrMes[6]= $_POST[&apos;imgUrl&apos;];</span><br><span class="line">    if($arrMes[0]!=NULL) &#123;</span><br><span class="line">        $writeMes = implode(&apos;||&apos;, $arrMes);</span><br><span class="line">        //echo $writeMes;</span><br><span class="line">        $fline = fputs($fhandle, &quot;\n&quot;.$writeMes);</span><br><span class="line">        if($fline!=flase)&#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(\&quot;新闻添加成功！\&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">            echo &quot;&lt;a href=&apos;../index.php&apos;&gt;点击查看&lt;/a&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function alertInfo()&#123;</span><br><span class="line">        alert(&quot;新闻添加成功！&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="四、展示新闻界面-index-php"><a href="#四、展示新闻界面-index-php" class="headerlink" title="四、展示新闻界面 index.php"></a>四、展示新闻界面 index.php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;news&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;ICQ新闻中心&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;table align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;热度&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;时间&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;素质三联&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        //用只读方式打开news.db文件</span><br><span class="line">        $fhandle = fopen(&quot;./data/news.db&quot;, &quot;r&quot;);</span><br><span class="line">        //设置一个计数器，小于3时，每个文章标题下面增加图片和简介</span><br><span class="line">        $top3Cnt=1;</span><br><span class="line">        while(!feof($fhandle)) &#123;</span><br><span class="line">            $fline = fgets($fhandle);</span><br><span class="line">            $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">            @$title = base64_decode($data[1]);</span><br><span class="line">            @$content = base64_decode($data[2]);</span><br><span class="line">            @$date = $data[3];</span><br><span class="line">            @$author = base64_decode($data[4]);</span><br><span class="line">            @$hot = $data[5];</span><br><span class="line">            @$imgUrl = $data[6];</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">            &lt;td&gt;$hot&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=&quot;myl.php&quot;&gt;$title&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$author&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$date&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;button&gt;👍&lt;/button&gt;/&lt;button&gt;👎&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        if($top3Cnt&lt;=3)&#123;</span><br><span class="line">            $tmpContent = mb_substr(base64_decode($data[2]), 0,50);</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;&lt;img src=&quot;$imgUrl&quot; height=&quot;80&quot; width=&quot;80&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&apos;4&apos;&gt;&lt;b&gt;内容简介：&lt;/b&gt;$tmpContent&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        &#125;</span><br><span class="line">        $top3Cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 新闻界面新增用户登录和注册功能，以及在编写过程中遇到的问题与解决&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="实战" scheme="http://yoursite.com/tags/%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>note19</title>
    <link href="http://yoursite.com/2019/08/08/note19/"/>
    <id>http://yoursite.com/2019/08/08/note19/</id>
    <published>2019-08-08T15:47:18.000Z</published>
    <updated>2019-08-09T14:05:41.432Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP中文件和文件夹操作常用函数以及文件上传功能的介绍和应用，对新闻界面添加用户登录注册界面等。</p><a id="more"></a><!--export--><h3 id="一、文件和文件夹操作常用函数"><a href="#一、文件和文件夹操作常用函数" class="headerlink" title="一、文件和文件夹操作常用函数"></a>一、文件和文件夹操作常用函数</h3><h4 id="1-文件内容操作"><a href="#1-文件内容操作" class="headerlink" title="1. 文件内容操作"></a>1. 文件内容操作</h4><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>fopen()</td><td>打开文件或URL</td></tr><tr><td>fread()</td><td>读取打开的文件</td></tr><tr><td>fgets()</td><td>从打开的文件中返回一行</td></tr><tr><td>fputs()/fwrite()</td><td>写入打开的文件</td></tr><tr><td>copy()</td><td>复制文件</td></tr><tr><td>fclose()</td><td>关闭打开的文件</td></tr><tr><td>file_get_contents()</td><td>把文件读入字符串</td></tr><tr><td>file_put_contents()</td><td>把字符串写文件</td></tr><tr><td>basename()</td><td>返回路径中文件名部分</td></tr><tr><td>filesize()</td><td>返回文件大小</td></tr></tbody></table><ul><li>fread(handle, length)/filesize(filesize)/copy(file, to_file)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;test.txt&quot;, &quot;r&quot;);</span><br><span class="line">$contents = fread($file, &quot;10&quot;);</span><br><span class="line">$size = filesize(&quot;test.txt&quot;);</span><br><span class="line">echo copy(&quot;source.txt&quot;, &quot;target.txt&quot;);</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>basename(path,suffix) </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$path = &quot;/testweb/home.php&quot;;</span><br><span class="line">//home.php</span><br><span class="line">echo basename($path) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">//home</span><br><span class="line">echo basename($path, &quot;.php&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>file_get_contents(path, include_path, context, start, max_length)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//This is a test file with test text</span><br><span class="line">echo file_get_contents(&quot;test.txt&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>file_put_contents()函数：成功返回写入文件的字符数，失败则返回False</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 6</span><br><span class="line">echo file_put_contents(&quot;sites.txt&quot;, &quot;Runoob&quot;);</span><br><span class="line"></span><br><span class="line">$file = &apos;sites.txt&apos;;</span><br><span class="line"> </span><br><span class="line">$site = &quot;\nGoogle&quot;;</span><br><span class="line">// 向文件追加写入内容</span><br><span class="line">// 使用 FILE_APPEND 标记，可以在文件末尾追加内容</span><br><span class="line">//  LOCK_EX 标记可以防止多人同时写入</span><br><span class="line">file_put_contents($file, $site, FILE_APPEND | LOCK_EX);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-文件操作"><a href="#2-文件操作" class="headerlink" title="2.文件操作"></a>2.文件操作</h4><table><thead><tr><th>函数名</th><th align="center">作用</th></tr></thead><tbody><tr><td>file_exists()</td><td align="center">检查文件或目录是否存在</td></tr><tr><td>filetype()</td><td align="center">返回文件类型</td></tr><tr><td>is_dir()</td><td align="center">判断文件是否是一个目录</td></tr><tr><td>is_file()</td><td align="center">判断文件是否是常规的文件</td></tr><tr><td>mkdir()</td><td align="center">创建目录</td></tr><tr><td>rename()</td><td align="center">重命名文件或目录</td></tr><tr><td>rmdir()</td><td align="center">删除空的目录</td></tr><tr><td>unlink()</td><td align="center">删除文件</td></tr></tbody></table><ul><li>file_exists(path)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 1</span><br><span class="line">echo file_exists(&quot;test.txt&quot;)</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>filetype(filename)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// fifo   char   dir blocklinkfileunknown</span><br><span class="line">//file</span><br><span class="line">echo filetype(&quot;test.txt&quot;);</span><br><span class="line">//dir</span><br><span class="line">echo filetype(&quot;images&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、文件上传"><a href="#二、文件上传" class="headerlink" title="二、文件上传"></a>二、文件上传</h3><h4 id="1-创建一个文件上传表单"><a href="#1-创建一个文件上传表单" class="headerlink" title="1. 创建一个文件上传表单"></a>1. 创建一个文件上传表单</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>文件上传<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"upload_file.php"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"file"</span>&gt;</span>文件名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"file"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;form&gt;</code>标签的<code>enctype</code>属性规定了在提交表单时要使用哪种内容类型。在表单需要二进制数据时，比如文件内容，使用<code>multipart/form-data</code>。</li><li><code>&lt;input&gt;</code>标签<code>type=&quot;file&quot;</code>属性规定了应该把输入作为文件来处理。</li></ul><h4 id="2-创建上传脚本-upload-file-php"><a href="#2-创建上传脚本-upload-file-php" class="headerlink" title="2. 创建上传脚本 upload_file.php"></a>2. 创建上传脚本 upload_file.php</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if($_FILES[&quot;file&quot;][&quot;error&quot;]&gt;0)&#123;</span><br><span class="line">        //由文件上传导致的错误代码</span><br><span class="line">        echo &quot;错误&quot; .$_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        //上传文件的名称</span><br><span class="line">        echo &quot;上传文件名：&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的类型</span><br><span class="line">        echo &quot;文件类型：&quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的大小</span><br><span class="line">        echo &quot;文件大小：&quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;]/1024) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //存储在服务器的文件临时副本的名称</span><br><span class="line">        echo &quot;文件临时存储位置：&quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-上传限制"><a href="#3-上传限制" class="headerlink" title="3. 上传限制"></a>3. 上传限制</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//允许上传图片后缀</span><br><span class="line">$allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;);</span><br><span class="line">$temp = explode(&quot;.&quot;, $_FILES[&apos;file&apos;][&apos;name&apos;]);</span><br><span class="line">//获取文件后缀名</span><br><span class="line">$extension = end($temp);</span><br><span class="line">if((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/x-png&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/png&quot;))</span><br><span class="line"> &amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 204800)</span><br><span class="line"> &amp;&amp; (in_array($extension, $allowedExts)))&#123;</span><br><span class="line">    if($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)&#123;</span><br><span class="line">        echo &quot;错误：&quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">          //上传文件的名称</span><br><span class="line">        echo &quot;上传文件名：&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的类型</span><br><span class="line">        echo &quot;文件类型：&quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的大小</span><br><span class="line">        echo &quot;文件大小：&quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;]/1024) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //存储在服务器的文件临时副本的名称</span><br><span class="line">        echo &quot;文件临时存储位置：&quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;非法文件的格式&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="4-保存被上传的文件"><a href="#4-保存被上传的文件" class="headerlink" title="4. 保存被上传的文件"></a>4. 保存被上传的文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//允许上传图片后缀</span><br><span class="line">$allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;);</span><br><span class="line">$temp = explode(&quot;.&quot;, $_FILES[&apos;file&apos;][&apos;name&apos;]);</span><br><span class="line">//获取文件后缀名</span><br><span class="line">$extension = end($temp);</span><br><span class="line">if((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/x-png&quot;)</span><br><span class="line"> || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/png&quot;))</span><br><span class="line"> &amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 204800)</span><br><span class="line"> &amp;&amp; (in_array($extension, $allowedExts)))&#123;</span><br><span class="line">    if($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)&#123;</span><br><span class="line">        echo &quot;错误：&quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">          //上传文件的名称</span><br><span class="line">        echo &quot;上传文件名：&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的类型</span><br><span class="line">        echo &quot;文件类型：&quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //上传文件的大小</span><br><span class="line">        echo &quot;文件大小：&quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;]/1024) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        //存储在服务器的文件临时副本的名称</span><br><span class="line">        echo &quot;文件临时存储位置：&quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">        </span><br><span class="line">        //判断当前目录下的upload目录是否存在该文件</span><br><span class="line">        //如果没有upload目录，需要创建它，upload目录权限为777</span><br><span class="line">        if(file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))&#123;</span><br><span class="line">            echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;文件已经存在&quot;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">        //如果upload目录不存在该文件则将文件上传到upload目录下</span><br><span class="line">            move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]);</span><br><span class="line">            echo &quot;文件存储在：&quot; . &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;非法文件的格式&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>关于上传文件的起名常常加上时间戳。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: PHP中文件和文件夹操作常用函数以及文件上传功能的介绍和应用，对新闻界面添加用户登录注册界面等。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>note18</title>
    <link href="http://yoursite.com/2019/08/07/note18/"/>
    <id>http://yoursite.com/2019/08/07/note18/</id>
    <published>2019-08-07T15:40:08.000Z</published>
    <updated>2019-08-07T15:46:03.784Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP数组索引数组和关联数组的遍历，以及数组常用的函数；PHP文件处理常用函数以及不同模式下对文件的操作。</p><a id="more"></a><!--export--><h3 id="一、数组"><a href="#一、数组" class="headerlink" title="一、数组"></a>一、数组</h3><h4 id="1-数组遍历"><a href="#1-数组遍历" class="headerlink" title="1. 数组遍历"></a>1. 数组遍历</h4><ul><li>索引数组 </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr1 = [&apos;wm&apos;, 56, &apos;Beijing&apos;];</span><br><span class="line">for($i=0; $i&lt;count($arr1); $i++)&#123;</span><br><span class="line">    echo $arr1[$i];</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li><p>关联数组</p><p><code>foreach</code>遍历</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = [</span><br><span class="line">    &apos;name&apos; =&gt; &apos;zs&apos;,</span><br><span class="line">    &apos;age&apos;  =&gt; 18,</span><br><span class="line">    &apos;add&apos;  =&gt; &apos;China&apos;</span><br><span class="line">];</span><br><span class="line">foreach($arr as $item =&gt;$value)&#123;</span><br><span class="line">    echo $item . &quot;=&gt;&quot; . $value;</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>​    <code>for</code>遍历</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$arr = [</span><br><span class="line">    &apos;name&apos; =&gt; &apos;zs&apos;,</span><br><span class="line">    &apos;age&apos;  =&gt; 18,</span><br><span class="line">    &apos;add&apos;  =&gt; &apos;China&apos;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo key($arr) . &apos;=&gt;&apos; . current($arr);</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    next($arr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = [</span><br><span class="line">    &apos;name&apos; =&gt; &apos;zs&apos;,</span><br><span class="line">    &apos;age&apos;  =&gt; 18,</span><br><span class="line">    &apos;add&apos;  =&gt; &apos;China&apos;</span><br><span class="line">];</span><br><span class="line">$arr1 = $arr;</span><br><span class="line">$keyName = array_keys($arr);</span><br><span class="line">$valueName = array_values($arr);</span><br><span class="line">echo $keyName[0];</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo $keyName[$i] . &quot;=&gt;&quot; . $arr[$keyName[$i]];</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo array_pop($arr1);</span><br><span class="line">    next($arr1);</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">fwrite(STDOUT,iconv(&apos;utf-8&apos;,&apos;gb2312&apos;,&apos;使用for循环遍历关联数组&apos;));</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">for($i=0; $i&lt;count($arr); $i++)&#123;</span><br><span class="line">    echo $keyName[$i] . &apos;=&gt;&apos; . $valueName[$i];</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="2-数组常用函数"><a href="#2-数组常用函数" class="headerlink" title="2. 数组常用函数"></a>2. 数组常用函数</h4><table><thead><tr><th align="center">函数名称</th><th align="center">作用</th></tr></thead><tbody><tr><td align="center">array_keys(array, value, strict)</td><td align="center">返回数组中所有的键名</td></tr><tr><td align="center">array_values(array)</td><td align="center">返回数组中所有的值</td></tr><tr><td align="center">count(array)/sizeof(array)</td><td align="center">返回数组中元素的数目</td></tr><tr><td align="center">array_merge(array1, array2)</td><td align="center">把一个或多个数组合并为一个数组</td></tr><tr><td align="center">array_key_exists(key, array)</td><td align="center">检查指定的键名是否存在与数组中</td></tr><tr><td align="center">sort()</td><td align="center">对数值组进行升序排序</td></tr><tr><td align="center">in_array(needle, haystack)</td><td align="center">检查数组中是否存在指定的值</td></tr><tr><td align="center">array_unique()</td><td align="center">删除数组中重复的值</td></tr><tr><td align="center">array_pop(array)</td><td align="center">删除数组中最后一个元素（栈）</td></tr></tbody></table><ul><li>array_keys(array, value, strict)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = array(&quot;Volvo&quot; =&gt; &quot;XC90&quot;, &quot;BMW&quot; =&gt; &quot;X5&quot;, &quot;Toyota&quot; =&gt; &quot;Highlander&quot;);</span><br><span class="line">//[0]=&gt;Volvo [1]=&gt;BMW [2]=&gt;Toyota</span><br><span class="line">print_r(array_keys($a));</span><br><span class="line">//[0]=&gt;Toyota</span><br><span class="line">print_r(array_keys($a,&quot;Highlander&quot;));</span><br><span class="line"></span><br><span class="line">$a=array(10,20,30,&quot;10&quot;);</span><br><span class="line">//[0]=&gt;3</span><br><span class="line">print_r(array_keys($a,&quot;10&quot;,true));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_values(array)   count()/sizeof()</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = array(&quot;Name&quot; =&gt; &quot;Peter&quot;, &quot;Age&quot; =&gt; &quot;41&quot;, &quot;Country&quot; =&gt; &quot;USA&quot;);</span><br><span class="line">//[0]=&gt;Peter [1]=&gt;41 [2]=&gt;USA</span><br><span class="line">print_r(array_values($a));</span><br><span class="line">//3</span><br><span class="line">echo count($a);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">//3</span><br><span class="line">echo sizeof($a);</span><br><span class="line">echo PHP_EOL;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_merge(array1, array2)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a1 = array(&quot;a&quot; =&gt; &quot;red&quot;, &quot;b&quot; =&gt; &quot;green&quot;);</span><br><span class="line">$a2 = array(&quot;c&quot; =&gt; &quot;blue&quot;, &quot;b&quot; =&gt; &quot;yellow&quot;);</span><br><span class="line">//如果两个或更多个数组元素有相同键名，则最后元素会覆盖其他元素</span><br><span class="line">//[a]=&gt;red  [b]=&gt;yellow [c]=&gt;blue</span><br><span class="line">print_r(array_merge($a1, $a2));</span><br><span class="line"></span><br><span class="line">$a=array(3=&gt;&quot;red&quot;,4=&gt;&quot;green&quot;);</span><br><span class="line">//若数组键名是整数，则该函数将返回以键名0开始进行重新索引</span><br><span class="line">//[0]=&gt;red  [1]=&gt;green</span><br><span class="line">print_r(array_merge($a));</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_key_exists(key, array)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=array(&quot;Volvo&quot;=&gt;&quot;XC90&quot;,&quot;BMW&quot;=&gt;&quot;X5&quot;);</span><br><span class="line">if (array_key_exists(&quot;Volvo&quot;,$a))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key does not exist!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$a=array(&quot;Volvo&quot;,&quot;BMW&quot;);</span><br><span class="line">if (array_key_exists(0,$a))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Key does not exist!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>sort() </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $cars=array(&quot;Volvo&quot;,&quot;BMW&quot;,&quot;Toyota&quot;);</span><br><span class="line">    sort($cars);</span><br><span class="line"></span><br><span class="line">    $clength=count($cars);</span><br><span class="line">    for($x=0;$x&lt;$clength;$x++)&#123;</span><br><span class="line">       echo $cars[$x];</span><br><span class="line">       echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    // BMW Toyota Volvo</span><br><span class="line">    $numbers=array(4,6,2,22,11);</span><br><span class="line">    sort($numbers);</span><br><span class="line"></span><br><span class="line">    $arrlength=count($numbers);</span><br><span class="line">    for($x=0;$x&lt;$arrlength;$x++)&#123;</span><br><span class="line">       echo $numbers[$x];</span><br><span class="line">       echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">//2 4 6 11 22</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>in_array() </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$sites = array(&quot;Google&quot;, &quot;Runoob&quot;, &quot;Taobao&quot;, &quot;Facebook&quot;);</span><br><span class="line"> </span><br><span class="line">if (in_array(&quot;Runoob&quot;, $sites))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;找到匹配项！&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;没有找到匹配项！&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>在练习二中<a href="https://meethanmj.github.io/2019/08/06/practice2/" target="_blank" rel="noopener">成绩输入</a>实例中也使用了in_array函数</p><ul><li>array_unique()</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=array(&quot;a&quot;=&gt;&quot;red&quot;,&quot;b&quot;=&gt;&quot;green&quot;,&quot;c&quot;=&gt;&quot;red&quot;);</span><br><span class="line">// [a]=&gt;red  [b]=&gt;green</span><br><span class="line">print_r(array_unique($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><ul><li>array_pop(array)  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=array(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;);</span><br><span class="line">array_pop($a);</span><br><span class="line">// [0]=&gt; red [1]=&gt;green</span><br><span class="line">print_r($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="二、文件处理"><a href="#二、文件处理" class="headerlink" title="二、文件处理"></a>二、文件处理</h3><h4 id="1-打开文件"><a href="#1-打开文件" class="headerlink" title="1. 打开文件"></a>1. 打开文件</h4><p><code>fopen</code>模式</p><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>r</td><td>只读。在文件的开头开始。</td></tr><tr><td>r+</td><td>读/写。在文件的开头开始。</td></tr><tr><td>w</td><td>只写。打开并清空文件的内容；若文件不存在，则创建新文件。</td></tr><tr><td>w+</td><td>读/写。打开并清空文件的内容；若文件不存在，则创建新文件。</td></tr><tr><td>a</td><td>追加，若文件不存在，则创建新文件。</td></tr><tr><td>a+</td><td>读/追加。</td></tr><tr><td>x</td><td>只写。创建新文件。若文件已存在，则返回FALSE和一个错误。</td></tr><tr><td>x+</td><td>读/写，创建新文件。若文件已存在，则返回FALSE和一个错误。</td></tr></tbody></table><h4 id="2-检测文件末尾-EOF"><a href="#2-检测文件末尾-EOF" class="headerlink" title="2.检测文件末尾(EOF)"></a>2.检测文件末尾(EOF)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(feof($file))&#123;</span><br><span class="line">echo &quot;文件末尾&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-逐行-字符读取文件"><a href="#3-逐行-字符读取文件" class="headerlink" title="3. 逐行/字符读取文件"></a>3. 逐行/字符读取文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;welcome.txt&quot;, &quot;r&quot;) or exit(&quot;无法打开文件!&quot;);</span><br><span class="line">// 读取文件每一行，直到文件结尾</span><br><span class="line">while(!feof($file))</span><br><span class="line">&#123;</span><br><span class="line">    echo fgets($file). &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file=fopen(&quot;welcome.txt&quot;,&quot;r&quot;) or exit(&quot;无法打开文件!&quot;);</span><br><span class="line">while (!feof($file))</span><br><span class="line">&#123;</span><br><span class="line">    echo fgetc($file);</span><br><span class="line">&#125;</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="4-写文件"><a href="#4-写文件" class="headerlink" title="4. 写文件"></a>4. 写文件</h4><p><code>fwrite(file, string, length)</code>和<code>fputs(file, string, length)</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;test.txt&quot;,&quot;w&quot;);</span><br><span class="line">echo fwrite($file,&quot;Hello World. Testing!&quot;);</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = fopen(&quot;test.txt&quot;,&quot;w&quot;);</span><br><span class="line">echo fputs($file,&quot;Hello World. Testing!&quot;);</span><br><span class="line">fclose($file);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: PHP数组索引数组和关联数组的遍历，以及数组常用的函数；PHP文件处理常用函数以及不同模式下对文件的操作。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>练习3</title>
    <link href="http://yoursite.com/2019/08/07/practice3/"/>
    <id>http://yoursite.com/2019/08/07/practice3/</id>
    <published>2019-08-07T12:09:09.000Z</published>
    <updated>2019-08-07T12:46:21.892Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: 学习PHP的三个练习，第一个是判断一个数是否为素数，第二个是画五角星，第三个是写一个新闻界面，用读写文件来代替数据库。</p><a id="more"></a><!--export--><p><strong>题目一</strong>：判断一个数是否为素数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;</span><br><span class="line">        判断一个数是否为素数</span><br><span class="line">    &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;judgePrime.php&quot; method=&quot;get&quot;&gt;</span><br><span class="line">    请输入一个数：&lt;input type=&quot;text&quot; name=&quot;number&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    $num = isset($_GET[&apos;number&apos;]) ? $_GET[&apos;number&apos;]: 2;</span><br><span class="line">    $k = 0;</span><br><span class="line">    for($i=1; $i&lt;=$num; $i++)&#123;</span><br><span class="line">        if($num%$i == 0)&#123;</span><br><span class="line">            $k++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if($_GET[&apos;number&apos;]!=NULL) &#123;</span><br><span class="line">        if ($k == 2) &#123;</span><br><span class="line">            echo $num . &apos;是一个素数&apos;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo $num . &apos;不是一个素数&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/judgePrime.png" alt></p><p><strong>题目二</strong>：用PHP画五角星</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &quot;\n\n&quot;;</span><br><span class="line">for ( $i1 = 1; $i1 &lt; 6; $i1++ )                    /*这是五角星的上面一个角*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j1 = 1; $j1 &lt; 19 - $i1; $j1++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k1 = 1; $k1 &lt;= 2 * $i1 - 1; $k1++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for ($i2 = 1; $i2 &lt; 5; $i2++ )                    /*这是五角星的中间两个角*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j2 = 1; $j2 &lt; 3 * $i2 - 3; $j2++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k2 = 1; $k2 &lt;= 42 - 6 * $i2; $k2++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for ( $i3 = 1; $i3 &lt; 3; $i3++ ) /*这是中间与下部相接的部分*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j3 = 1; $j3 &lt; 12 - $i3; $j3++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k3 = 1; $k3 &lt;= 12 + 2 * $i3; $k3++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for ( $i4 = 1; $i4 &lt; 5; $i4++ ) /*这是五角星的下面两个角*/</span><br><span class="line">&#123;</span><br><span class="line">    for ( $j4 = 1; $j4 &lt; 10 - $i4; $j4++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $k4 = 1; $k4 &lt;= 10 - 2 * $i4; $k4++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    for ( $m4 = 1; $m4 &lt; 6 * $i4 - 3; $m4++ )</span><br><span class="line">        printf( &quot; &quot; );</span><br><span class="line">    for ( $n4 = 1; $n4 &lt;= 10 - 2 * $i4; $n4++ )</span><br><span class="line">        printf( &quot;*&quot; );</span><br><span class="line">    printf( &quot;\n&quot; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/fivestar.png" alt></p><p><strong>题目三</strong>：新闻界面</p><p>在<code>news_file</code>文件夹下有<code>index.php</code>和<code>data</code>文件夹，<code>index.php</code>主要是显示新闻的作用，<code>data</code>文件夹里面有<code>add_news.php</code>和<code>news.db</code>，其中<code>add_news.php</code>主要是添加新闻到<code>news.db</code>中，<code>news.db</code>每行存放着新闻的标号，标题，内容，日期，作者，热度和图片链接，其中标题，内容与作者使用了<code>base64</code>编码，两两用<code>||</code>分隔。</p><p><code>index.php</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;news&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1 align=&quot;center&quot;&gt;ICQ新闻中心&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;table align=&quot;center&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;热度&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标题&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;作者&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;时间&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;素质三联&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        //用只读方式打开news.db文件</span><br><span class="line">        $fhandle = fopen(&quot;./data/news.db&quot;, &quot;r&quot;);</span><br><span class="line">        //设置一个计数器，小于3时，每个文章标题下面增加图片和简介</span><br><span class="line">        $top3Cnt=1;</span><br><span class="line">        while(!feof($fhandle)) &#123;</span><br><span class="line">            $fline = fgets($fhandle);</span><br><span class="line">            $data = explode(&apos;||&apos;, $fline);</span><br><span class="line">            $title = base64_decode($data[1]);</span><br><span class="line">            $content = base64_decode($data[2]);</span><br><span class="line">            $date = $data[3];</span><br><span class="line">            $author = base64_decode($data[4]);</span><br><span class="line">            $hot = $data[5];</span><br><span class="line">            $imgUrl = $data[6];</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">        &lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">            &lt;td&gt;$hot&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=&quot;myl.php&quot;&gt;$title&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$author&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$date&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;button&gt;👍&lt;/button&gt;/&lt;button&gt;👎&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        if($top3Cnt&lt;=3)&#123;</span><br><span class="line">            $tmpContent = mb_substr(base64_decode($data[2]), 0,50);</span><br><span class="line">            echo &lt;&lt;&lt;EOF</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;&lt;img src=&quot;$imgUrl&quot; height=&quot;80&quot; width=&quot;80&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&apos;4&apos;&gt;&lt;b&gt;内容简介：&lt;/b&gt;$tmpContent&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">EOF;</span><br><span class="line">        &#125;</span><br><span class="line">        $top3Cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>OUT</p><p><img src="/images/newshow.png" alt></p><p><code>add_news.php</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;增加新闻&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;add_news.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    标号：&lt;input type=&quot;number&quot; name=&quot;id&quot;&gt;&lt;br&gt;</span><br><span class="line">    标题：&lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;!--    标题：&lt;input type=&quot;text&quot; namne=&quot;title&quot;&gt;&lt;br&gt;--&gt;</span><br><span class="line">    内容：&lt;input type=&quot;text&quot; name=&quot;content&quot;&gt;&lt;br&gt;</span><br><span class="line">    日期：&lt;input type=&quot;date&quot; name=&quot;date&quot;&gt;&lt;br&gt;</span><br><span class="line">    作者：&lt;input type=&quot;author&quot; name=&quot;author&quot;&gt;&lt;br&gt;</span><br><span class="line">    热度：&lt;input type=&quot;number&quot; name=&quot;hot&quot;&gt;&lt;br&gt;</span><br><span class="line">    图片：&lt;input type=&quot;url&quot; name=&quot;imgUrl&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    $fhandle = fopen(&apos;news.db &apos;, &apos;a&apos;);</span><br><span class="line">    $arrMes = array();</span><br><span class="line">    @$arrMes[0] = $_POST[&apos;id&apos;];</span><br><span class="line">    @$arrMes[1] = base64_encode($_POST[&apos;title&apos;]);</span><br><span class="line">    @$arrMes[2] = base64_encode($_POST[&apos;content&apos;]);</span><br><span class="line">    @$arrMes[3] = $_POST[&apos;date&apos;];</span><br><span class="line">    @$arrMes[4] = base64_encode($_POST[&apos;author&apos;]);</span><br><span class="line">    @$arrMes[5] = $_POST[&apos;hot&apos;];</span><br><span class="line">    @$arrMes[6]= $_POST[&apos;imgUrl&apos;];</span><br><span class="line">    if($arrMes[0]!=NULL) &#123;</span><br><span class="line">        $writeMes = implode(&apos;||&apos;, $arrMes);</span><br><span class="line">        echo $writeMes;</span><br><span class="line">        $fline = fputs($fhandle, $writeMes);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($fhandle);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/addNews.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: 学习PHP的三个练习，第一个是判断一个数是否为素数，第二个是画五角星，第三个是写一个新闻界面，用读写文件来代替数据库。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="实战" scheme="http://yoursite.com/tags/%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>note17</title>
    <link href="http://yoursite.com/2019/08/06/note17/"/>
    <id>http://yoursite.com/2019/08/06/note17/</id>
    <published>2019-08-06T10:40:25.000Z</published>
    <updated>2019-08-07T15:46:29.374Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Abstract</strong>: PHP语言中<code>while</code>和<code>for</code>的用法，以及PHP数组的用法。</p><a id="more"></a><!--export--><h3 id="1-PHP三种工作模式-文件后缀解析时有何区别"><a href="#1-PHP三种工作模式-文件后缀解析时有何区别" class="headerlink" title="1. PHP三种工作模式(文件后缀解析时有何区别)"></a>1. PHP三种工作模式(文件后缀解析时有何区别)</h3><h4 id="1-1-module模式"><a href="#1-1-module模式" class="headerlink" title="1.1 module模式"></a>1.1 module模式</h4><p>LAMP — Linux Apache Php Mysql</p><p>php作为apache模块运行，apache遇到一个php文件，，就相当于执行系统命令 <code>php a.php</code>，文件后缀解析以apache配置文件为主，如果apache认为.xxx文件时php脚本，就当作php执行。</p><h4 id="1-2-CGI模式"><a href="#1-2-CGI模式" class="headerlink" title="1.2 CGI模式"></a>1.2 CGI模式</h4><p>LNMP — Linux Nginx Php Mysql</p><p>php会监听一个端口，nginx/phpstorm/iis等中间件遇到一个php文件时，会把请求转发给php监听的端口。</p><p>有两个配置文件，一个是中间件，一个是php服务的，nginx/iis认为.xxx后缀文件是php脚本，交给php处理，但在php配置文件中，会有一个限制php5/php3/phtml/php能够被识别。</p><p><a href="https://meethanmj.github.io/2019/08/04/week3sum/" target="_blank" rel="noopener">第三周总结</a> 最底部有三种模式的对比。</p><h3 id="2-PHP数组"><a href="#2-PHP数组" class="headerlink" title="2. PHP数组"></a>2. PHP数组</h3><h4 id="2-1-数值数组"><a href="#2-1-数值数组" class="headerlink" title="2.1 数值数组"></a>2.1 数值数组</h4><p>​    自动分配ID键（ID键总是从0开始）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cars = array(&quot;Volvo&quot;, &quot;BMW&quot;, &quot;Toyota&quot;);</span><br><span class="line">echo $cars[0];//输出&quot;Volvo&quot;</span><br><span class="line">echo $cars[1];//输出&quot;BMW&quot;</span><br><span class="line">echo $cars[2];//输出&quot;Toyota&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>​    count()函数—获取数组的长度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cars = array(&quot;Volvo&quot;, &quot;BMW&quot;, &quot;Toyota&quot;);</span><br><span class="line">echo count($cars);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>​    遍历数值数组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cars=array(&quot;Volvo&quot;,&quot;BMW&quot;,&quot;Toyota&quot;);</span><br><span class="line">$arrlength=count($cars); </span><br><span class="line">for($x=0;$x&lt;$arrlength;$x++)&#123;</span><br><span class="line">    echo $cars[$x];</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">   &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>为一个数组增加一位，不适合用上述这种方法遍历。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $arr = array(&apos;name&apos;=&gt;&apos;zs&apos;, 2, &apos;age&apos;=&gt;18, 1);</span><br><span class="line">    echo $arr[&apos;name&apos;];//zs</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr[0];//2</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr[&apos;age&apos;];//18</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr[1];//1</span><br><span class="line">    $arr1 = array(1,2,3,4,5);</span><br><span class="line">    $arr1[0] = 6;</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    $arr1[100] = 100;</span><br><span class="line">    echo PHP_EOL;</span><br><span class="line">    echo $arr1[0], $arr1[100];</span><br><span class="line">    for($i=0; $i&lt;=100; $i++)&#123;//610062345 报错，直到i=100时把100输出</span><br><span class="line">        echo $arr1[$i];</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>使用<code>foreach</code>就不会报错，数值数组和关联数组混合时，关联数组并不影响数值数组的下标。</p><h4 id="2-2-关联数组"><a href="#2-2-关联数组" class="headerlink" title="2.2 关联数组"></a>2.2 关联数组</h4><p>关联数组可以指定键的数组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $age=array(&quot;Peter&quot;=&gt;&quot;35&quot;,&quot;Ben&quot;=&gt;&quot;37&quot;,&quot;Joe&quot;=&gt;&quot;43&quot;);</span><br><span class="line">    echo &quot;Peter is &quot; . $age[&apos;Peter&apos;] . &quot; years old.&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>遍历关联数组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $age=array(&quot;Peter&quot;=&gt;&quot;35&quot;,&quot;Ben&quot;=&gt;&quot;37&quot;,&quot;Joe&quot;=&gt;&quot;43&quot;);</span><br><span class="line"></span><br><span class="line">    foreach($age as $x=&gt;$x_value)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;Key=&quot; . $x . &quot;, Value=&quot; . $x_value;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $arr = array(1, 2, 3, 4, 5);</span><br><span class="line">    foreach($arr as $key =&gt; $value)&#123;</span><br><span class="line">        echo $key.&quot;=&gt;&quot;.$value;</span><br><span class="line">        echo PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">    $arr[5]=709;</span><br><span class="line">    foreach($arr as $key =&gt; $value)&#123;</span><br><span class="line">        echo $key.&quot;=&gt;&quot;.$value;</span><br><span class="line">        echo PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">    $arr[100] = 100;</span><br><span class="line">    foreach($arr as $key =&gt; $value)&#123;</span><br><span class="line">        echo $key.&quot;=&gt;&quot;.$value;</span><br><span class="line">        echo PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;: PHP语言中&lt;code&gt;while&lt;/code&gt;和&lt;code&gt;for&lt;/code&gt;的用法，以及PHP数组的用法。&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://yoursite.com/categories/Web-Security/"/>
    
      <category term="笔记" scheme="http://yoursite.com/categories/Web-Security/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
</feed>
